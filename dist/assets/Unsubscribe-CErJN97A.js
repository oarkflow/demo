import{j as e}from"./vendor-ui-CpQN7H5M.js";import{f as j,r as t,L as d}from"./vendor-react-CQIth8Kl.js";import{s as y,H as N}from"./main-DOuA4wCK.js";import{B as c}from"./button-DN9WMlhV.js";import{I as v}from"./input-3sGjNk2T.js";import{N as w,F as C}from"./Footer-BcNHKjd0.js";import{M as k}from"./mail-CnIzshDs.js";import{C as U}from"./circle-alert-WbnEyeJg.js";import{C as S}from"./circle-x-IqisJicS.js";import{C as E}from"./circle-check-big-C0RdmDXd.js";import{L as P}from"./loader-circle-gm-OM9IX.js";import{s as L}from"./types-BnTeS-Hg.js";import"./vendor-query-CbH48mXO.js";import"./vendor-motion-BaiS5iA3.js";import"./linkedin-C4Vw4HHZ.js";const F=L().trim().email("Please enter a valid email address").max(255),J=()=>{const[x]=j(),s=x.get("email"),[l,b]=t.useState(s||""),[a,m]=t.useState(null),[f,o]=t.useState(s?"loading":"idle"),n=t.useCallback(async r=>{const u=F.safeParse(r);if(!u.success){m(u.error.issues[0].message);return}m(null),o("loading");try{const{error:i}=await y.functions.invoke("unsubscribe",{body:{email:r.trim().toLowerCase()}});i?(console.error("Unsubscribe error:",i),o("error")):o("success")}catch(i){console.error("Unsubscribe failed:",i),o("error")}},[]);t.useEffect(()=>{s&&n(s)},[s,n]);const h=r=>{r.preventDefault(),n(l)},p=r=>{b(r),a&&m(null)},g=()=>{switch(f){case"loading":return e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"w-16 h-16 mx-auto text-primary animate-spin mb-6"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Processing your request..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we update your subscription preferences."})]});case"success":return e.jsxs("div",{className:"text-center",children:[e.jsx(E,{className:"w-16 h-16 mx-auto text-green-500 mb-6"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Successfully Unsubscribed"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"You have been unsubscribed from our newsletter. You will no longer receive marketing emails from us."}),e.jsx("p",{className:"text-sm text-muted-foreground mb-8",children:"Changed your mind? You can always subscribe again from our website."}),e.jsx(d,{to:"/",children:e.jsx(c,{children:"Return to Homepage"})})]});case"error":return e.jsxs("div",{className:"text-center",children:[e.jsx(S,{className:"w-16 h-16 mx-auto text-red-500 mb-6"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"We couldn't process your unsubscribe request. Please try again or contact us directly."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(c,{onClick:()=>n(l),children:"Try Again"}),e.jsx(d,{to:"/contact",children:e.jsx(c,{variant:"outline",children:"Contact Us"})})]})]});case"idle":default:return e.jsxs("div",{className:"text-center",children:[e.jsx(k,{className:"w-16 h-16 mx-auto text-primary mb-6"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground mb-4",children:"Unsubscribe from Newsletter"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Enter your email address below to unsubscribe from our newsletter."}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{type:"email",placeholder:"your@email.com",value:l,onChange:r=>p(r.target.value),className:`h-12 bg-primary/5 border-l-4 border-l-primary/40 border-y border-r border-border/40 placeholder:text-muted-foreground/60 focus:bg-primary/10 focus:border-l-primary focus:border-primary/50 focus:ring-2 focus:ring-primary/20 rounded-xl transition-all duration-200 ${a?"border-l-destructive border-destructive/50 bg-destructive/5 focus:border-l-destructive focus:border-destructive/50 focus:ring-destructive/20":""}`,required:!0}),a&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1 justify-center",children:[e.jsx(U,{className:"w-3 h-3"}),a]})]}),e.jsx(c,{type:"submit",className:"w-full",size:"lg",children:"Unsubscribe"})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-border",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:'Looking for the unsubscribe link from our email? Click the "Unsubscribe" link at the bottom of any newsletter email.'}),e.jsx(d,{to:"/",className:"text-sm text-primary hover:underline",children:"Return to Homepage"})]})]})}};return e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx("title",{children:"Unsubscribe | InfraWeave"}),e.jsx("meta",{name:"description",content:"Unsubscribe from InfraWeave newsletter"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsx(w,{}),e.jsx("main",{className:"min-h-screen bg-background pt-24 pb-16 flex items-center justify-center",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsx("div",{className:"max-w-md mx-auto bg-card border border-border rounded-2xl p-8 shadow-lg",children:g()})})}),e.jsx(C,{})]})};export{J as default};
