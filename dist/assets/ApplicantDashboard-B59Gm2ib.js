import{j as e,f as ss,h as ve}from"./vendor-ui-CpQN7H5M.js";import{r as o,L as as,c as $e}from"./vendor-react-CQIth8Kl.js";import{B as _}from"./button-DN9WMlhV.js";import{d as De,U as ce,P as Fe,L as rs,T as ts,a as ns,b as le,c as ie}from"./tabs-Bq4rbGpK.js";import{P as Ce}from"./index-BDuca45V.js";import{c as fe,b as _e,e as ne,X as we,u as v,s as k}from"./main-DOuA4wCK.js";import{A as be,N as ls,F as is}from"./Footer-BcNHKjd0.js";import{S as cs}from"./SEO-Dzs1gqxY.js";import{I as R}from"./input-3sGjNk2T.js";import{T as Me}from"./dialog-B7tK7NkI.js";import{e as F,i as Y,j as O,k as J,f as A,B as V,S as de,a as me,b as ue,c as xe,d as U,g as se,C as os,h as ds}from"./checkbox-D7C1-8hB.js";import{F as he}from"./file-text-99329Wa_.js";import{C as je}from"./circle-check-big-C0RdmDXd.js";import{L as I}from"./loader-circle-gm-OM9IX.js";import{U as Se,u as ms,t as us,F as xs,a as K,b as Q,c as z,d as X,e as Z,p as re}from"./form-BMn3aUXA.js";import{M as Be}from"./mail-CnIzshDs.js";import{P as hs}from"./phone-LBIOAa38.js";import{L as ps}from"./linkedin-C4Vw4HHZ.js";import{B as ge}from"./building-2-D6198ZUE.js";import{A as Ae}from"./award-CaZ1IrdB.js";import{m as ae,A as fs}from"./vendor-motion-BaiS5iA3.js";import{C as js}from"./calendar-DM4HURmh.js";import{C as pe}from"./clock-C20VA6FT.js";import{C as gs}from"./circle-x-IqisJicS.js";import{C as Ns}from"./circle-alert-WbnEyeJg.js";import{P as ys}from"./phone-input-Bbc-BlUQ.js";import{o as vs,s as B,l as ws}from"./types-BnTeS-Hg.js";import{S as Ve}from"./search-DQhVum17.js";import{M as qe}from"./map-pin-Ca16Y2PC.js";import{C as bs}from"./chevron-down-XZA7CO6G.js";import{L as oe}from"./label-Da_zOxXJ.js";import{C as Ss}from"./check-BaiukXth.js";import{S as Cs}from"./shield-BdtXguoE.js";import{L as Ne}from"./lock-CAlp7rmO.js";import{S as _s}from"./settings-Sq6_3DqP.js";import"./vendor-query-CbH48mXO.js";import"./index-BdQq_4o_.js";import"./popover-JCz5535I.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=fe("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=fe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=fe("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=fe("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function Ps(s,l=[]){let n=[];function c(m,x){const u=o.createContext(x);u.displayName=m+"Context";const j=n.length;n=[...n,x];const y=g=>{var E;const{scope:w,children:h,...p}=g,d=((E=w==null?void 0:w[s])==null?void 0:E[j])||u,C=o.useMemo(()=>p,Object.values(p));return e.jsx(d.Provider,{value:C,children:h})};y.displayName=m+"Provider";function S(g,w){var d;const h=((d=w==null?void 0:w[s])==null?void 0:d[j])||u,p=o.useContext(h);if(p)return p;if(x!==void 0)return x;throw new Error(`\`${g}\` must be used within \`${m}\``)}return[y,S]}const t=()=>{const m=n.map(x=>o.createContext(x));return function(u){const j=(u==null?void 0:u[s])||m;return o.useMemo(()=>({[`__scope${s}`]:{...u,[s]:j}}),[u,j])}};return t.scopeName=s,[c,Es(t,...l)]}function Es(...s){const l=s[0];if(s.length===1)return l;const n=()=>{const c=s.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(m){const x=c.reduce((u,{useScope:j,scopeName:y})=>{const g=j(m)[`__scope${y}`];return{...u,...g}},{});return o.useMemo(()=>({[`__scope${l.scopeName}`]:x}),[x])}};return n.scopeName=l.scopeName,n}var ze={exports:{}},Ye={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=o;function Ls(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Fs=typeof Object.is=="function"?Object.is:Ls,As=te.useState,Is=te.useEffect,Us=te.useLayoutEffect,Rs=te.useDebugValue;function Ts(s,l){var n=l(),c=As({inst:{value:n,getSnapshot:l}}),t=c[0].inst,m=c[1];return Us(function(){t.value=n,t.getSnapshot=l,ye(t)&&m({inst:t})},[s,n,l]),Is(function(){return ye(t)&&m({inst:t}),s(function(){ye(t)&&m({inst:t})})},[s]),Rs(n),n}function ye(s){var l=s.getSnapshot;s=s.value;try{var n=l();return!Fs(s,n)}catch{return!0}}function $s(s,l){return l()}var Ds=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$s:Ts;Ye.useSyncExternalStore=te.useSyncExternalStore!==void 0?te.useSyncExternalStore:Ds;ze.exports=Ye;var Ms=ze.exports;function Bs(){return Ms.useSyncExternalStore(Vs,()=>!0,()=>!1)}function Vs(){return()=>{}}var ke="Avatar",[qs]=Ps(ke),[zs,Oe]=qs(ke),We=o.forwardRef((s,l)=>{const{__scopeAvatar:n,...c}=s,[t,m]=o.useState("idle");return e.jsx(zs,{scope:n,imageLoadingStatus:t,onImageLoadingStatusChange:m,children:e.jsx(Ce.span,{...c,ref:l})})});We.displayName=ke;var Ge="AvatarImage",He=o.forwardRef((s,l)=>{const{__scopeAvatar:n,src:c,onLoadingStatusChange:t=()=>{},...m}=s,x=Oe(Ge,n),u=Ys(c,m),j=ss(y=>{t(y),x.onImageLoadingStatusChange(y)});return ve(()=>{u!=="idle"&&j(u)},[u,j]),u==="loaded"?e.jsx(Ce.img,{...m,ref:l,src:c}):null});He.displayName=Ge;var Ke="AvatarFallback",Qe=o.forwardRef((s,l)=>{const{__scopeAvatar:n,delayMs:c,...t}=s,m=Oe(Ke,n),[x,u]=o.useState(c===void 0);return o.useEffect(()=>{if(c!==void 0){const j=window.setTimeout(()=>u(!0),c);return()=>window.clearTimeout(j)}},[c]),x&&m.imageLoadingStatus!=="loaded"?e.jsx(Ce.span,{...t,ref:l}):null});Qe.displayName=Ke;function Re(s,l){return s?l?(s.src!==l&&(s.src=l),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Ys(s,{referrerPolicy:l,crossOrigin:n}){const c=Bs(),t=o.useRef(null),m=c?(t.current||(t.current=new window.Image),t.current):null,[x,u]=o.useState(()=>Re(m,s));return ve(()=>{u(Re(m,s))},[m,s]),ve(()=>{const j=g=>()=>{u(g)};if(!m)return;const y=j("loaded"),S=j("error");return m.addEventListener("load",y),m.addEventListener("error",S),l&&(m.referrerPolicy=l),typeof n=="string"&&(m.crossOrigin=n),()=>{m.removeEventListener("load",y),m.removeEventListener("error",S)}},[m,n,l]),x}var Xe=We,Ze=He,Je=Qe;const Pe=o.forwardRef(({className:s,...l},n)=>e.jsx(Xe,{ref:n,className:_e("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...l}));Pe.displayName=Xe.displayName;const Ee=o.forwardRef(({className:s,...l},n)=>e.jsx(Ze,{ref:n,className:_e("aspect-square h-full w-full",s),...l}));Ee.displayName=Ze.displayName;const Le=o.forwardRef(({className:s,...l},n)=>e.jsx(Je,{ref:n,className:_e("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...l}));Le.displayName=Je.displayName;const Os=({profile:s,onProfileUpdate:l})=>{const{user:n}=ne(),[c,t]=o.useState(!1),[m,x]=o.useState(!1),[u,j]=o.useState(!1),[y,S]=o.useState(!1),[g,w]=o.useState(""),[h,p]=o.useState(""),[d,C]=o.useState({full_name:(s==null?void 0:s.full_name)||"",phone:(s==null?void 0:s.phone)||"",linkedin_url:(s==null?void 0:s.linkedin_url)||"",current_company:(s==null?void 0:s.current_company)||"",experience_years:(s==null?void 0:s.experience_years)||0,bio:(s==null?void 0:s.bio)||"",skills:(s==null?void 0:s.skills)||[],certifications:(s==null?void 0:s.certifications)||[]}),E=async()=>{if(n){x(!0);try{const{error:i}=await k.from("applicant_profiles").update({full_name:d.full_name||null,phone:d.phone||null,linkedin_url:d.linkedin_url||null,current_company:d.current_company||null,experience_years:d.experience_years,bio:d.bio||null,skills:d.skills,certifications:d.certifications}).eq("user_id",n.id);if(i)throw i;v.success("Profile updated successfully!"),t(!1),l()}catch(i){console.error("Error updating profile:",i),v.error(i.message||"Failed to update profile")}finally{x(!1)}}},a=async i=>{var G;const N=(G=i.target.files)==null?void 0:G[0];if(!N||!n)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(N.type)){v.error("Please upload a PDF or Word document");return}if(N.size>10*1024*1024){v.error("File size must be less than 10MB");return}j(!0);try{const q=N.name.split(".").pop(),H=`profile-${n.id}-${Date.now()}.${q}`;s!=null&&s.resume_url&&await k.storage.from("resumes").remove([s.resume_url]);const{error:r}=await k.storage.from("resumes").upload(H,N,{upsert:!0});if(r)throw r;const{error:L}=await k.from("applicant_profiles").update({resume_url:H}).eq("user_id",n.id);if(L)throw L;v.success("Resume uploaded successfully!"),l()}catch(q){console.error("Error uploading resume:",q),v.error("Failed to upload resume")}finally{j(!1)}},f=async()=>{if(!(!n||!(s!=null&&s.resume_url))){S(!0);try{await k.storage.from("resumes").remove([s.resume_url]);const{error:i}=await k.from("applicant_profiles").update({resume_url:null}).eq("user_id",n.id);if(i)throw i;v.success("Resume removed"),l()}catch(i){console.error("Error deleting resume:",i),v.error("Failed to remove resume")}finally{S(!1)}}},b=()=>{g.trim()&&!d.skills.includes(g.trim())&&(C(i=>({...i,skills:[...i.skills,g.trim()]})),w(""))},T=i=>{C(N=>({...N,skills:N.skills.filter(D=>D!==i)}))},$=()=>{h.trim()&&!d.certifications.includes(h.trim())&&(C(i=>({...i,certifications:[...i.certifications,h.trim()]})),p(""))},W=i=>{C(N=>({...N,certifications:N.certifications.filter(D=>D!==i)}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-5 h-5"}),"Resume"]}),e.jsx(J,{children:"Upload your resume to auto-fill job applications"})]}),e.jsx(A,{children:s!=null&&s.resume_url?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(he,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:["Resume uploaded",e.jsx(je,{className:"w-4 h-4 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This will be used when you apply for jobs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",id:"resume-replace",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:u}),e.jsx("label",{htmlFor:"resume-replace",children:e.jsx(_,{variant:"outline",size:"sm",disabled:u,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:u?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Replace"]})})})}),e.jsx(_,{variant:"ghost",size:"sm",onClick:f,disabled:y,children:y?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[e.jsx(Ue,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"font-medium mb-1",children:"No resume uploaded"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload your resume to speed up job applications"}),e.jsx("input",{type:"file",id:"resume-upload",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:u}),e.jsx("label",{htmlFor:"resume-upload",children:e.jsx(_,{disabled:u,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:u?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Upload Resume"]})})})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"PDF or Word document, max 10MB"})]})})]}),e.jsxs(F,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Profile Information"]}),e.jsx(J,{children:"Keep your profile updated to get noticed by recruiters"})]}),c?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsxs(_,{onClick:E,disabled:m,children:[m?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Save"]})]}):e.jsx(_,{onClick:()=>t(!0),children:"Edit Profile"})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"})," Full Name"]}),c?e.jsx(R,{value:d.full_name,onChange:i=>C(N=>({...N,full_name:i.target.value})),placeholder:"Your full name"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.full_name)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"})," Email"]}),e.jsx("p",{className:"text-foreground",children:s==null?void 0:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"})," Phone"]}),c?e.jsx(R,{value:d.phone,onChange:i=>C(N=>({...N,phone:i.target.value})),placeholder:"Your phone number"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.phone)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ps,{className:"w-4 h-4"})," LinkedIn"]}),c?e.jsx(R,{value:d.linkedin_url,onChange:i=>C(N=>({...N,linkedin_url:i.target.value})),placeholder:"https://linkedin.com/in/yourprofile"}):e.jsx("p",{className:"text-foreground",children:s!=null&&s.linkedin_url?e.jsx("a",{href:s.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"View Profile"}):"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"})," Current Company"]}),c?e.jsx(R,{value:d.current_company,onChange:i=>C(N=>({...N,current_company:i.target.value})),placeholder:"Your current company"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.current_company)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"})," Experience"]}),c?e.jsxs(de,{value:d.experience_years.toString(),onValueChange:i=>C(N=>({...N,experience_years:parseInt(i)})),children:[e.jsx(me,{children:e.jsx(ue,{})}),e.jsx(xe,{children:[0,1,2,3,4,5,6,7,8,9,10,15,20].map(i=>e.jsx(U,{value:i.toString(),children:i===0?"Fresh Graduate":`${i}+ years`},i))})]}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.experience_years)===0?"Fresh Graduate":`${s==null?void 0:s.experience_years}+ years`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"})," Bio"]}),c?e.jsx(Me,{value:d.bio,onChange:i=>C(N=>({...N,bio:i.target.value})),placeholder:"Tell us about yourself, your career goals, and what you're looking for...",rows:4}):e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:(s==null?void 0:s.bio)||"No bio provided"})]})]})]}),e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Skills"]}),e.jsx(J,{children:"Add your technical and soft skills"})]}),e.jsxs(A,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[d.skills.map(i=>e.jsxs(se,{variant:"secondary",className:"text-sm py-1 px-3",children:[i,c&&e.jsx("button",{onClick:()=>T(i),className:"ml-2",children:e.jsx(we,{className:"w-3 h-3"})})]},i)),d.skills.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No skills added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:g,onChange:i=>w(i.target.value),placeholder:"Add a skill (e.g., Python, Kubernetes)",onKeyPress:i=>i.key==="Enter"&&(i.preventDefault(),b())}),e.jsx(_,{type:"button",onClick:b,variant:"outline",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]})]}),e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Certifications"]}),e.jsx(J,{children:"List your professional certifications"})]}),e.jsxs(A,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[d.certifications.map(i=>e.jsxs(se,{variant:"outline",className:"text-sm py-1 px-3",children:[i,c&&e.jsx("button",{onClick:()=>W(i),className:"ml-2",children:e.jsx(we,{className:"w-3 h-3"})})]},i)),d.certifications.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No certifications added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:h,onChange:i=>p(i.target.value),placeholder:"Add a certification (e.g., AWS Solutions Architect)",onKeyPress:i=>i.key==="Enter"&&(i.preventDefault(),$())}),e.jsx(_,{type:"button",onClick:$,variant:"outline",children:e.jsx(Fe,{className:"w-4 h-4"})})]})]})]})]})},Te=s=>{switch(s.toLowerCase()){case"pending":return{icon:pe,color:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",label:"Under Review"};case"reviewed":return{icon:Ns,color:"bg-blue-500/10 text-blue-600 border-blue-500/30",label:"Reviewed"};case"interviewed":return{icon:V,color:"bg-purple-500/10 text-purple-600 border-purple-500/30",label:"Interview Stage"};case"hired":return{icon:je,color:"bg-green-500/10 text-green-600 border-green-500/30",label:"Hired!"};case"rejected":return{icon:gs,color:"bg-red-500/10 text-red-600 border-red-500/30",label:"Not Selected"};default:return{icon:pe,color:"bg-muted text-muted-foreground",label:s}}},Ws=({userId:s})=>{const[l,n]=o.useState([]),[c,t]=o.useState(!0);o.useEffect(()=>{m()},[s]);const m=async()=>{if(s)try{const{data:x,error:u}=await k.from("job_applications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(u)throw u;n(x||[])}catch(x){console.error("Error fetching applications:",x),v.error("Failed to load applications")}finally{t(!1)}};return c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):l.length===0?e.jsx(F,{children:e.jsxs(A,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-16 h-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Applications Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't applied to any positions yet. Browse our open positions and start your journey!"}),e.jsx(as,{to:"/careers",children:e.jsxs(_,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Browse Open Positions"]})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold",children:["Your Applications (",l.length,")"]})}),e.jsx("div",{className:"grid gap-4",children:l.map((x,u)=>{const j=Te(x.status),y=j.icon;return e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},children:e.jsx(F,{className:"hover:shadow-md transition-shadow",children:e.jsxs(A,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(V,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:x.position}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(js,{className:"w-4 h-4"}),"Applied ",new Date(x.created_at).toLocaleDateString()]}),x.current_company&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-4 h-4"}),x.current_company]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(se,{variant:"outline",className:j.color,children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),j.label]})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:["pending","reviewed","interviewed","hired"].map((S,g)=>{const w=Te(S),h=w.icon,p=["pending","reviewed","interviewed","hired"].indexOf(x.status.toLowerCase()),d=g<=p&&x.status.toLowerCase()!=="rejected",C=g===p;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${d?C?w.color:"bg-green-500/10 text-green-600":"bg-muted text-muted-foreground"}`,children:[e.jsx(h,{className:"w-3 h-3"}),w.label]}),g<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${g<p&&x.status.toLowerCase()!=="rejected"?"bg-green-500":"bg-muted"}`})]},S)})})})]})})},x.id)})})]})},Gs=vs({fullName:B().min(2,"Name must be at least 2 characters").max(100,"Name is too long"),email:B().email("Please enter a valid email"),phone:B().min(10,"Please enter a valid phone number"),position:B().min(1,"Please select a position"),positionId:B().min(1,"Position ID is required"),experienceYears:B().min(1,"Please select your experience"),currentCompany:B().optional(),linkedinUrl:B().url("Please enter a valid URL").optional().or(ws("")),coverLetter:B().max(2e3,"Cover letter is too long").optional()}),Hs=({position:s,onClose:l,onSuccess:n})=>{const{user:c}=ne(),[t,m]=o.useState(null),[x,u]=o.useState(null),[j,y]=o.useState(!1),[S,g]=o.useState(!1),[w,h]=o.useState(!0),p=ms({resolver:us(Gs),defaultValues:{fullName:"",email:(c==null?void 0:c.email)||"",phone:"",position:s.title,positionId:s.id,experienceYears:"",currentCompany:"",linkedinUrl:"",coverLetter:""}});o.useEffect(()=>{c&&d()},[c]);const d=async()=>{if(c){h(!0);try{const{data:a,error:f}=await k.from("applicant_profiles").select("*").eq("user_id",c.id).maybeSingle();if(f)throw f;a&&(a.full_name&&p.setValue("fullName",a.full_name),a.phone&&p.setValue("phone",a.phone),a.linkedin_url&&p.setValue("linkedinUrl",a.linkedin_url),a.current_company&&p.setValue("currentCompany",a.current_company),a.experience_years!==null&&a.experience_years!==void 0&&p.setValue("experienceYears",a.experience_years.toString()),a.resume_url&&(u(a.resume_url),y(!0)))}catch(a){console.error("Error fetching profile:",a)}finally{h(!1)}}},C=a=>{var b;const f=(b=a.target.files)==null?void 0:b[0];if(f){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(f.type)){v.error("Please upload a PDF or Word document");return}if(f.size>10*1024*1024){v.error("File size must be less than 10MB");return}m(f),y(!1)}},E=async a=>{if(!t&&!j){v.error("Please upload your resume");return}g(!0);try{let f;if(j&&x){const T=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}-profile`,{error:$}=await k.storage.from("resumes").copy(x,T);f=$?x:T}else if(t){const T=t.name.split(".").pop();f=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}.${T}`;const{error:$}=await k.storage.from("resumes").upload(f,t);if($)throw $}else{v.error("Please upload your resume"),g(!1);return}const{error:b}=await k.from("job_applications").insert({full_name:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experience_years:parseInt(a.experienceYears),current_company:a.currentCompany||null,linkedin_url:a.linkedinUrl||null,cover_letter:a.coverLetter||null,resume_url:f,user_id:c==null?void 0:c.id});if(b)throw b;await k.functions.invoke("send-notification",{body:{type:"job_application",data:{fullName:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experienceYears:a.experienceYears,currentCompany:a.currentCompany,linkedinUrl:a.linkedinUrl}}}),v.success("Application submitted successfully!"),n()}catch(f){console.error("Error submitting application:",f),v.error("Failed to submit application. Please try again.")}finally{g(!1)}};return w?e.jsx(F,{children:e.jsx(A,{className:"py-12 flex items-center justify-center",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(F,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between",children:[e.jsxs(O,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(he,{className:"w-5 h-5 text-primary"})}),"Apply for ",s.title]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:l,children:e.jsx(we,{className:"w-5 h-5"})})]}),e.jsx(A,{children:e.jsx(xs,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(E),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:p.control,name:"fullName",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Full Name *"}),e.jsx(X,{children:e.jsx(R,{placeholder:"Your full name",...a})}),e.jsx(Z,{})]})}),e.jsx(K,{control:p.control,name:"email",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Email *"}),e.jsx(X,{children:e.jsx(R,{type:"email",placeholder:"you@example.com",...a,disabled:!0})}),e.jsx(Z,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:p.control,name:"phone",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Phone Number *"}),e.jsx(X,{children:e.jsx(ys,{value:a.value,onChange:a.onChange,defaultCountry:"NP"})}),e.jsx(Z,{})]})}),e.jsx(K,{control:p.control,name:"experienceYears",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Years of Experience *"}),e.jsxs(de,{onValueChange:a.onChange,value:a.value,children:[e.jsx(X,{children:e.jsx(me,{children:e.jsx(ue,{placeholder:"Select experience"})})}),e.jsxs(xe,{children:[e.jsx(U,{value:"0",children:"Fresher (0 years)"}),e.jsx(U,{value:"1",children:"1 year"}),e.jsx(U,{value:"2",children:"2 years"}),e.jsx(U,{value:"3",children:"3 years"}),e.jsx(U,{value:"4",children:"4 years"}),e.jsx(U,{value:"5",children:"5+ years"}),e.jsx(U,{value:"7",children:"7+ years"}),e.jsx(U,{value:"10",children:"10+ years"})]})]}),e.jsx(Z,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:p.control,name:"currentCompany",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Current Company"}),e.jsx(X,{children:e.jsx(R,{placeholder:"Your current employer",...a})}),e.jsx(Z,{})]})}),e.jsx(K,{control:p.control,name:"linkedinUrl",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"LinkedIn Profile"}),e.jsx(X,{children:e.jsx(R,{placeholder:"https://linkedin.com/in/yourprofile",...a})}),e.jsx(Z,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(z,{children:"Resume *"}),x&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[e.jsx(os,{id:"useProfileResume",checked:j,onCheckedChange:a=>{y(a),a&&m(null)}}),e.jsxs("label",{htmlFor:"useProfileResume",className:"text-sm flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(he,{className:"w-4 h-4 text-primary"}),"Use resume from my profile"]}),j&&e.jsx(je,{className:"w-4 h-4 text-primary"})]}),!j&&e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:C,className:"hidden",id:"resume-upload"}),e.jsxs("label",{htmlFor:"resume-upload",className:"cursor-pointer",children:[e.jsx(Se,{className:"w-10 h-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t?e.jsx("span",{className:"text-primary font-medium",children:t.name}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary font-medium",children:"Click to upload"})," or drag and drop"]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF or Word (max 10MB)"})]})]})]}),e.jsx(K,{control:p.control,name:"coverLetter",render:({field:a})=>e.jsxs(Q,{children:[e.jsx(z,{children:"Cover Letter (Optional)"}),e.jsx(X,{children:e.jsx(Me,{placeholder:"Tell us why you're interested in this role and what makes you a great fit...",className:"min-h-[120px]",...a})}),e.jsx(Z,{})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t",children:[e.jsx(_,{type:"button",variant:"outline",onClick:l,children:"Cancel"}),e.jsx(_,{type:"submit",disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})})})]})})},Ks=({appliedPositions:s=[],onSavedJobsChange:l,pendingApplyPosition:n,onApplyComplete:c})=>{const{user:t}=ne(),[m,x]=o.useState(""),[u,j]=o.useState("all"),[y,S]=o.useState("all"),[g,w]=o.useState(null),[h,p]=o.useState([]),[d,C]=o.useState(null),[E,a]=o.useState(null),[f,b]=o.useState(s),T=[...new Set(re.map(r=>r.department))],$=[...new Set(re.map(r=>r.type))];o.useEffect(()=>{b(s)},[s]),o.useEffect(()=>{t&&W()},[t]),o.useEffect(()=>{if(n){const r=re.find(L=>L.id===n);r&&(a(r),w(n)),setTimeout(()=>{const L=document.getElementById(`position-${n}`);L&&L.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[n]);const W=async()=>{if(t)try{const{data:r,error:L}=await k.from("saved_jobs").select("position_id").eq("user_id",t.id);if(L)throw L;p((r==null?void 0:r.map(P=>P.position_id))||[])}catch(r){console.error("Error fetching saved jobs:",r)}},i=async(r,L)=>{if(L.stopPropagation(),!t){v.info("Please sign in to save jobs");return}C(r.id);try{if(h.includes(r.id)){const{error:P}=await k.from("saved_jobs").delete().eq("user_id",t.id).eq("position_id",r.id);if(P)throw P;p(M=>M.filter(es=>es!==r.id)),v.success("Job removed from saved list")}else{const{error:P}=await k.from("saved_jobs").insert({user_id:t.id,position_id:r.id,position_title:r.title});if(P)throw P;p(M=>[...M,r.id]),v.success("Job saved for later")}l==null||l()}catch(P){console.error("Error toggling saved job:",P),v.error("Failed to update saved jobs")}finally{C(null)}},N=re.filter(r=>{const L=r.title.toLowerCase().includes(m.toLowerCase())||r.description.toLowerCase().includes(m.toLowerCase())||r.department.toLowerCase().includes(m.toLowerCase()),P=u==="all"||r.department===u,M=y==="all"||r.type===y;return L&&P&&M}),D=r=>{a(r),w(r.id)},G=()=>{E&&b(r=>[...r,E.id]),a(null),c==null||c()},q=r=>f.includes(r),H=r=>h.includes(r);return e.jsxs("div",{className:"space-y-6",children:[E&&e.jsx(Hs,{position:E,onClose:()=>a(null),onSuccess:G}),e.jsx(F,{children:e.jsx(A,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{placeholder:"Search positions...",value:m,onChange:r=>x(r.target.value),className:"pl-10"})]}),e.jsxs(de,{value:u,onValueChange:j,children:[e.jsx(me,{className:"w-full md:w-[180px]",children:e.jsx(ue,{placeholder:"Department"})}),e.jsxs(xe,{children:[e.jsx(U,{value:"all",children:"All Departments"}),T.map(r=>e.jsx(U,{value:r,children:r},r))]})]}),e.jsxs(de,{value:y,onValueChange:S,children:[e.jsx(me,{className:"w-full md:w-[150px]",children:e.jsx(ue,{placeholder:"Type"})}),e.jsxs(xe,{children:[e.jsx(U,{value:"all",children:"All Types"}),$.map(r=>e.jsx(U,{value:r,children:r},r))]})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",N.length," of ",re.length," positions"]}),h.length>0&&e.jsxs(se,{variant:"secondary",children:[e.jsx(ee,{className:"w-3 h-3 mr-1 fill-current"}),h.length," saved"]})]}),e.jsx("div",{className:"space-y-4",children:N.length===0?e.jsx(F,{children:e.jsxs(A,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No positions found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})}):N.map((r,L)=>e.jsx(ae.div,{id:`position-${r.id}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L*.05},children:e.jsx(F,{className:`overflow-hidden hover:shadow-md transition-shadow ${n===r.id?"ring-2 ring-primary":""}`,children:e.jsxs(A,{className:"p-0",children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>w(g===r.id?null:r.id),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.title}),q(r.id)&&e.jsxs(se,{variant:"secondary",className:"bg-primary/10 text-primary",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),"Applied"]}),H(r.id)&&!q(r.id)&&e.jsxs(se,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(ee,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-3.5 h-3.5"}),r.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"w-3.5 h-3.5"}),r.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),r.type]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:r.description})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(_,{size:"icon",variant:"ghost",onClick:P=>i(r,P),disabled:d===r.id,className:"shrink-0",children:d===r.id?e.jsx(I,{className:"w-5 h-5 animate-spin"}):e.jsx(ee,{className:`w-5 h-5 ${H(r.id)?"fill-primary text-primary":"text-muted-foreground"}`})}),!q(r.id)&&e.jsxs(_,{size:"sm",onClick:P=>{P.stopPropagation(),D(r)},children:["Apply Now",e.jsx(be,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{variant:"ghost",size:"icon",children:g===r.id?e.jsx(ds,{className:"w-5 h-5"}):e.jsx(bs,{className:"w-5 h-5"})})]})]})}),e.jsx(fs,{children:g===r.id&&!E&&e.jsx(ae.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 border-t pt-4 bg-muted/30",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Responsibilities"]}),e.jsx("ul",{className:"space-y-2",children:r.responsibilities.map((P,M)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:P})]},M))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Requirements"]}),e.jsx("ul",{className:"space-y-2",children:r.requirements.map((P,M)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:P})]},M))})]})]}),!q(r.id)&&e.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-2",children:[e.jsxs(_,{variant:"outline",onClick:P=>i(r,P),disabled:d===r.id,children:[d===r.id?e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ee,{className:`w-4 h-4 mr-2 ${H(r.id)?"fill-current":""}`}),H(r.id)?"Saved":"Save for Later"]}),e.jsxs(_,{onClick:()=>D(r),children:["Apply for this Position",e.jsx(be,{className:"w-4 h-4 ml-2"})]})]})]})})})]})})},r.id))})]})},Qs=({profile:s,onProfileUpdate:l})=>{const{user:n,updatePassword:c}=ne(),[t,m]=o.useState(!1),[x,u]=o.useState(!1),[j,y]=o.useState(""),[S,g]=o.useState(""),[w,h]=o.useState(""),[p,d]=o.useState(""),C=f=>f?f.split(" ").map(b=>b[0]).join("").toUpperCase().slice(0,2):"U",E=async f=>{var $;const b=($=f.target.files)==null?void 0:$[0];if(!b||!n)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(b.type)){v.error("Please upload a valid image file (JPEG, PNG, GIF, or WebP)");return}if(b.size>2*1024*1024){v.error("Image size must be less than 2MB");return}m(!0);try{const W=b.name.split(".").pop(),i=`${n.id}-${Date.now()}.${W}`,{error:N}=await k.storage.from("avatars").upload(i,b,{upsert:!0});if(N){if(N.message.includes("bucket")){v.error("Avatar storage is being set up. Please try again later.");return}throw N}const{data:D}=k.storage.from("avatars").getPublicUrl(i),{error:G}=await k.from("applicant_profiles").update({avatar_url:D.publicUrl}).eq("user_id",n.id);if(G)throw G;v.success("Profile picture updated!"),l()}catch(W){console.error("Error uploading avatar:",W),v.error("Failed to upload profile picture")}finally{m(!1)}},a=async f=>{if(f.preventDefault(),d(""),S.length<6){d("Password must be at least 6 characters");return}if(S!==w){d("Passwords do not match");return}u(!0);try{const{error:b}=await c(S);if(b)throw b;v.success("Password updated successfully!"),y(""),g(""),h("")}catch(b){console.error("Error changing password:",b),d(b.message||"Failed to update password")}finally{u(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),"Profile Picture"]}),e.jsx(J,{children:"Upload a profile picture to personalize your account"})]}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(Pe,{className:"w-24 h-24 border-4 border-background shadow-lg",children:[e.jsx(Ee,{src:(s==null?void 0:s.avatar_url)||void 0,alt:(s==null?void 0:s.full_name)||"Profile"}),e.jsx(Le,{className:"text-2xl bg-primary/10 text-primary",children:C(s==null?void 0:s.full_name)})]}),t&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 rounded-full",children:e.jsx(I,{className:"w-6 h-6 animate-spin text-primary"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",id:"avatar-upload",accept:"image/jpeg,image/png,image/gif,image/webp",className:"hidden",onChange:E,disabled:t}),e.jsx("label",{htmlFor:"avatar-upload",children:e.jsx(_,{variant:"outline",disabled:t,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:t?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"Upload New Picture"]})})})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"JPEG, PNG, GIF or WebP. Max 2MB."})]})]})})]}),e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Account Information"]}),e.jsx(J,{children:"Your account details and email address"})]}),e.jsx(A,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{className:"text-muted-foreground",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(Be,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:n==null?void 0:n.email}),e.jsx(Ss,{className:"w-4 h-4 text-primary ml-auto"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the email associated with your account"})]}),(s==null?void 0:s.full_name)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{className:"text-muted-foreground",children:"Full Name"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(ce,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can update your name in the Profile tab"})]})]})})]}),e.jsxs(F,{children:[e.jsxs(Y,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(J,{children:"Update your password to keep your account secure"})]}),e.jsx(A,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{id:"new-password",type:"password",placeholder:"Enter new password",value:S,onChange:f=>g(f.target.value),className:"pl-10",minLength:6})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{id:"confirm-password",type:"password",placeholder:"Confirm new password",value:w,onChange:f=>h(f.target.value),className:"pl-10",minLength:6})]})]}),p&&e.jsx("p",{className:"text-sm text-destructive",children:p}),e.jsx(_,{type:"submit",disabled:x||!S||!w,children:x?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})})]})]})},Xs=({onJobRemoved:s})=>{const l=$e(),{user:n}=ne(),[c,t]=o.useState([]),[m,x]=o.useState(!0),[u,j]=o.useState(null);o.useEffect(()=>{n&&y()},[n]);const y=async()=>{if(n)try{const{data:h,error:p}=await k.from("saved_jobs").select("*").eq("user_id",n.id).order("created_at",{ascending:!1});if(p)throw p;t(h||[])}catch(h){console.error("Error fetching saved jobs:",h),v.error("Failed to load saved jobs")}finally{x(!1)}},S=async(h,p)=>{if(n){j(h);try{const{error:d}=await k.from("saved_jobs").delete().eq("id",h).eq("user_id",n.id);if(d)throw d;t(C=>C.filter(E=>E.id!==h)),v.success("Job removed from saved list"),s==null||s()}catch(d){console.error("Error removing saved job:",d),v.error("Failed to remove job")}finally{j(null)}}},g=h=>{sessionStorage.setItem("applyPositionId",h),l("/careers")},w=h=>re.find(p=>p.id===h);return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):c.length===0?e.jsx(F,{children:e.jsxs(A,{className:"py-12 text-center",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Saved Jobs"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Save jobs you're interested in to review them later"}),e.jsx(_,{variant:"outline",onClick:()=>l("/applicant/dashboard"),children:"Browse Open Positions"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.length," saved job",c.length!==1?"s":""]})}),c.map((h,p)=>{const d=w(h.position_id);return e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:p*.05},children:e.jsx(F,{className:"overflow-hidden hover:shadow-md transition-shadow",children:e.jsx(A,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:(d==null?void 0:d.title)||h.position_title}),e.jsxs(se,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(ee,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),d&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-3.5 h-3.5"}),d.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(qe,{className:"w-3.5 h-3.5"}),d.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),d.type]})]}),d&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:d.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Saved on ",new Date(h.created_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(_,{size:"sm",onClick:()=>g(h.position_id),children:["Apply Now",e.jsx(be,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{size:"sm",variant:"ghost",onClick:()=>S(h.id,h.position_id),disabled:u===h.id,children:u===h.id?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]})})})},h.id)})]})},Ta=()=>{const{user:s,isLoading:l,signOut:n}=ne(),c=$e(),[t,m]=o.useState(null),[x,u]=o.useState(!0),[j,y]=o.useState("positions"),[S,g]=o.useState([]),[w,h]=o.useState(null);o.useEffect(()=>{if(l)return;if(!s){c("/applicant/login");return}p(),d();const a=sessionStorage.getItem("applyPositionId");a&&(sessionStorage.removeItem("applyPositionId"),h(a),y("positions"))},[s,l,c]);const p=async()=>{if(!s){u(!1);return}u(!0);try{const{data:a,error:f}=await k.from("applicant_profiles").select("*").eq("user_id",s.id).maybeSingle();if(f)throw f;a&&m(a)}catch(a){console.error("Error fetching profile:",a),v.error("Failed to load profile")}finally{u(!1)}},d=async()=>{if(s)try{const{data:a,error:f}=await k.from("job_applications").select("position").eq("user_id",s.id);if(f)throw f;if(a){const b=a.map(T=>T.position);g(b)}}catch(a){console.error("Error fetching applied positions:",a)}},C=async()=>{await n(),c("/"),v.success("Signed out successfully")},E=a=>a?a.split(" ").map(f=>f[0]).join("").toUpperCase().slice(0,2):"U";return l||x?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{title:"Dashboard | InfraWeave Careers",description:"Manage your profile, track your job applications, and explore new opportunities at InfraWeave."}),e.jsx(ls,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-muted/50 to-background pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Pe,{className:"w-16 h-16 border-4 border-background shadow-lg",children:[e.jsx(Ee,{src:(t==null?void 0:t.avatar_url)||void 0,alt:(t==null?void 0:t.full_name)||"Profile"}),e.jsx(Le,{className:"text-xl bg-primary/10 text-primary",children:E(t==null?void 0:t.full_name)})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold",children:["Welcome",t!=null&&t.full_name?`, ${t.full_name.split(" ")[0]}`:"","!"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Explore opportunities, manage your profile, and track your applications"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(_,{variant:"ghost",onClick:C,children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]}),e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(ts,{value:j,onValueChange:y,className:"space-y-6",children:[e.jsxs(ns,{className:"grid w-full max-w-3xl grid-cols-5",children:[e.jsxs(le,{value:"positions",className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Open Positions"}),e.jsx("span",{className:"sm:hidden",children:"Jobs"})]}),e.jsxs(le,{value:"saved",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved Jobs"}),e.jsx("span",{className:"sm:hidden",children:"Saved"})]}),e.jsxs(le,{value:"applications",className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"My Applications"}),e.jsx("span",{className:"sm:hidden",children:"Applied"})]}),e.jsxs(le,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Profile"]}),e.jsxs(le,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4"}),"Account"]})]}),e.jsx(ie,{value:"positions",className:"space-y-6",children:e.jsx(Ks,{appliedPositions:S,pendingApplyPosition:w,onApplyComplete:()=>{h(null),d()}})}),e.jsx(ie,{value:"saved",className:"space-y-6",children:e.jsx(Xs,{})}),e.jsx(ie,{value:"applications",className:"space-y-6",children:e.jsx(Ws,{userId:(s==null?void 0:s.id)||""})}),e.jsx(ie,{value:"profile",className:"space-y-6",children:e.jsx(Os,{profile:t,onProfileUpdate:p})}),e.jsx(ie,{value:"settings",className:"space-y-6",children:e.jsx(Qs,{profile:t,onProfileUpdate:p})})]})})]})}),e.jsx(is,{})]})};export{Ta as default};
