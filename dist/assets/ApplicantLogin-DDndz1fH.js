import{j as e}from"./vendor-ui--gC2EbFs.js";import{r as i,c as T,L as Y}from"./vendor-react-BKlpBF4k.js";import{B as g}from"./button-B62FVMbw.js";import{I as N}from"./input-6ay25PGO.js";import{e as _,s as j,u as n}from"./main-yjRMi4_h.js";import{m as q}from"./useSessionAuth-BMpXaGwm.js";import{N as C,F as S}from"./Footer-CGwfuX1f.js";import{S as k}from"./SEO-CsnDC1HA.js";import{L as E}from"./loader-circle-R4sbHBsM.js";import{m as F}from"./vendor-motion-DpAY1mMN.js";import{C as G}from"./circle-check-big-BSil5Bog.js";import{A}from"./arrow-left-DdOdJTZh.js";import{M as H}from"./mail-CWLWjjgY.js";import{L as R}from"./lock-C43JJ4ys.js";import{E as U}from"./eye-off-DXWmQRpK.js";import{E as D}from"./eye-CWZESIxI.js";import{o as I,s as b}from"./types-KBJzO2d1.js";import"./vendor-query-CpApZjIr.js";import"./linkedin-BTj0VQ6v.js";const $=I({email:b().email("Please enter a valid email"),password:b().min(6,"Password must be at least 6 characters")}),J=I({email:b().email("Please enter a valid email")}),he=()=>{const[c,P]=i.useState(""),[l,v]=i.useState(""),[d,B]=i.useState(!1),[t,u]=i.useState(!1),[r,x]=i.useState(!1),[L,w]=i.useState(!1),[y,m]=i.useState(!1),{user:p,isLoading:h,signIn:W,signUp:M,resetPassword:V}=_(),f=T();i.useEffect(()=>{const s=sessionStorage.getItem("applicant_session_active");p&&!h&&s&&j.from("admin_users").select("id").eq("user_id",p.id).maybeSingle().then(({data:a})=>{a?f("/admin"):(f("/applicant/dashboard"),n.success("Welcome! Explore opportunities and manage your profile."))})},[p,h,f]);const z=async s=>{s.preventDefault(),m(!0);try{if(r){const a=J.safeParse({email:c});if(!a.success){n.error(a.error.errors[0].message),m(!1);return}const{error:o}=await j.auth.resetPasswordForEmail(c,{redirectTo:`${window.location.origin}/applicant/reset-password`});if(o)throw o;w(!0),n.success("Password reset email sent!")}else{const a=$.safeParse({email:c,password:l});if(!a.success){n.error(a.error.errors[0].message),m(!1);return}if(t){const{error:o}=await M(c,l);if(o)throw o;n.success("Account created! You can now sign in."),u(!1),v("")}else{const{error:o}=await W(c,l);if(o)throw o;q(),n.success("Welcome back!")}}}catch(a){console.error("Auth error:",a),n.error(a.message||"An error occurred")}finally{m(!1)}},O=async()=>{try{const{error:s}=await j.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/applicant/dashboard`}});if(s)throw s}catch(s){n.error(s.message||"Failed to sign in with Google")}};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(E,{className:"w-8 h-8 animate-spin text-primary"})}):L?e.jsxs(e.Fragment,{children:[e.jsx(k,{title:"Check Your Email | InfraWeave Careers",description:"Check your email for the password reset link to access your InfraWeave Careers account."}),e.jsx(C,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-[#EEF4FA] to-background pt-24 pb-16",children:e.jsx("div",{className:"container mx-auto px-4 max-w-md",children:e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-8 rounded-2xl bg-card border border-border shadow-lg text-center",children:[e.jsx(G,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-heading font-bold mb-4",children:"Check Your Email"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["We've sent a password reset link to ",e.jsx("strong",{children:c})]}),e.jsxs(g,{onClick:()=>{w(!1),x(!1)},variant:"outline",className:"w-full",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})})}),e.jsx(S,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{title:t?"Create Account | InfraWeave Careers":"Sign In | InfraWeave Careers",description:t?"Create your InfraWeave Careers account to apply for jobs and track your applications.":"Sign in to your InfraWeave Careers account to manage your profile and track job applications."}),e.jsx(C,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-[#EEF4FA] to-background pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-md",children:[e.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-8 rounded-2xl bg-card border border-border shadow-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-heading font-bold",children:r?"Reset Password":t?"Create Your Account":"Welcome Back"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:r?"Enter your email to receive a reset link":t?"Join our talent network and find your next opportunity":"Sign in to track your applications"})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{type:"button",variant:"outline",className:"w-full mb-4 h-12",onClick:O,children:[e.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or continue with email"})})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(N,{type:"email",placeholder:"you@example.com",value:c,onChange:s=>P(s.target.value),className:"pl-10 h-12",required:!0})]})]}),!r&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(N,{type:d?"text":"password",placeholder:"••••••••",value:l,onChange:s=>v(s.target.value),className:"pl-10 pr-10 h-12",required:!0}),e.jsx("button",{type:"button",onClick:()=>B(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:d?e.jsx(U,{className:"w-5 h-5"}):e.jsx(D,{className:"w-5 h-5"})})]})]}),!t&&!r&&e.jsx("div",{className:"text-right",children:e.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-sm text-primary hover:underline",children:"Forgot password?"})}),e.jsx(g,{type:"submit",className:"w-full h-12",disabled:y,children:y?e.jsx(E,{className:"w-5 h-5 animate-spin"}):r?"Send Reset Link":t?"Create Account":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:r?e.jsx("button",{onClick:()=>x(!1),className:"text-primary hover:underline",children:"Back to sign in"}):t?e.jsxs(e.Fragment,{children:["Already have an account?"," ",e.jsx("button",{onClick:()=>u(!1),className:"text-primary hover:underline font-medium",children:"Sign in"})]}):e.jsxs(e.Fragment,{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>u(!0),className:"text-primary hover:underline font-medium",children:"Create one"})]})}),t&&e.jsx("p",{className:"mt-4 text-xs text-center text-muted-foreground",children:"By creating an account, you agree to receive our newsletter and updates about job opportunities."})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(Y,{to:"/careers/",className:"text-sm text-muted-foreground hover:text-primary",children:[e.jsx(A,{className:"w-4 h-4 inline mr-1"}),"Back to Careers"]})})]})}),e.jsx(S,{})]})};export{he as default};
