import{j as e,f as ss,h as Se}from"./vendor-ui--gC2EbFs.js";import{r as l,L as as,c as $e}from"./vendor-react-BKlpBF4k.js";import{B as _}from"./button-BGexsc1Z.js";import{d as De,U as re,P as Le,L as rs,T as ts,a as ls,b as ne,c as ie}from"./tabs-DeyifJVD.js";import{P as Pe}from"./index-CId5GkVU.js";import{c as Ae,a as ge,e as se,u as y,X as Ce,s as P}from"./main-BJksuSgA.js";import{c as ns}from"./useSessionAuth-DPfuQBuh.js";import{A as _e,N as is,F as os}from"./Footer-qqPHEfWH.js";import{S as cs}from"./SEO-DkrNIxUx.js";import{I as T}from"./input-2Qusnpvj.js";import{T as Me}from"./dialog-CyfFgSnW.js";import{e as A,i as q,j as z,k as X,f as E,B as V,S as ce,a as de,b as me,c as ue,d as R,g as ee,C as ds,h as ms}from"./checkbox-MCBRKF5Y.js";import{F as pe}from"./file-text-C9xtyKp0.js";import{C as Ne}from"./circle-check-big-BlLtF1-z.js";import{L as F}from"./loader-circle-2-EN6opG.js";import{U as ke,u as us,t as ps,F as xs,a as K,b as G,c as Y,d as J,e as Q,p as ae}from"./form-HMG2lF0w.js";import{M as Ve}from"./mail-Dq2eRyuU.js";import{P as hs}from"./phone-Baw9g0la.js";import{L as fs}from"./linkedin-rD6aTwyb.js";import{B as ye}from"./building-2-DTcxvgHq.js";import{A as Fe}from"./award-D6SVTOh-.js";import{m as B,A as js}from"./vendor-motion-DpAY1mMN.js";import{C as gs}from"./calendar-CHkLj62h.js";import{C as xe}from"./clock-P6_-i9uM.js";import{C as Ns}from"./circle-x-LpfuE0tw.js";import{C as ys}from"./circle-alert-I1NIuTV9.js";import{P as vs}from"./phone-input-CIyga_M4.js";import{o as ws,s as M,l as bs}from"./types-KBJzO2d1.js";import{S as Be}from"./search-BEhK9lj9.js";import{M as Ye}from"./map-pin-2GsZjYDs.js";import{C as Ss}from"./chevron-down-DROOaVXA.js";import{L as oe}from"./label-CnbrxAqo.js";import{C as Ie}from"./check-CBeTEWwJ.js";import{S as Cs}from"./shield-Cess2Y5F.js";import{L as we}from"./lock-B5hkHWNR.js";import{S as _s}from"./settings-BsvkMox2.js";import"./vendor-query-CpApZjIr.js";import"./index-BdQq_4o_.js";import"./popover-DTzroaSP.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=Ae("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function Ps(s,n=[]){let t=[];function c(d,u){const p=l.createContext(u);p.displayName=d+"Context";const j=t.length;t=[...t,u];const N=g=>{const{scope:S,children:h,...f}=g,m=S?.[s]?.[j]||p,b=l.useMemo(()=>f,Object.values(f));return e.jsx(m.Provider,{value:b,children:h})};N.displayName=d+"Provider";function w(g,S){const h=S?.[s]?.[j]||p,f=l.useContext(h);if(f)return f;if(u!==void 0)return u;throw new Error(`\`${g}\` must be used within \`${d}\``)}return[N,w]}const i=()=>{const d=t.map(u=>l.createContext(u));return function(p){const j=p?.[s]||d;return l.useMemo(()=>({[`__scope${s}`]:{...p,[s]:j}}),[p,j])}};return i.scopeName=s,[c,As(i,...n)]}function As(...s){const n=s[0];if(s.length===1)return n;const t=()=>{const c=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(d){const u=c.reduce((p,{useScope:j,scopeName:N})=>{const g=j(d)[`__scope${N}`];return{...p,...g}},{});return l.useMemo(()=>({[`__scope${n.scopeName}`]:u}),[u])}};return t.scopeName=n.scopeName,t}var qe={exports:{}},ze={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te=l;function Es(s,n){return s===n&&(s!==0||1/s===1/n)||s!==s&&n!==n}var Ls=typeof Object.is=="function"?Object.is:Es,Fs=te.useState,Is=te.useEffect,Rs=te.useLayoutEffect,Ts=te.useDebugValue;function Us(s,n){var t=n(),c=Fs({inst:{value:t,getSnapshot:n}}),i=c[0].inst,d=c[1];return Rs(function(){i.value=t,i.getSnapshot=n,be(i)&&d({inst:i})},[s,t,n]),Is(function(){return be(i)&&d({inst:i}),s(function(){be(i)&&d({inst:i})})},[s]),Ts(t),t}function be(s){var n=s.getSnapshot;s=s.value;try{var t=n();return!Ls(s,t)}catch{return!0}}function $s(s,n){return n()}var Ds=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$s:Us;ze.useSyncExternalStore=te.useSyncExternalStore!==void 0?te.useSyncExternalStore:Ds;qe.exports=ze;var Ms=qe.exports;function Vs(){return Ms.useSyncExternalStore(Bs,()=>!0,()=>!1)}function Bs(){return()=>{}}var Ee="Avatar",[Ys]=Ps(Ee),[qs,Oe]=Ys(Ee),He=l.forwardRef((s,n)=>{const{__scopeAvatar:t,...c}=s,[i,d]=l.useState("idle");return e.jsx(qs,{scope:t,imageLoadingStatus:i,onImageLoadingStatusChange:d,children:e.jsx(Pe.span,{...c,ref:n})})});He.displayName=Ee;var We="AvatarImage",Ke=l.forwardRef((s,n)=>{const{__scopeAvatar:t,src:c,onLoadingStatusChange:i=()=>{},...d}=s,u=Oe(We,t),p=zs(c,d),j=ss(N=>{i(N),u.onImageLoadingStatusChange(N)});return Se(()=>{p!=="idle"&&j(p)},[p,j]),p==="loaded"?e.jsx(Pe.img,{...d,ref:n,src:c}):null});Ke.displayName=We;var Ge="AvatarFallback",Je=l.forwardRef((s,n)=>{const{__scopeAvatar:t,delayMs:c,...i}=s,d=Oe(Ge,t),[u,p]=l.useState(c===void 0);return l.useEffect(()=>{if(c!==void 0){const j=window.setTimeout(()=>p(!0),c);return()=>window.clearTimeout(j)}},[c]),u&&d.imageLoadingStatus!=="loaded"?e.jsx(Pe.span,{...i,ref:n}):null});Je.displayName=Ge;function Te(s,n){return s?n?(s.src!==n&&(s.src=n),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function zs(s,{referrerPolicy:n,crossOrigin:t}){const c=Vs(),i=l.useRef(null),d=c?(i.current||(i.current=new window.Image),i.current):null,[u,p]=l.useState(()=>Te(d,s));return Se(()=>{p(Te(d,s))},[d,s]),Se(()=>{const j=g=>()=>{p(g)};if(!d)return;const N=j("loaded"),w=j("error");return d.addEventListener("load",N),d.addEventListener("error",w),n&&(d.referrerPolicy=n),typeof t=="string"&&(d.crossOrigin=t),()=>{d.removeEventListener("load",N),d.removeEventListener("error",w)}},[d,t,n]),u}var Qe=He,Xe=Ke,Ze=Je;const he=l.forwardRef(({className:s,...n},t)=>e.jsx(Qe,{ref:t,className:ge("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...n}));he.displayName=Qe.displayName;const fe=l.forwardRef(({className:s,...n},t)=>e.jsx(Xe,{ref:t,className:ge("aspect-square h-full w-full",s),...n}));fe.displayName=Xe.displayName;const je=l.forwardRef(({className:s,...n},t)=>e.jsx(Ze,{ref:t,className:ge("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...n}));je.displayName=Ze.displayName;const Os=5*60*1e3;function Hs(){const{user:s,signOut:n}=se(),t=l.useRef(null),c=l.useRef(Date.now()),i=l.useCallback(async()=>{s&&(await n(),y.info("You have been logged out due to inactivity"),sessionStorage.removeItem("applicant_session_active"),window.location.href="/careers")},[s,n]),d=l.useCallback(()=>{c.current=Date.now(),t.current&&clearTimeout(t.current),s&&(t.current=setTimeout(()=>{i()},Os))},[s,i]);return l.useEffect(()=>{if(!s)return;const u=["mousedown","mousemove","keydown","scroll","touchstart","click"],p=()=>{d()};return u.forEach(j=>{document.addEventListener(j,p,{passive:!0})}),d(),()=>{u.forEach(j=>{document.removeEventListener(j,p)}),t.current&&clearTimeout(t.current)}},[s,d]),{resetTimer:d}}const Ws=({profile:s,onProfileUpdate:n})=>{const{user:t}=se(),[c,i]=l.useState(!1),[d,u]=l.useState(!1),[p,j]=l.useState(!1),[N,w]=l.useState(!1),[g,S]=l.useState(""),[h,f]=l.useState(""),[m,b]=l.useState({full_name:s?.full_name||"",phone:s?.phone||"",linkedin_url:s?.linkedin_url||"",current_company:s?.current_company||"",experience_years:s?.experience_years||0,bio:s?.bio||"",skills:s?.skills||[],certifications:s?.certifications||[]}),L=async()=>{if(t){u(!0);try{const{error:o}=await P.from("applicant_profiles").update({full_name:m.full_name||null,phone:m.phone||null,linkedin_url:m.linkedin_url||null,current_company:m.current_company||null,experience_years:m.experience_years,bio:m.bio||null,skills:m.skills,certifications:m.certifications}).eq("user_id",t.id);if(o)throw o;y.success("Profile updated successfully!"),i(!1),n()}catch(o){console.error("Error updating profile:",o),y.error(o.message||"Failed to update profile")}finally{u(!1)}}},a=async o=>{const v=o.target.files?.[0];if(!v||!t)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(v.type)){y.error("Please upload a PDF or Word document");return}if(v.size>10*1024*1024){y.error("File size must be less than 10MB");return}j(!0);try{const le=v.name.split(".").pop(),H=`profile-${t.id}-${Date.now()}.${le}`;s?.resume_url&&await P.storage.from("resumes").remove([s.resume_url]);const{error:W}=await P.storage.from("resumes").upload(H,v,{upsert:!0});if(W)throw W;const{error:r}=await P.from("applicant_profiles").update({resume_url:H}).eq("user_id",t.id);if(r)throw r;y.success("Resume uploaded successfully!"),n()}catch(le){console.error("Error uploading resume:",le),y.error("Failed to upload resume")}finally{j(!1)}},x=async()=>{if(!(!t||!s?.resume_url)){w(!0);try{await P.storage.from("resumes").remove([s.resume_url]);const{error:o}=await P.from("applicant_profiles").update({resume_url:null}).eq("user_id",t.id);if(o)throw o;y.success("Resume removed"),n()}catch(o){console.error("Error deleting resume:",o),y.error("Failed to remove resume")}finally{w(!1)}}},C=()=>{g.trim()&&!m.skills.includes(g.trim())&&(b(o=>({...o,skills:[...o.skills,g.trim()]})),S(""))},U=o=>{b(v=>({...v,skills:v.skills.filter(O=>O!==o)}))},$=()=>{h.trim()&&!m.certifications.includes(h.trim())&&(b(o=>({...o,certifications:[...o.certifications,h.trim()]})),f(""))},ve=o=>{b(v=>({...v,certifications:v.certifications.filter(O=>O!==o)}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"Resume"]}),e.jsx(X,{children:"Upload your resume to auto-fill job applications"})]}),e.jsx(E,{children:s?.resume_url?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(pe,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:["Resume uploaded",e.jsx(Ne,{className:"w-4 h-4 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This will be used when you apply for jobs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",id:"resume-replace",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:p}),e.jsx("label",{htmlFor:"resume-replace",children:e.jsx(_,{variant:"outline",size:"sm",disabled:p,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:p?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Replace"]})})})}),e.jsx(_,{variant:"ghost",size:"sm",onClick:x,disabled:N,children:N?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[e.jsx(Re,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"font-medium mb-1",children:"No resume uploaded"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload your resume to speed up job applications"}),e.jsx("input",{type:"file",id:"resume-upload",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:p}),e.jsx("label",{htmlFor:"resume-upload",children:e.jsx(_,{disabled:p,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:p?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Upload Resume"]})})})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"PDF or Word document, max 10MB"})]})})]}),e.jsxs(A,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Profile Information"]}),e.jsx(X,{children:"Keep your profile updated to get noticed by recruiters"})]}),c?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(_,{onClick:L,disabled:d,children:[d?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Save"]})]}):e.jsx(_,{onClick:()=>i(!0),children:"Edit Profile"})]}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"})," Full Name"]}),c?e.jsx(T,{value:m.full_name,onChange:o=>b(v=>({...v,full_name:o.target.value})),placeholder:"Your full name"}):e.jsx("p",{className:"text-foreground",children:s?.full_name||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"})," Email"]}),e.jsx("p",{className:"text-foreground",children:s?.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(hs,{className:"w-4 h-4"})," Phone"]}),c?e.jsx(T,{value:m.phone,onChange:o=>b(v=>({...v,phone:o.target.value})),placeholder:"Your phone number"}):e.jsx("p",{className:"text-foreground",children:s?.phone||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(fs,{className:"w-4 h-4"})," LinkedIn"]}),c?e.jsx(T,{value:m.linkedin_url,onChange:o=>b(v=>({...v,linkedin_url:o.target.value})),placeholder:"https://linkedin.com/in/yourprofile"}):e.jsx("p",{className:"text-foreground",children:s?.linkedin_url?e.jsx("a",{href:s.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"View Profile"}):"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"})," Current Company"]}),c?e.jsx(T,{value:m.current_company,onChange:o=>b(v=>({...v,current_company:o.target.value})),placeholder:"Your current company"}):e.jsx("p",{className:"text-foreground",children:s?.current_company||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"})," Experience"]}),c?e.jsxs(ce,{value:m.experience_years.toString(),onValueChange:o=>b(v=>({...v,experience_years:parseInt(o)})),children:[e.jsx(de,{children:e.jsx(me,{})}),e.jsx(ue,{children:[0,1,2,3,4,5,6,7,8,9,10,15,20].map(o=>e.jsx(R,{value:o.toString(),children:o===0?"Fresh Graduate":`${o}+ years`},o))})]}):e.jsx("p",{className:"text-foreground",children:s?.experience_years===0?"Fresh Graduate":`${s?.experience_years}+ years`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"})," Bio"]}),c?e.jsx(Me,{value:m.bio,onChange:o=>b(v=>({...v,bio:o.target.value})),placeholder:"Tell us about yourself, your career goals, and what you're looking for...",rows:4}):e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:s?.bio||"No bio provided"})]})]})]}),e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Skills"]}),e.jsx(X,{children:"Add your technical and soft skills"})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[m.skills.map(o=>e.jsxs(ee,{variant:"secondary",className:"text-sm py-1 px-3",children:[o,c&&e.jsx("button",{onClick:()=>U(o),className:"ml-2",children:e.jsx(Ce,{className:"w-3 h-3"})})]},o)),m.skills.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No skills added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{value:g,onChange:o=>S(o.target.value),placeholder:"Add a skill (e.g., Python, Kubernetes)",onKeyPress:o=>o.key==="Enter"&&(o.preventDefault(),C())}),e.jsx(_,{type:"button",onClick:C,variant:"outline",children:e.jsx(Le,{className:"w-4 h-4"})})]})]})]}),e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Certifications"]}),e.jsx(X,{children:"List your professional certifications"})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[m.certifications.map(o=>e.jsxs(ee,{variant:"outline",className:"text-sm py-1 px-3",children:[o,c&&e.jsx("button",{onClick:()=>ve(o),className:"ml-2",children:e.jsx(Ce,{className:"w-3 h-3"})})]},o)),m.certifications.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No certifications added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{value:h,onChange:o=>f(o.target.value),placeholder:"Add a certification (e.g., AWS Solutions Architect)",onKeyPress:o=>o.key==="Enter"&&(o.preventDefault(),$())}),e.jsx(_,{type:"button",onClick:$,variant:"outline",children:e.jsx(Le,{className:"w-4 h-4"})})]})]})]})]})},Ue=s=>{switch(s.toLowerCase()){case"pending":return{icon:xe,color:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",label:"Under Review"};case"reviewed":return{icon:ys,color:"bg-blue-500/10 text-blue-600 border-blue-500/30",label:"Reviewed"};case"interviewed":return{icon:V,color:"bg-purple-500/10 text-purple-600 border-purple-500/30",label:"Interview Stage"};case"hired":return{icon:Ne,color:"bg-green-500/10 text-green-600 border-green-500/30",label:"Hired!"};case"rejected":return{icon:Ns,color:"bg-red-500/10 text-red-600 border-red-500/30",label:"Not Selected"};default:return{icon:xe,color:"bg-muted text-muted-foreground",label:s}}},Ks=({userId:s})=>{const[n,t]=l.useState([]),[c,i]=l.useState(!0);l.useEffect(()=>{d()},[s]);const d=async()=>{if(s)try{const{data:u,error:p}=await P.from("job_applications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(p)throw p;t(u||[])}catch(u){console.error("Error fetching applications:",u),y.error("Failed to load applications")}finally{i(!1)}};return c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(F,{className:"w-8 h-8 animate-spin text-primary"})}):n.length===0?e.jsx(A,{children:e.jsxs(E,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-16 h-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Applications Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't applied to any positions yet. Browse our open positions and start your journey!"}),e.jsx(as,{to:"/careers",children:e.jsxs(_,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Browse Open Positions"]})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold",children:["Your Applications (",n.length,")"]})}),e.jsx("div",{className:"grid gap-4",children:n.map((u,p)=>{const j=Ue(u.status),N=j.icon;return e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:p*.1},children:e.jsx(A,{className:"hover:shadow-md transition-shadow",children:e.jsxs(E,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(V,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:u.position}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(gs,{className:"w-4 h-4"}),"Applied ",new Date(u.created_at).toLocaleDateString()]}),u.current_company&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-4 h-4"}),u.current_company]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(ee,{variant:"outline",className:j.color,children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),j.label]})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:["pending","reviewed","interviewed","hired"].map((w,g)=>{const S=Ue(w),h=S.icon,f=["pending","reviewed","interviewed","hired"].indexOf(u.status.toLowerCase()),m=g<=f&&u.status.toLowerCase()!=="rejected",b=g===f;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${m?b?S.color:"bg-green-500/10 text-green-600":"bg-muted text-muted-foreground"}`,children:[e.jsx(h,{className:"w-3 h-3"}),S.label]}),g<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${g<f&&u.status.toLowerCase()!=="rejected"?"bg-green-500":"bg-muted"}`})]},w)})})})]})})},u.id)})})]})},Gs=ws({fullName:M().min(2,"Name must be at least 2 characters").max(100,"Name is too long"),email:M().email("Please enter a valid email"),phone:M().min(10,"Please enter a valid phone number"),position:M().min(1,"Please select a position"),positionId:M().min(1,"Position ID is required"),experienceYears:M().min(1,"Please select your experience"),currentCompany:M().optional(),linkedinUrl:M().url("Please enter a valid URL").optional().or(bs("")),coverLetter:M().max(2e3,"Cover letter is too long").optional()}),Js=({position:s,onClose:n,onSuccess:t})=>{const{user:c}=se(),[i,d]=l.useState(null),[u,p]=l.useState(null),[j,N]=l.useState(!1),[w,g]=l.useState(!1),[S,h]=l.useState(!0),f=us({resolver:ps(Gs),defaultValues:{fullName:"",email:c?.email||"",phone:"",position:s.title,positionId:s.id,experienceYears:"",currentCompany:"",linkedinUrl:"",coverLetter:""}});l.useEffect(()=>{c&&m()},[c]);const m=async()=>{if(c){h(!0);try{const{data:a,error:x}=await P.from("applicant_profiles").select("*").eq("user_id",c.id).maybeSingle();if(x)throw x;a&&(a.full_name&&f.setValue("fullName",a.full_name),a.phone&&f.setValue("phone",a.phone),a.linkedin_url&&f.setValue("linkedinUrl",a.linkedin_url),a.current_company&&f.setValue("currentCompany",a.current_company),a.experience_years!==null&&a.experience_years!==void 0&&f.setValue("experienceYears",a.experience_years.toString()),a.resume_url&&(p(a.resume_url),N(!0)))}catch(a){console.error("Error fetching profile:",a)}finally{h(!1)}}},b=a=>{const x=a.target.files?.[0];if(x){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(x.type)){y.error("Please upload a PDF or Word document");return}if(x.size>10*1024*1024){y.error("File size must be less than 10MB");return}d(x),N(!1)}},L=async a=>{if(!i&&!j){y.error("Please upload your resume");return}g(!0);try{let x;if(j&&u){const U=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}-profile`,{error:$}=await P.storage.from("resumes").copy(u,U);x=$?u:U}else if(i){const U=i.name.split(".").pop();x=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}.${U}`;const{error:$}=await P.storage.from("resumes").upload(x,i);if($)throw $}else{y.error("Please upload your resume"),g(!1);return}const{error:C}=await P.from("job_applications").insert({full_name:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experience_years:parseInt(a.experienceYears),current_company:a.currentCompany||null,linkedin_url:a.linkedinUrl||null,cover_letter:a.coverLetter||null,resume_url:x,user_id:c?.id});if(C)throw C;await P.functions.invoke("send-notification",{body:{type:"job_application",data:{fullName:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experienceYears:a.experienceYears,currentCompany:a.currentCompany,linkedinUrl:a.linkedinUrl}}}),y.success("Application submitted successfully!"),t()}catch(x){console.error("Error submitting application:",x),y.error("Failed to submit application. Please try again.")}finally{g(!1)}};return S?e.jsx(A,{children:e.jsx(E,{className:"py-12 flex items-center justify-center",children:e.jsx(F,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(A,{children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsxs(z,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(pe,{className:"w-5 h-5 text-primary"})}),"Apply for ",s.title]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:n,children:e.jsx(Ce,{className:"w-5 h-5"})})]}),e.jsx(E,{children:e.jsx(xs,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(L),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"fullName",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Full Name *"}),e.jsx(J,{children:e.jsx(T,{placeholder:"Your full name",...a})}),e.jsx(Q,{})]})}),e.jsx(K,{control:f.control,name:"email",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Email *"}),e.jsx(J,{children:e.jsx(T,{type:"email",placeholder:"you@example.com",...a,disabled:!0})}),e.jsx(Q,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"phone",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Phone Number *"}),e.jsx(J,{children:e.jsx(vs,{value:a.value,onChange:a.onChange,defaultCountry:"NP"})}),e.jsx(Q,{})]})}),e.jsx(K,{control:f.control,name:"experienceYears",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Years of Experience *"}),e.jsxs(ce,{onValueChange:a.onChange,value:a.value,children:[e.jsx(J,{children:e.jsx(de,{children:e.jsx(me,{placeholder:"Select experience"})})}),e.jsxs(ue,{children:[e.jsx(R,{value:"0",children:"Fresher (0 years)"}),e.jsx(R,{value:"1",children:"1 year"}),e.jsx(R,{value:"2",children:"2 years"}),e.jsx(R,{value:"3",children:"3 years"}),e.jsx(R,{value:"4",children:"4 years"}),e.jsx(R,{value:"5",children:"5+ years"}),e.jsx(R,{value:"7",children:"7+ years"}),e.jsx(R,{value:"10",children:"10+ years"})]})]}),e.jsx(Q,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"currentCompany",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Current Company"}),e.jsx(J,{children:e.jsx(T,{placeholder:"Your current employer",...a})}),e.jsx(Q,{})]})}),e.jsx(K,{control:f.control,name:"linkedinUrl",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"LinkedIn Profile"}),e.jsx(J,{children:e.jsx(T,{placeholder:"https://linkedin.com/in/yourprofile",...a})}),e.jsx(Q,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Y,{children:"Resume *"}),u&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[e.jsx(ds,{id:"useProfileResume",checked:j,onCheckedChange:a=>{N(a),a&&d(null)}}),e.jsxs("label",{htmlFor:"useProfileResume",className:"text-sm flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(pe,{className:"w-4 h-4 text-primary"}),"Use resume from my profile"]}),j&&e.jsx(Ne,{className:"w-4 h-4 text-primary"})]}),!j&&e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:b,className:"hidden",id:"resume-upload"}),e.jsxs("label",{htmlFor:"resume-upload",className:"cursor-pointer",children:[e.jsx(ke,{className:"w-10 h-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?e.jsx("span",{className:"text-primary font-medium",children:i.name}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary font-medium",children:"Click to upload"})," or drag and drop"]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF or Word (max 10MB)"})]})]})]}),e.jsx(K,{control:f.control,name:"coverLetter",render:({field:a})=>e.jsxs(G,{children:[e.jsx(Y,{children:"Cover Letter (Optional)"}),e.jsx(J,{children:e.jsx(Me,{placeholder:"Tell us why you're interested in this role and what makes you a great fit...",className:"min-h-[120px]",...a})}),e.jsx(Q,{})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t",children:[e.jsx(_,{type:"button",variant:"outline",onClick:n,children:"Cancel"}),e.jsx(_,{type:"submit",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})})})]})})},Qs=({appliedPositions:s=[],onSavedJobsChange:n,pendingApplyPosition:t,onApplyComplete:c})=>{const{user:i}=se(),[d,u]=l.useState(""),[p,j]=l.useState("all"),[N,w]=l.useState("all"),[g,S]=l.useState(null),[h,f]=l.useState([]),[m,b]=l.useState(null),[L,a]=l.useState(null),[x,C]=l.useState(s),U=[...new Set(ae.map(r=>r.department))],$=[...new Set(ae.map(r=>r.type))];l.useEffect(()=>{C(s)},[s]),l.useEffect(()=>{i&&ve()},[i]),l.useEffect(()=>{if(t){const r=ae.find(I=>I.id===t);r&&(a(r),S(t)),setTimeout(()=>{const I=document.getElementById(`position-${t}`);I&&I.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[t]);const ve=async()=>{if(i)try{const{data:r,error:I}=await P.from("saved_jobs").select("position_id").eq("user_id",i.id);if(I)throw I;f(r?.map(k=>k.position_id)||[])}catch(r){console.error("Error fetching saved jobs:",r)}},o=async(r,I)=>{if(I.stopPropagation(),!i){y.info("Please sign in to save jobs");return}b(r.id);try{if(h.includes(r.id)){const{error:k}=await P.from("saved_jobs").delete().eq("user_id",i.id).eq("position_id",r.id);if(k)throw k;f(D=>D.filter(es=>es!==r.id)),y.success("Job removed from saved list")}else{const{error:k}=await P.from("saved_jobs").insert({user_id:i.id,position_id:r.id,position_title:r.title});if(k)throw k;f(D=>[...D,r.id]),y.success("Job saved for later")}n?.()}catch(k){console.error("Error toggling saved job:",k),y.error("Failed to update saved jobs")}finally{b(null)}},v=ae.filter(r=>{const I=r.title.toLowerCase().includes(d.toLowerCase())||r.description.toLowerCase().includes(d.toLowerCase())||r.department.toLowerCase().includes(d.toLowerCase()),k=p==="all"||r.department===p,D=N==="all"||r.type===N;return I&&k&&D}),O=r=>{a(r),S(r.id)},le=()=>{L&&C(r=>[...r,L.id]),a(null),c?.()},H=r=>x.includes(r),W=r=>h.includes(r);return e.jsxs("div",{className:"space-y-6",children:[L&&e.jsx(Js,{position:L,onClose:()=>a(null),onSuccess:le}),e.jsx(A,{children:e.jsx(E,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search positions...",value:d,onChange:r=>u(r.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:p,onValueChange:j,children:[e.jsx(de,{className:"w-full md:w-[180px]",children:e.jsx(me,{placeholder:"Department"})}),e.jsxs(ue,{children:[e.jsx(R,{value:"all",children:"All Departments"}),U.map(r=>e.jsx(R,{value:r,children:r},r))]})]}),e.jsxs(ce,{value:N,onValueChange:w,children:[e.jsx(de,{className:"w-full md:w-[150px]",children:e.jsx(me,{placeholder:"Type"})}),e.jsxs(ue,{children:[e.jsx(R,{value:"all",children:"All Types"}),$.map(r=>e.jsx(R,{value:r,children:r},r))]})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",v.length," of ",ae.length," positions"]}),h.length>0&&e.jsxs(ee,{variant:"secondary",children:[e.jsx(Z,{className:"w-3 h-3 mr-1 fill-current"}),h.length," saved"]})]}),e.jsx("div",{className:"space-y-4",children:v.length===0?e.jsx(A,{children:e.jsxs(E,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No positions found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})}):v.map((r,I)=>e.jsx(B.div,{id:`position-${r.id}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:I*.05},children:e.jsx(A,{className:`overflow-hidden hover:shadow-md transition-shadow ${t===r.id?"ring-2 ring-primary":""}`,children:e.jsxs(E,{className:"p-0",children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>S(g===r.id?null:r.id),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.title}),H(r.id)&&e.jsxs(ee,{variant:"secondary",className:"bg-primary/10 text-primary",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),"Applied"]}),W(r.id)&&!H(r.id)&&e.jsxs(ee,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(Z,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3.5 h-3.5"}),r.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),r.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3.5 h-3.5"}),r.type]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:r.description})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(_,{size:"icon",variant:"ghost",onClick:k=>o(r,k),disabled:m===r.id,className:"shrink-0",children:m===r.id?e.jsx(F,{className:"w-5 h-5 animate-spin"}):e.jsx(Z,{className:`w-5 h-5 ${W(r.id)?"fill-primary text-primary":"text-muted-foreground"}`})}),!H(r.id)&&e.jsxs(_,{size:"sm",onClick:k=>{k.stopPropagation(),O(r)},children:["Apply Now",e.jsx(_e,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{variant:"ghost",size:"icon",children:g===r.id?e.jsx(ms,{className:"w-5 h-5"}):e.jsx(Ss,{className:"w-5 h-5"})})]})]})}),e.jsx(js,{children:g===r.id&&!L&&e.jsx(B.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 border-t pt-4 bg-muted/30",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Responsibilities"]}),e.jsx("ul",{className:"space-y-2",children:r.responsibilities.map((k,D)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:k})]},D))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Requirements"]}),e.jsx("ul",{className:"space-y-2",children:r.requirements.map((k,D)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:k})]},D))})]})]}),!H(r.id)&&e.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-2",children:[e.jsxs(_,{variant:"outline",onClick:k=>o(r,k),disabled:m===r.id,children:[m===r.id?e.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Z,{className:`w-4 h-4 mr-2 ${W(r.id)?"fill-current":""}`}),W(r.id)?"Saved":"Save for Later"]}),e.jsxs(_,{onClick:()=>O(r),children:["Apply for this Position",e.jsx(_e,{className:"w-4 h-4 ml-2"})]})]})]})})})]})})},r.id))})]})},Xs=[{id:"male-1",url:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-2",url:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-3",url:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-4",url:"https://images.unsplash.com/photo-1463453091185-61582044d556?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-5",url:"https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-6",url:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"female-1",url:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-2",url:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-3",url:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-4",url:"https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-5",url:"https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-6",url:"https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face",label:"Female"}],Zs=({profile:s,onProfileUpdate:n})=>{const{user:t,updatePassword:c}=se(),[i,d]=l.useState(!1),[u,p]=l.useState(s?.avatar_url||null),[j,N]=l.useState(!1),[w,g]=l.useState(""),[S,h]=l.useState(""),[f,m]=l.useState(""),b=x=>x?x.split(" ").map(C=>C[0]).join("").toUpperCase().slice(0,2):"U",L=async x=>{if(t){d(!0),p(x);try{const{error:C}=await P.from("applicant_profiles").update({avatar_url:x}).eq("user_id",t.id);if(C)throw C;y.success("Avatar updated!"),n()}catch(C){console.error("Error updating avatar:",C),y.error("Failed to update avatar"),p(s?.avatar_url||null)}finally{d(!1)}}},a=async x=>{if(x.preventDefault(),m(""),w.length<6){m("Password must be at least 6 characters");return}if(w!==S){m("Passwords do not match");return}N(!0);try{const{error:C}=await c(w);if(C)throw C;y.success("Password updated successfully!"),g(""),h("")}catch(C){console.error("Error changing password:",C),m(C.message||"Failed to update password")}finally{N(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Choose Avatar"]}),e.jsx(X,{children:"Select an avatar to personalize your profile"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(he,{className:"w-20 h-20 border-4 border-background shadow-lg",children:[e.jsx(fe,{src:u||void 0,alt:s?.full_name||"Profile"}),e.jsx(je,{className:"text-2xl bg-primary/10 text-primary",children:b(s?.full_name)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s?.full_name||"Your Avatar"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click an avatar below to change"})]}),i&&e.jsx(F,{className:"w-5 h-5 animate-spin text-primary ml-auto"})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3 pt-4",children:Xs.map(x=>e.jsxs(B.button,{type:"button",onClick:()=>L(x.url),disabled:i,whileHover:{scale:1.05},whileTap:{scale:.95},className:ge("relative p-1 rounded-full transition-all duration-200","hover:ring-2 hover:ring-primary/50 hover:ring-offset-2","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",u===x.url&&"ring-2 ring-primary ring-offset-2",i&&"opacity-50 cursor-not-allowed"),children:[e.jsxs(he,{className:"w-14 h-14 sm:w-16 sm:h-16",children:[e.jsx(fe,{src:x.url,alt:x.label}),e.jsx(je,{children:x.label[0]})]}),u===x.url&&e.jsx(B.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-5 h-5 bg-primary rounded-full flex items-center justify-center",children:e.jsx(Ie,{className:"w-3 h-3 text-primary-foreground"})})]},x.id))})]})})]}),e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Account Information"]}),e.jsx(X,{children:"Your account details and email address"})]}),e.jsx(E,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{className:"text-muted-foreground",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(Ve,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t?.email}),e.jsx(Ie,{className:"w-4 h-4 text-primary ml-auto"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the email associated with your account"})]}),s?.full_name&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{className:"text-muted-foreground",children:"Full Name"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(re,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can update your name in the Profile tab"})]})]})})]}),e.jsxs(A,{children:[e.jsxs(q,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(X,{children:"Update your password to keep your account secure"})]}),e.jsx(E,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{id:"new-password",type:"password",placeholder:"Enter new password",value:w,onChange:x=>g(x.target.value),className:"pl-10",minLength:6})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(oe,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{id:"confirm-password",type:"password",placeholder:"Confirm new password",value:S,onChange:x=>h(x.target.value),className:"pl-10",minLength:6})]})]}),f&&e.jsx("p",{className:"text-sm text-destructive",children:f}),e.jsx(_,{type:"submit",disabled:j||!w||!S,children:j?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})})]})]})},ea=({onJobRemoved:s})=>{const n=$e(),{user:t}=se(),[c,i]=l.useState([]),[d,u]=l.useState(!0),[p,j]=l.useState(null);l.useEffect(()=>{t&&N()},[t]);const N=async()=>{if(t)try{const{data:h,error:f}=await P.from("saved_jobs").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(f)throw f;i(h||[])}catch(h){console.error("Error fetching saved jobs:",h),y.error("Failed to load saved jobs")}finally{u(!1)}},w=async(h,f)=>{if(t){j(h);try{const{error:m}=await P.from("saved_jobs").delete().eq("id",h).eq("user_id",t.id);if(m)throw m;i(b=>b.filter(L=>L.id!==h)),y.success("Job removed from saved list"),s?.()}catch(m){console.error("Error removing saved job:",m),y.error("Failed to remove job")}finally{j(null)}}},g=h=>{sessionStorage.setItem("applyPositionId",h),n("/careers")},S=h=>ae.find(f=>f.id===h);return d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(F,{className:"w-8 h-8 animate-spin text-primary"})}):c.length===0?e.jsx(A,{children:e.jsxs(E,{className:"py-12 text-center",children:[e.jsx(Z,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Saved Jobs"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Save jobs you're interested in to review them later"}),e.jsx(_,{variant:"outline",onClick:()=>n("/applicant/dashboard"),children:"Browse Open Positions"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.length," saved job",c.length!==1?"s":""]})}),c.map((h,f)=>{const m=S(h.position_id);return e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:f*.05},children:e.jsx(A,{className:"overflow-hidden hover:shadow-md transition-shadow",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:m?.title||h.position_title}),e.jsxs(ee,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(Z,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),m&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3.5 h-3.5"}),m.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),m.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3.5 h-3.5"}),m.type]})]}),m&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:m.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Saved on ",new Date(h.created_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(_,{size:"sm",onClick:()=>g(h.position_id),children:["Apply Now",e.jsx(_e,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{size:"sm",variant:"ghost",onClick:()=>w(h.id,h.position_id),disabled:p===h.id,children:p===h.id?e.jsx(F,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]})})})},h.id)})]})},Va=()=>{const{user:s,isLoading:n,signOut:t}=se(),c=$e(),[i,d]=l.useState(null),[u,p]=l.useState(!0),[j,N]=l.useState("positions"),[w,g]=l.useState([]),[S,h]=l.useState(null);Hs(),l.useEffect(()=>{if(n)return;const a=sessionStorage.getItem("applicant_session_active");if(!s||!a){s&&!a?t().then(()=>{c("/applicant/login")}):c("/applicant/login");return}f(),m();const x=sessionStorage.getItem("applyPositionId");x&&(sessionStorage.removeItem("applyPositionId"),h(x),N("positions"))},[s,n,c,t]);const f=async()=>{if(!s){p(!1);return}p(!0);try{const{data:a,error:x}=await P.from("applicant_profiles").select("*").eq("user_id",s.id).maybeSingle();if(x)throw x;a&&d(a)}catch(a){console.error("Error fetching profile:",a),y.error("Failed to load profile")}finally{p(!1)}},m=async()=>{if(s)try{const{data:a,error:x}=await P.from("job_applications").select("position").eq("user_id",s.id);if(x)throw x;if(a){const C=a.map(U=>U.position);g(C)}}catch(a){console.error("Error fetching applied positions:",a)}},b=async()=>{ns(),await t(),c("/"),y.success("Signed out successfully")},L=a=>a?a.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"U";return n||u?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(F,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{title:"Dashboard | InfraWeave Careers",description:"Manage your profile, track your job applications, and explore new opportunities at InfraWeave."}),e.jsx(is,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-muted/50 to-background pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(he,{className:"w-16 h-16 border-4 border-background shadow-lg",children:[e.jsx(fe,{src:i?.avatar_url||void 0,alt:i?.full_name||"Profile"}),e.jsx(je,{className:"text-xl bg-primary/10 text-primary",children:L(i?.full_name)})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold",children:["Welcome",i?.full_name?`, ${i.full_name.split(" ")[0]}`:"","!"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Explore opportunities, manage your profile, and track your applications"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(_,{variant:"ghost",onClick:b,children:[e.jsx(rs,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]}),e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(ts,{value:j,onValueChange:N,className:"space-y-6",children:[e.jsxs(ls,{className:"grid w-full max-w-3xl grid-cols-5",children:[e.jsxs(ne,{value:"positions",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Open Positions"}),e.jsx("span",{className:"sm:hidden",children:"Jobs"})]}),e.jsxs(ne,{value:"saved",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved Jobs"}),e.jsx("span",{className:"sm:hidden",children:"Saved"})]}),e.jsxs(ne,{value:"applications",className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"My Applications"}),e.jsx("span",{className:"sm:hidden",children:"Applied"})]}),e.jsxs(ne,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Profile"]}),e.jsxs(ne,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4"}),"Account"]})]}),e.jsx(ie,{value:"positions",className:"space-y-6",children:e.jsx(Qs,{appliedPositions:w,pendingApplyPosition:S,onApplyComplete:()=>{h(null),m()}})}),e.jsx(ie,{value:"saved",className:"space-y-6",children:e.jsx(ea,{})}),e.jsx(ie,{value:"applications",className:"space-y-6",children:e.jsx(Ks,{userId:s?.id||""})}),e.jsx(ie,{value:"profile",className:"space-y-6",children:e.jsx(Ws,{profile:i,onProfileUpdate:f})}),e.jsx(ie,{value:"settings",className:"space-y-6",children:e.jsx(Zs,{profile:i,onProfileUpdate:f})})]})})]})}),e.jsx(os,{})]})};export{Va as default};
