import{j as e,f as ss,h as Se}from"./vendor-ui-CpQN7H5M.js";import{r as i,L as as,c as $e}from"./vendor-react-CQIth8Kl.js";import{B as _}from"./button-CpBzeEQ0.js";import{d as De,U as te,P as Le,L as ts,T as rs,a as ns,b as ne,c as le}from"./tabs-DQLFWbaN.js";import{P as Pe}from"./index-BNAWCwOb.js";import{c as Ae,a as ge,e as se,u as v,X as Ce,s as P}from"./main-BXfqrH9P.js";import{c as ls}from"./useSessionAuth-QlyJJc2o.js";import{A as _e,N as is,F as cs}from"./Footer-CdOyjzzR.js";import{S as os}from"./SEO-BPJxlSoJ.js";import{I as R}from"./input-BvpCOY1F.js";import{T as Me}from"./dialog-i4oc1fV3.js";import{e as L,i as z,j as O,k as Z,f as F,B as V,S as oe,a as de,b as me,c as ue,d as T,g as ee,C as ds,h as ms}from"./checkbox-DFLMVGql.js";import{F as xe}from"./file-text-CnmCZ1q0.js";import{C as Ne}from"./circle-check-big-DzpQYR6B.js";import{L as I}from"./loader-circle-Cl6Hqmbi.js";import{U as ke,u as us,t as xs,F as hs,a as K,b as G,c as q,d as Q,e as X,p as ae}from"./form-Cg9yGfDM.js";import{M as Ve}from"./mail-DX6x6hP_.js";import{P as ps}from"./phone-NE1PfpjX.js";import{L as fs}from"./linkedin-65FstijN.js";import{B as ye}from"./building-2-DSefXDJN.js";import{A as Fe}from"./award-EGZCDHJg.js";import{m as B,A as js}from"./vendor-motion-CyuYf4lN.js";import{C as gs}from"./calendar-B2obJQ3U.js";import{C as he}from"./clock-C97bwv_T.js";import{C as Ns}from"./circle-x-BF41J8-n.js";import{C as ys}from"./circle-alert-s8qjKluG.js";import{P as vs}from"./phone-input-KOCereJG.js";import{o as ws,s as M,l as bs}from"./types-BnTeS-Hg.js";import{S as Be}from"./search-BzTKENqz.js";import{M as Ye}from"./map-pin-D096jbWx.js";import{C as Ss}from"./chevron-down-BHFknFvi.js";import{L as ce}from"./label-9KhT8XQk.js";import{C as Ie}from"./check-D3tCyYQw.js";import{S as Cs}from"./shield-Gtdb_2LX.js";import{L as we}from"./lock-BSGn8-Zg.js";import{S as _s}from"./settings-B7I-Z-U_.js";import"./vendor-query-CbH48mXO.js";import"./index-BdQq_4o_.js";import"./popover-w-gTwDwW.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=Ae("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function Ps(s,l=[]){let r=[];function c(m,x){const u=i.createContext(x);u.displayName=m+"Context";const j=r.length;r=[...r,x];const N=g=>{var A;const{scope:y,children:p,...f}=g,d=((A=y==null?void 0:y[s])==null?void 0:A[j])||u,C=i.useMemo(()=>f,Object.values(f));return e.jsx(d.Provider,{value:C,children:p})};N.displayName=m+"Provider";function b(g,y){var d;const p=((d=y==null?void 0:y[s])==null?void 0:d[j])||u,f=i.useContext(p);if(f)return f;if(x!==void 0)return x;throw new Error(`\`${g}\` must be used within \`${m}\``)}return[N,b]}const n=()=>{const m=r.map(x=>i.createContext(x));return function(u){const j=(u==null?void 0:u[s])||m;return i.useMemo(()=>({[`__scope${s}`]:{...u,[s]:j}}),[u,j])}};return n.scopeName=s,[c,As(n,...l)]}function As(...s){const l=s[0];if(s.length===1)return l;const r=()=>{const c=s.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(m){const x=c.reduce((u,{useScope:j,scopeName:N})=>{const g=j(m)[`__scope${N}`];return{...u,...g}},{});return i.useMemo(()=>({[`__scope${l.scopeName}`]:x}),[x])}};return r.scopeName=l.scopeName,r}var qe={exports:{}},ze={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var re=i;function Es(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Ls=typeof Object.is=="function"?Object.is:Es,Fs=re.useState,Is=re.useEffect,Ts=re.useLayoutEffect,Rs=re.useDebugValue;function Us(s,l){var r=l(),c=Fs({inst:{value:r,getSnapshot:l}}),n=c[0].inst,m=c[1];return Ts(function(){n.value=r,n.getSnapshot=l,be(n)&&m({inst:n})},[s,r,l]),Is(function(){return be(n)&&m({inst:n}),s(function(){be(n)&&m({inst:n})})},[s]),Rs(r),r}function be(s){var l=s.getSnapshot;s=s.value;try{var r=l();return!Ls(s,r)}catch{return!0}}function $s(s,l){return l()}var Ds=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$s:Us;ze.useSyncExternalStore=re.useSyncExternalStore!==void 0?re.useSyncExternalStore:Ds;qe.exports=ze;var Ms=qe.exports;function Vs(){return Ms.useSyncExternalStore(Bs,()=>!0,()=>!1)}function Bs(){return()=>{}}var Ee="Avatar",[Ys]=Ps(Ee),[qs,Oe]=Ys(Ee),He=i.forwardRef((s,l)=>{const{__scopeAvatar:r,...c}=s,[n,m]=i.useState("idle");return e.jsx(qs,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:m,children:e.jsx(Pe.span,{...c,ref:l})})});He.displayName=Ee;var We="AvatarImage",Ke=i.forwardRef((s,l)=>{const{__scopeAvatar:r,src:c,onLoadingStatusChange:n=()=>{},...m}=s,x=Oe(We,r),u=zs(c,m),j=ss(N=>{n(N),x.onImageLoadingStatusChange(N)});return Se(()=>{u!=="idle"&&j(u)},[u,j]),u==="loaded"?e.jsx(Pe.img,{...m,ref:l,src:c}):null});Ke.displayName=We;var Ge="AvatarFallback",Qe=i.forwardRef((s,l)=>{const{__scopeAvatar:r,delayMs:c,...n}=s,m=Oe(Ge,r),[x,u]=i.useState(c===void 0);return i.useEffect(()=>{if(c!==void 0){const j=window.setTimeout(()=>u(!0),c);return()=>window.clearTimeout(j)}},[c]),x&&m.imageLoadingStatus!=="loaded"?e.jsx(Pe.span,{...n,ref:l}):null});Qe.displayName=Ge;function Re(s,l){return s?l?(s.src!==l&&(s.src=l),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function zs(s,{referrerPolicy:l,crossOrigin:r}){const c=Vs(),n=i.useRef(null),m=c?(n.current||(n.current=new window.Image),n.current):null,[x,u]=i.useState(()=>Re(m,s));return Se(()=>{u(Re(m,s))},[m,s]),Se(()=>{const j=g=>()=>{u(g)};if(!m)return;const N=j("loaded"),b=j("error");return m.addEventListener("load",N),m.addEventListener("error",b),l&&(m.referrerPolicy=l),typeof r=="string"&&(m.crossOrigin=r),()=>{m.removeEventListener("load",N),m.removeEventListener("error",b)}},[m,r,l]),x}var Xe=He,Ze=Ke,Je=Qe;const pe=i.forwardRef(({className:s,...l},r)=>e.jsx(Xe,{ref:r,className:ge("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...l}));pe.displayName=Xe.displayName;const fe=i.forwardRef(({className:s,...l},r)=>e.jsx(Ze,{ref:r,className:ge("aspect-square h-full w-full",s),...l}));fe.displayName=Ze.displayName;const je=i.forwardRef(({className:s,...l},r)=>e.jsx(Je,{ref:r,className:ge("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...l}));je.displayName=Je.displayName;const Os=5*60*1e3;function Hs(){const{user:s,signOut:l}=se(),r=i.useRef(null),c=i.useRef(Date.now()),n=i.useCallback(async()=>{s&&(await l(),v.info("You have been logged out due to inactivity"),sessionStorage.removeItem("applicant_session_active"),window.location.href="/careers")},[s,l]),m=i.useCallback(()=>{c.current=Date.now(),r.current&&clearTimeout(r.current),s&&(r.current=setTimeout(()=>{n()},Os))},[s,n]);return i.useEffect(()=>{if(!s)return;const x=["mousedown","mousemove","keydown","scroll","touchstart","click"],u=()=>{m()};return x.forEach(j=>{document.addEventListener(j,u,{passive:!0})}),m(),()=>{x.forEach(j=>{document.removeEventListener(j,u)}),r.current&&clearTimeout(r.current)}},[s,m]),{resetTimer:m}}const Ws=({profile:s,onProfileUpdate:l})=>{const{user:r}=se(),[c,n]=i.useState(!1),[m,x]=i.useState(!1),[u,j]=i.useState(!1),[N,b]=i.useState(!1),[g,y]=i.useState(""),[p,f]=i.useState(""),[d,C]=i.useState({full_name:(s==null?void 0:s.full_name)||"",phone:(s==null?void 0:s.phone)||"",linkedin_url:(s==null?void 0:s.linkedin_url)||"",current_company:(s==null?void 0:s.current_company)||"",experience_years:(s==null?void 0:s.experience_years)||0,bio:(s==null?void 0:s.bio)||"",skills:(s==null?void 0:s.skills)||[],certifications:(s==null?void 0:s.certifications)||[]}),A=async()=>{if(r){x(!0);try{const{error:o}=await P.from("applicant_profiles").update({full_name:d.full_name||null,phone:d.phone||null,linkedin_url:d.linkedin_url||null,current_company:d.current_company||null,experience_years:d.experience_years,bio:d.bio||null,skills:d.skills,certifications:d.certifications}).eq("user_id",r.id);if(o)throw o;v.success("Profile updated successfully!"),n(!1),l()}catch(o){console.error("Error updating profile:",o),v.error(o.message||"Failed to update profile")}finally{x(!1)}}},a=async o=>{var ie;const w=(ie=o.target.files)==null?void 0:ie[0];if(!w||!r)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(w.type)){v.error("Please upload a PDF or Word document");return}if(w.size>10*1024*1024){v.error("File size must be less than 10MB");return}j(!0);try{const Y=w.name.split(".").pop(),W=`profile-${r.id}-${Date.now()}.${Y}`;s!=null&&s.resume_url&&await P.storage.from("resumes").remove([s.resume_url]);const{error:t}=await P.storage.from("resumes").upload(W,w,{upsert:!0});if(t)throw t;const{error:E}=await P.from("applicant_profiles").update({resume_url:W}).eq("user_id",r.id);if(E)throw E;v.success("Resume uploaded successfully!"),l()}catch(Y){console.error("Error uploading resume:",Y),v.error("Failed to upload resume")}finally{j(!1)}},h=async()=>{if(!(!r||!(s!=null&&s.resume_url))){b(!0);try{await P.storage.from("resumes").remove([s.resume_url]);const{error:o}=await P.from("applicant_profiles").update({resume_url:null}).eq("user_id",r.id);if(o)throw o;v.success("Resume removed"),l()}catch(o){console.error("Error deleting resume:",o),v.error("Failed to remove resume")}finally{b(!1)}}},S=()=>{g.trim()&&!d.skills.includes(g.trim())&&(C(o=>({...o,skills:[...o.skills,g.trim()]})),y(""))},U=o=>{C(w=>({...w,skills:w.skills.filter(H=>H!==o)}))},$=()=>{p.trim()&&!d.certifications.includes(p.trim())&&(C(o=>({...o,certifications:[...o.certifications,p.trim()]})),f(""))},ve=o=>{C(w=>({...w,certifications:w.certifications.filter(H=>H!==o)}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5"}),"Resume"]}),e.jsx(Z,{children:"Upload your resume to auto-fill job applications"})]}),e.jsx(F,{children:s!=null&&s.resume_url?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:["Resume uploaded",e.jsx(Ne,{className:"w-4 h-4 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This will be used when you apply for jobs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",id:"resume-replace",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:u}),e.jsx("label",{htmlFor:"resume-replace",children:e.jsx(_,{variant:"outline",size:"sm",disabled:u,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:u?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Replace"]})})})}),e.jsx(_,{variant:"ghost",size:"sm",onClick:h,disabled:N,children:N?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[e.jsx(Te,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"font-medium mb-1",children:"No resume uploaded"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload your resume to speed up job applications"}),e.jsx("input",{type:"file",id:"resume-upload",accept:".pdf,.doc,.docx",className:"hidden",onChange:a,disabled:u}),e.jsx("label",{htmlFor:"resume-upload",children:e.jsx(_,{disabled:u,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:u?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Upload Resume"]})})})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"PDF or Word document, max 10MB"})]})})]}),e.jsxs(L,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Profile Information"]}),e.jsx(Z,{children:"Keep your profile updated to get noticed by recruiters"})]}),c?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(_,{onClick:A,disabled:m,children:[m?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Save"]})]}):e.jsx(_,{onClick:()=>n(!0),children:"Edit Profile"})]}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"})," Full Name"]}),c?e.jsx(R,{value:d.full_name,onChange:o=>C(w=>({...w,full_name:o.target.value})),placeholder:"Your full name"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.full_name)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"})," Email"]}),e.jsx("p",{className:"text-foreground",children:s==null?void 0:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ps,{className:"w-4 h-4"})," Phone"]}),c?e.jsx(R,{value:d.phone,onChange:o=>C(w=>({...w,phone:o.target.value})),placeholder:"Your phone number"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.phone)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(fs,{className:"w-4 h-4"})," LinkedIn"]}),c?e.jsx(R,{value:d.linkedin_url,onChange:o=>C(w=>({...w,linkedin_url:o.target.value})),placeholder:"https://linkedin.com/in/yourprofile"}):e.jsx("p",{className:"text-foreground",children:s!=null&&s.linkedin_url?e.jsx("a",{href:s.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"View Profile"}):"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"})," Current Company"]}),c?e.jsx(R,{value:d.current_company,onChange:o=>C(w=>({...w,current_company:o.target.value})),placeholder:"Your current company"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.current_company)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"})," Experience"]}),c?e.jsxs(oe,{value:d.experience_years.toString(),onValueChange:o=>C(w=>({...w,experience_years:parseInt(o)})),children:[e.jsx(de,{children:e.jsx(me,{})}),e.jsx(ue,{children:[0,1,2,3,4,5,6,7,8,9,10,15,20].map(o=>e.jsx(T,{value:o.toString(),children:o===0?"Fresh Graduate":`${o}+ years`},o))})]}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.experience_years)===0?"Fresh Graduate":`${s==null?void 0:s.experience_years}+ years`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"})," Bio"]}),c?e.jsx(Me,{value:d.bio,onChange:o=>C(w=>({...w,bio:o.target.value})),placeholder:"Tell us about yourself, your career goals, and what you're looking for...",rows:4}):e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:(s==null?void 0:s.bio)||"No bio provided"})]})]})]}),e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Skills"]}),e.jsx(Z,{children:"Add your technical and soft skills"})]}),e.jsxs(F,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[d.skills.map(o=>e.jsxs(ee,{variant:"secondary",className:"text-sm py-1 px-3",children:[o,c&&e.jsx("button",{onClick:()=>U(o),className:"ml-2",children:e.jsx(Ce,{className:"w-3 h-3"})})]},o)),d.skills.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No skills added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:g,onChange:o=>y(o.target.value),placeholder:"Add a skill (e.g., Python, Kubernetes)",onKeyPress:o=>o.key==="Enter"&&(o.preventDefault(),S())}),e.jsx(_,{type:"button",onClick:S,variant:"outline",children:e.jsx(Le,{className:"w-4 h-4"})})]})]})]}),e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Certifications"]}),e.jsx(Z,{children:"List your professional certifications"})]}),e.jsxs(F,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[d.certifications.map(o=>e.jsxs(ee,{variant:"outline",className:"text-sm py-1 px-3",children:[o,c&&e.jsx("button",{onClick:()=>ve(o),className:"ml-2",children:e.jsx(Ce,{className:"w-3 h-3"})})]},o)),d.certifications.length===0&&!c&&e.jsx("p",{className:"text-muted-foreground",children:"No certifications added yet"})]}),c&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:p,onChange:o=>f(o.target.value),placeholder:"Add a certification (e.g., AWS Solutions Architect)",onKeyPress:o=>o.key==="Enter"&&(o.preventDefault(),$())}),e.jsx(_,{type:"button",onClick:$,variant:"outline",children:e.jsx(Le,{className:"w-4 h-4"})})]})]})]})]})},Ue=s=>{switch(s.toLowerCase()){case"pending":return{icon:he,color:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",label:"Under Review"};case"reviewed":return{icon:ys,color:"bg-blue-500/10 text-blue-600 border-blue-500/30",label:"Reviewed"};case"interviewed":return{icon:V,color:"bg-purple-500/10 text-purple-600 border-purple-500/30",label:"Interview Stage"};case"hired":return{icon:Ne,color:"bg-green-500/10 text-green-600 border-green-500/30",label:"Hired!"};case"rejected":return{icon:Ns,color:"bg-red-500/10 text-red-600 border-red-500/30",label:"Not Selected"};default:return{icon:he,color:"bg-muted text-muted-foreground",label:s}}},Ks=({userId:s})=>{const[l,r]=i.useState([]),[c,n]=i.useState(!0);i.useEffect(()=>{m()},[s]);const m=async()=>{if(s)try{const{data:x,error:u}=await P.from("job_applications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(u)throw u;r(x||[])}catch(x){console.error("Error fetching applications:",x),v.error("Failed to load applications")}finally{n(!1)}};return c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):l.length===0?e.jsx(L,{children:e.jsxs(F,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-16 h-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Applications Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't applied to any positions yet. Browse our open positions and start your journey!"}),e.jsx(as,{to:"/careers",children:e.jsxs(_,{children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Browse Open Positions"]})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold",children:["Your Applications (",l.length,")"]})}),e.jsx("div",{className:"grid gap-4",children:l.map((x,u)=>{const j=Ue(x.status),N=j.icon;return e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},children:e.jsx(L,{className:"hover:shadow-md transition-shadow",children:e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(V,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:x.position}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(gs,{className:"w-4 h-4"}),"Applied ",new Date(x.created_at).toLocaleDateString()]}),x.current_company&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-4 h-4"}),x.current_company]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(ee,{variant:"outline",className:j.color,children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),j.label]})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:["pending","reviewed","interviewed","hired"].map((b,g)=>{const y=Ue(b),p=y.icon,f=["pending","reviewed","interviewed","hired"].indexOf(x.status.toLowerCase()),d=g<=f&&x.status.toLowerCase()!=="rejected",C=g===f;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${d?C?y.color:"bg-green-500/10 text-green-600":"bg-muted text-muted-foreground"}`,children:[e.jsx(p,{className:"w-3 h-3"}),y.label]}),g<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${g<f&&x.status.toLowerCase()!=="rejected"?"bg-green-500":"bg-muted"}`})]},b)})})})]})})},x.id)})})]})},Gs=ws({fullName:M().min(2,"Name must be at least 2 characters").max(100,"Name is too long"),email:M().email("Please enter a valid email"),phone:M().min(10,"Please enter a valid phone number"),position:M().min(1,"Please select a position"),positionId:M().min(1,"Position ID is required"),experienceYears:M().min(1,"Please select your experience"),currentCompany:M().optional(),linkedinUrl:M().url("Please enter a valid URL").optional().or(bs("")),coverLetter:M().max(2e3,"Cover letter is too long").optional()}),Qs=({position:s,onClose:l,onSuccess:r})=>{const{user:c}=se(),[n,m]=i.useState(null),[x,u]=i.useState(null),[j,N]=i.useState(!1),[b,g]=i.useState(!1),[y,p]=i.useState(!0),f=us({resolver:xs(Gs),defaultValues:{fullName:"",email:(c==null?void 0:c.email)||"",phone:"",position:s.title,positionId:s.id,experienceYears:"",currentCompany:"",linkedinUrl:"",coverLetter:""}});i.useEffect(()=>{c&&d()},[c]);const d=async()=>{if(c){p(!0);try{const{data:a,error:h}=await P.from("applicant_profiles").select("*").eq("user_id",c.id).maybeSingle();if(h)throw h;a&&(a.full_name&&f.setValue("fullName",a.full_name),a.phone&&f.setValue("phone",a.phone),a.linkedin_url&&f.setValue("linkedinUrl",a.linkedin_url),a.current_company&&f.setValue("currentCompany",a.current_company),a.experience_years!==null&&a.experience_years!==void 0&&f.setValue("experienceYears",a.experience_years.toString()),a.resume_url&&(u(a.resume_url),N(!0)))}catch(a){console.error("Error fetching profile:",a)}finally{p(!1)}}},C=a=>{var S;const h=(S=a.target.files)==null?void 0:S[0];if(h){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(h.type)){v.error("Please upload a PDF or Word document");return}if(h.size>10*1024*1024){v.error("File size must be less than 10MB");return}m(h),N(!1)}},A=async a=>{if(!n&&!j){v.error("Please upload your resume");return}g(!0);try{let h;if(j&&x){const U=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}-profile`,{error:$}=await P.storage.from("resumes").copy(x,U);h=$?x:U}else if(n){const U=n.name.split(".").pop();h=`${a.positionId}-${Date.now()}-${a.fullName.replace(/\s+/g,"-").toLowerCase()}.${U}`;const{error:$}=await P.storage.from("resumes").upload(h,n);if($)throw $}else{v.error("Please upload your resume"),g(!1);return}const{error:S}=await P.from("job_applications").insert({full_name:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experience_years:parseInt(a.experienceYears),current_company:a.currentCompany||null,linkedin_url:a.linkedinUrl||null,cover_letter:a.coverLetter||null,resume_url:h,user_id:c==null?void 0:c.id});if(S)throw S;await P.functions.invoke("send-notification",{body:{type:"job_application",data:{fullName:a.fullName,email:a.email,phone:a.phone,position:`${a.position} (${a.positionId})`,experienceYears:a.experienceYears,currentCompany:a.currentCompany,linkedinUrl:a.linkedinUrl}}}),v.success("Application submitted successfully!"),r()}catch(h){console.error("Error submitting application:",h),v.error("Failed to submit application. Please try again.")}finally{g(!1)}};return y?e.jsx(L,{children:e.jsx(F,{className:"py-12 flex items-center justify-center",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(L,{children:[e.jsxs(z,{className:"flex flex-row items-center justify-between",children:[e.jsxs(O,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5 text-primary"})}),"Apply for ",s.title]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:l,children:e.jsx(Ce,{className:"w-5 h-5"})})]}),e.jsx(F,{children:e.jsx(hs,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(A),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"fullName",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Full Name *"}),e.jsx(Q,{children:e.jsx(R,{placeholder:"Your full name",...a})}),e.jsx(X,{})]})}),e.jsx(K,{control:f.control,name:"email",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Email *"}),e.jsx(Q,{children:e.jsx(R,{type:"email",placeholder:"you@example.com",...a,disabled:!0})}),e.jsx(X,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"phone",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Phone Number *"}),e.jsx(Q,{children:e.jsx(vs,{value:a.value,onChange:a.onChange,defaultCountry:"NP"})}),e.jsx(X,{})]})}),e.jsx(K,{control:f.control,name:"experienceYears",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Years of Experience *"}),e.jsxs(oe,{onValueChange:a.onChange,value:a.value,children:[e.jsx(Q,{children:e.jsx(de,{children:e.jsx(me,{placeholder:"Select experience"})})}),e.jsxs(ue,{children:[e.jsx(T,{value:"0",children:"Fresher (0 years)"}),e.jsx(T,{value:"1",children:"1 year"}),e.jsx(T,{value:"2",children:"2 years"}),e.jsx(T,{value:"3",children:"3 years"}),e.jsx(T,{value:"4",children:"4 years"}),e.jsx(T,{value:"5",children:"5+ years"}),e.jsx(T,{value:"7",children:"7+ years"}),e.jsx(T,{value:"10",children:"10+ years"})]})]}),e.jsx(X,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(K,{control:f.control,name:"currentCompany",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Current Company"}),e.jsx(Q,{children:e.jsx(R,{placeholder:"Your current employer",...a})}),e.jsx(X,{})]})}),e.jsx(K,{control:f.control,name:"linkedinUrl",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"LinkedIn Profile"}),e.jsx(Q,{children:e.jsx(R,{placeholder:"https://linkedin.com/in/yourprofile",...a})}),e.jsx(X,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(q,{children:"Resume *"}),x&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[e.jsx(ds,{id:"useProfileResume",checked:j,onCheckedChange:a=>{N(a),a&&m(null)}}),e.jsxs("label",{htmlFor:"useProfileResume",className:"text-sm flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(xe,{className:"w-4 h-4 text-primary"}),"Use resume from my profile"]}),j&&e.jsx(Ne,{className:"w-4 h-4 text-primary"})]}),!j&&e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:C,className:"hidden",id:"resume-upload"}),e.jsxs("label",{htmlFor:"resume-upload",className:"cursor-pointer",children:[e.jsx(ke,{className:"w-10 h-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n?e.jsx("span",{className:"text-primary font-medium",children:n.name}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary font-medium",children:"Click to upload"})," or drag and drop"]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF or Word (max 10MB)"})]})]})]}),e.jsx(K,{control:f.control,name:"coverLetter",render:({field:a})=>e.jsxs(G,{children:[e.jsx(q,{children:"Cover Letter (Optional)"}),e.jsx(Q,{children:e.jsx(Me,{placeholder:"Tell us why you're interested in this role and what makes you a great fit...",className:"min-h-[120px]",...a})}),e.jsx(X,{})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t",children:[e.jsx(_,{type:"button",variant:"outline",onClick:l,children:"Cancel"}),e.jsx(_,{type:"submit",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})})})]})})},Xs=({appliedPositions:s=[],onSavedJobsChange:l,pendingApplyPosition:r,onApplyComplete:c})=>{const{user:n}=se(),[m,x]=i.useState(""),[u,j]=i.useState("all"),[N,b]=i.useState("all"),[g,y]=i.useState(null),[p,f]=i.useState([]),[d,C]=i.useState(null),[A,a]=i.useState(null),[h,S]=i.useState(s),U=[...new Set(ae.map(t=>t.department))],$=[...new Set(ae.map(t=>t.type))];i.useEffect(()=>{S(s)},[s]),i.useEffect(()=>{n&&ve()},[n]),i.useEffect(()=>{if(r){const t=ae.find(E=>E.id===r);t&&(a(t),y(r)),setTimeout(()=>{const E=document.getElementById(`position-${r}`);E&&E.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[r]);const ve=async()=>{if(n)try{const{data:t,error:E}=await P.from("saved_jobs").select("position_id").eq("user_id",n.id);if(E)throw E;f((t==null?void 0:t.map(k=>k.position_id))||[])}catch(t){console.error("Error fetching saved jobs:",t)}},o=async(t,E)=>{if(E.stopPropagation(),!n){v.info("Please sign in to save jobs");return}C(t.id);try{if(p.includes(t.id)){const{error:k}=await P.from("saved_jobs").delete().eq("user_id",n.id).eq("position_id",t.id);if(k)throw k;f(D=>D.filter(es=>es!==t.id)),v.success("Job removed from saved list")}else{const{error:k}=await P.from("saved_jobs").insert({user_id:n.id,position_id:t.id,position_title:t.title});if(k)throw k;f(D=>[...D,t.id]),v.success("Job saved for later")}l==null||l()}catch(k){console.error("Error toggling saved job:",k),v.error("Failed to update saved jobs")}finally{C(null)}},w=ae.filter(t=>{const E=t.title.toLowerCase().includes(m.toLowerCase())||t.description.toLowerCase().includes(m.toLowerCase())||t.department.toLowerCase().includes(m.toLowerCase()),k=u==="all"||t.department===u,D=N==="all"||t.type===N;return E&&k&&D}),H=t=>{a(t),y(t.id)},ie=()=>{A&&S(t=>[...t,A.id]),a(null),c==null||c()},Y=t=>h.includes(t),W=t=>p.includes(t);return e.jsxs("div",{className:"space-y-6",children:[A&&e.jsx(Qs,{position:A,onClose:()=>a(null),onSuccess:ie}),e.jsx(L,{children:e.jsx(F,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{placeholder:"Search positions...",value:m,onChange:t=>x(t.target.value),className:"pl-10"})]}),e.jsxs(oe,{value:u,onValueChange:j,children:[e.jsx(de,{className:"w-full md:w-[180px]",children:e.jsx(me,{placeholder:"Department"})}),e.jsxs(ue,{children:[e.jsx(T,{value:"all",children:"All Departments"}),U.map(t=>e.jsx(T,{value:t,children:t},t))]})]}),e.jsxs(oe,{value:N,onValueChange:b,children:[e.jsx(de,{className:"w-full md:w-[150px]",children:e.jsx(me,{placeholder:"Type"})}),e.jsxs(ue,{children:[e.jsx(T,{value:"all",children:"All Types"}),$.map(t=>e.jsx(T,{value:t,children:t},t))]})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",w.length," of ",ae.length," positions"]}),p.length>0&&e.jsxs(ee,{variant:"secondary",children:[e.jsx(J,{className:"w-3 h-3 mr-1 fill-current"}),p.length," saved"]})]}),e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsx(L,{children:e.jsxs(F,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No positions found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})}):w.map((t,E)=>e.jsx(B.div,{id:`position-${t.id}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},children:e.jsx(L,{className:`overflow-hidden hover:shadow-md transition-shadow ${r===t.id?"ring-2 ring-primary":""}`,children:e.jsxs(F,{className:"p-0",children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>y(g===t.id?null:t.id),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),Y(t.id)&&e.jsxs(ee,{variant:"secondary",className:"bg-primary/10 text-primary",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),"Applied"]}),W(t.id)&&!Y(t.id)&&e.jsxs(ee,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(J,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3.5 h-3.5"}),t.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),t.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),t.type]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:t.description})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(_,{size:"icon",variant:"ghost",onClick:k=>o(t,k),disabled:d===t.id,className:"shrink-0",children:d===t.id?e.jsx(I,{className:"w-5 h-5 animate-spin"}):e.jsx(J,{className:`w-5 h-5 ${W(t.id)?"fill-primary text-primary":"text-muted-foreground"}`})}),!Y(t.id)&&e.jsxs(_,{size:"sm",onClick:k=>{k.stopPropagation(),H(t)},children:["Apply Now",e.jsx(_e,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{variant:"ghost",size:"icon",children:g===t.id?e.jsx(ms,{className:"w-5 h-5"}):e.jsx(Ss,{className:"w-5 h-5"})})]})]})}),e.jsx(js,{children:g===t.id&&!A&&e.jsx(B.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 border-t pt-4 bg-muted/30",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Responsibilities"]}),e.jsx("ul",{className:"space-y-2",children:t.responsibilities.map((k,D)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:k})]},D))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Requirements"]}),e.jsx("ul",{className:"space-y-2",children:t.requirements.map((k,D)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:"•"}),e.jsx("span",{children:k})]},D))})]})]}),!Y(t.id)&&e.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-2",children:[e.jsxs(_,{variant:"outline",onClick:k=>o(t,k),disabled:d===t.id,children:[d===t.id?e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(J,{className:`w-4 h-4 mr-2 ${W(t.id)?"fill-current":""}`}),W(t.id)?"Saved":"Save for Later"]}),e.jsxs(_,{onClick:()=>H(t),children:["Apply for this Position",e.jsx(_e,{className:"w-4 h-4 ml-2"})]})]})]})})})]})})},t.id))})]})},Zs=[{id:"male-1",url:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-2",url:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-3",url:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-4",url:"https://images.unsplash.com/photo-1463453091185-61582044d556?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-5",url:"https://images.unsplash.com/photo-1560250097-0b93528c311a?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"male-6",url:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",label:"Male"},{id:"female-1",url:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-2",url:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-3",url:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-4",url:"https://images.unsplash.com/photo-1580489944761-15a19d654956?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-5",url:"https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?w=150&h=150&fit=crop&crop=face",label:"Female"},{id:"female-6",url:"https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=150&h=150&fit=crop&crop=face",label:"Female"}],Js=({profile:s,onProfileUpdate:l})=>{const{user:r,updatePassword:c}=se(),[n,m]=i.useState(!1),[x,u]=i.useState((s==null?void 0:s.avatar_url)||null),[j,N]=i.useState(!1),[b,g]=i.useState(""),[y,p]=i.useState(""),[f,d]=i.useState(""),C=h=>h?h.split(" ").map(S=>S[0]).join("").toUpperCase().slice(0,2):"U",A=async h=>{if(r){m(!0),u(h);try{const{error:S}=await P.from("applicant_profiles").update({avatar_url:h}).eq("user_id",r.id);if(S)throw S;v.success("Avatar updated!"),l()}catch(S){console.error("Error updating avatar:",S),v.error("Failed to update avatar"),u((s==null?void 0:s.avatar_url)||null)}finally{m(!1)}}},a=async h=>{if(h.preventDefault(),d(""),b.length<6){d("Password must be at least 6 characters");return}if(b!==y){d("Passwords do not match");return}N(!0);try{const{error:S}=await c(b);if(S)throw S;v.success("Password updated successfully!"),g(""),p("")}catch(S){console.error("Error changing password:",S),d(S.message||"Failed to update password")}finally{N(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Choose Avatar"]}),e.jsx(Z,{children:"Select an avatar to personalize your profile"})]}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(pe,{className:"w-20 h-20 border-4 border-background shadow-lg",children:[e.jsx(fe,{src:x||void 0,alt:(s==null?void 0:s.full_name)||"Profile"}),e.jsx(je,{className:"text-2xl bg-primary/10 text-primary",children:C(s==null?void 0:s.full_name)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(s==null?void 0:s.full_name)||"Your Avatar"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click an avatar below to change"})]}),n&&e.jsx(I,{className:"w-5 h-5 animate-spin text-primary ml-auto"})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3 pt-4",children:Zs.map(h=>e.jsxs(B.button,{type:"button",onClick:()=>A(h.url),disabled:n,whileHover:{scale:1.05},whileTap:{scale:.95},className:ge("relative p-1 rounded-full transition-all duration-200","hover:ring-2 hover:ring-primary/50 hover:ring-offset-2","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",x===h.url&&"ring-2 ring-primary ring-offset-2",n&&"opacity-50 cursor-not-allowed"),children:[e.jsxs(pe,{className:"w-14 h-14 sm:w-16 sm:h-16",children:[e.jsx(fe,{src:h.url,alt:h.label}),e.jsx(je,{children:h.label[0]})]}),x===h.url&&e.jsx(B.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-5 h-5 bg-primary rounded-full flex items-center justify-center",children:e.jsx(Ie,{className:"w-3 h-3 text-primary-foreground"})})]},h.id))})]})})]}),e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Account Information"]}),e.jsx(Z,{children:"Your account details and email address"})]}),e.jsx(F,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{className:"text-muted-foreground",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(Ve,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:r==null?void 0:r.email}),e.jsx(Ie,{className:"w-4 h-4 text-primary ml-auto"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the email associated with your account"})]}),(s==null?void 0:s.full_name)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{className:"text-muted-foreground",children:"Full Name"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(te,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can update your name in the Profile tab"})]})]})})]}),e.jsxs(L,{children:[e.jsxs(z,{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(Z,{children:"Update your password to keep your account secure"})]}),e.jsx(F,{children:e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{id:"new-password",type:"password",placeholder:"Enter new password",value:b,onChange:h=>g(h.target.value),className:"pl-10",minLength:6})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(we,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(R,{id:"confirm-password",type:"password",placeholder:"Confirm new password",value:y,onChange:h=>p(h.target.value),className:"pl-10",minLength:6})]})]}),f&&e.jsx("p",{className:"text-sm text-destructive",children:f}),e.jsx(_,{type:"submit",disabled:j||!b||!y,children:j?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})})]})]})},ea=({onJobRemoved:s})=>{const l=$e(),{user:r}=se(),[c,n]=i.useState([]),[m,x]=i.useState(!0),[u,j]=i.useState(null);i.useEffect(()=>{r&&N()},[r]);const N=async()=>{if(r)try{const{data:p,error:f}=await P.from("saved_jobs").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});if(f)throw f;n(p||[])}catch(p){console.error("Error fetching saved jobs:",p),v.error("Failed to load saved jobs")}finally{x(!1)}},b=async(p,f)=>{if(r){j(p);try{const{error:d}=await P.from("saved_jobs").delete().eq("id",p).eq("user_id",r.id);if(d)throw d;n(C=>C.filter(A=>A.id!==p)),v.success("Job removed from saved list"),s==null||s()}catch(d){console.error("Error removing saved job:",d),v.error("Failed to remove job")}finally{j(null)}}},g=p=>{sessionStorage.setItem("applyPositionId",p),l("/careers")},y=p=>ae.find(f=>f.id===p);return m?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):c.length===0?e.jsx(L,{children:e.jsxs(F,{className:"py-12 text-center",children:[e.jsx(J,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Saved Jobs"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Save jobs you're interested in to review them later"}),e.jsx(_,{variant:"outline",onClick:()=>l("/applicant/dashboard"),children:"Browse Open Positions"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c.length," saved job",c.length!==1?"s":""]})}),c.map((p,f)=>{const d=y(p.position_id);return e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:f*.05},children:e.jsx(L,{className:"overflow-hidden hover:shadow-md transition-shadow",children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:(d==null?void 0:d.title)||p.position_title}),e.jsxs(ee,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(J,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),d&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-3.5 h-3.5"}),d.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),d.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),d.type]})]}),d&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:d.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Saved on ",new Date(p.created_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(_,{size:"sm",onClick:()=>g(p.position_id),children:["Apply Now",e.jsx(_e,{className:"w-4 h-4 ml-1"})]}),e.jsx(_,{size:"sm",variant:"ghost",onClick:()=>b(p.id,p.position_id),disabled:u===p.id,children:u===p.id?e.jsx(I,{className:"w-4 h-4 animate-spin"}):e.jsx(De,{className:"w-4 h-4 text-muted-foreground"})})]})]})})})},p.id)})]})},Va=()=>{const{user:s,isLoading:l,signOut:r}=se(),c=$e(),[n,m]=i.useState(null),[x,u]=i.useState(!0),[j,N]=i.useState("positions"),[b,g]=i.useState([]),[y,p]=i.useState(null);Hs(),i.useEffect(()=>{if(l)return;const a=sessionStorage.getItem("applicant_session_active");if(!s||!a){s&&!a?r().then(()=>{c("/applicant/login")}):c("/applicant/login");return}f(),d();const h=sessionStorage.getItem("applyPositionId");h&&(sessionStorage.removeItem("applyPositionId"),p(h),N("positions"))},[s,l,c,r]);const f=async()=>{if(!s){u(!1);return}u(!0);try{const{data:a,error:h}=await P.from("applicant_profiles").select("*").eq("user_id",s.id).maybeSingle();if(h)throw h;a&&m(a)}catch(a){console.error("Error fetching profile:",a),v.error("Failed to load profile")}finally{u(!1)}},d=async()=>{if(s)try{const{data:a,error:h}=await P.from("job_applications").select("position").eq("user_id",s.id);if(h)throw h;if(a){const S=a.map(U=>U.position);g(S)}}catch(a){console.error("Error fetching applied positions:",a)}},C=async()=>{ls(),await r(),c("/"),v.success("Signed out successfully")},A=a=>a?a.split(" ").map(h=>h[0]).join("").toUpperCase().slice(0,2):"U";return l||x?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(I,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(os,{title:"Dashboard | InfraWeave Careers",description:"Manage your profile, track your job applications, and explore new opportunities at InfraWeave."}),e.jsx(is,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-muted/50 to-background pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(pe,{className:"w-16 h-16 border-4 border-background shadow-lg",children:[e.jsx(fe,{src:(n==null?void 0:n.avatar_url)||void 0,alt:(n==null?void 0:n.full_name)||"Profile"}),e.jsx(je,{className:"text-xl bg-primary/10 text-primary",children:A(n==null?void 0:n.full_name)})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold",children:["Welcome",n!=null&&n.full_name?`, ${n.full_name.split(" ")[0]}`:"","!"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Explore opportunities, manage your profile, and track your applications"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(_,{variant:"ghost",onClick:C,children:[e.jsx(ts,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]}),e.jsx(B.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(rs,{value:j,onValueChange:N,className:"space-y-6",children:[e.jsxs(ns,{className:"grid w-full max-w-3xl grid-cols-5",children:[e.jsxs(ne,{value:"positions",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Open Positions"}),e.jsx("span",{className:"sm:hidden",children:"Jobs"})]}),e.jsxs(ne,{value:"saved",className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved Jobs"}),e.jsx("span",{className:"sm:hidden",children:"Saved"})]}),e.jsxs(ne,{value:"applications",className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"My Applications"}),e.jsx("span",{className:"sm:hidden",children:"Applied"})]}),e.jsxs(ne,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Profile"]}),e.jsxs(ne,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(_s,{className:"w-4 h-4"}),"Account"]})]}),e.jsx(le,{value:"positions",className:"space-y-6",children:e.jsx(Xs,{appliedPositions:b,pendingApplyPosition:y,onApplyComplete:()=>{p(null),d()}})}),e.jsx(le,{value:"saved",className:"space-y-6",children:e.jsx(ea,{})}),e.jsx(le,{value:"applications",className:"space-y-6",children:e.jsx(Ks,{userId:(s==null?void 0:s.id)||""})}),e.jsx(le,{value:"profile",className:"space-y-6",children:e.jsx(Ws,{profile:n,onProfileUpdate:f})}),e.jsx(le,{value:"settings",className:"space-y-6",children:e.jsx(Js,{profile:n,onProfileUpdate:f})})]})})]})}),e.jsx(cs,{})]})};export{Va as default};
