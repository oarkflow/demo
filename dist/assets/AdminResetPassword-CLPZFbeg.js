import{j as e}from"./vendor-ui--gC2EbFs.js";import{c as B,r}from"./vendor-react-BKlpBF4k.js";import{c as U,e as q,u as t,H as h}from"./main-C8RJKniu.js";import{B as T}from"./button-BKrOXQPg.js";import{I as f}from"./input--giQvbck.js";import{L as w}from"./label-8Sssz5gS.js";import{S as j}from"./SubtleBackground-C6X9jvtX.js";import{L as b}from"./loader-circle-nLflx1mG.js";import{m as g}from"./vendor-motion-DpAY1mMN.js";import{C as H}from"./circle-check-big-ClTpMWNI.js";import{L as y}from"./lock-D0f5Vosg.js";import{E as N}from"./eye-off-BmkxskL1.js";import{E as v}from"./eye-mL9LlOoe.js";import{o as K,s as P}from"./types-KBJzO2d1.js";import"./vendor-query-CpApZjIr.js";import"./index-spmI-ziT.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=U("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),W=K({password:P().min(6,"Password must be at least 6 characters"),confirmPassword:P().min(6,"Password must be at least 6 characters")}).refine(s=>s.password===s.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),ae=()=>{const s=B(),{updatePassword:k,session:m,isLoading:n}=q(),[i,C]=r.useState(""),[u,E]=r.useState(""),[d,I]=r.useState(!1),[c,L]=r.useState(!1),[o,x]=r.useState(!1),[R,F]=r.useState(!1);r.useEffect(()=>{!n&&!m&&(t.error("Invalid or expired reset link. Please request a new one."),s("/admin/login"))},[m,n,s]);const A=async a=>{a.preventDefault();const p=W.safeParse({password:i,confirmPassword:u});if(!p.success){t.error(p.error.errors[0].message);return}x(!0);try{const{error:l}=await k(i);l?t.error(l.message):(F(!0),t.success("Password updated successfully!"),setTimeout(()=>{s("/admin")},2e3))}catch{t.error("An unexpected error occurred")}finally{x(!1)}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(b,{className:"w-8 h-8 animate-spin text-primary"})}):R?e.jsxs(e.Fragment,{children:[e.jsxs(h,{children:[e.jsx("title",{children:"Password Updated | InfraWeave"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(j,{}),e.jsx(g.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Password Updated!"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirecting you to the admin panel..."})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(h,{children:[e.jsx("title",{children:"Reset Password | InfraWeave"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(j,{}),e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(S,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground",children:"Set New Password"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(f,{id:"password",type:d?"text":"password",placeholder:"••••••••",value:i,onChange:a=>C(a.target.value),className:"pl-10 pr-10 bg-background/50",disabled:o,required:!0}),e.jsx("button",{type:"button",onClick:()=>I(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:d?e.jsx(N,{className:"w-4 h-4"}):e.jsx(v,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(f,{id:"confirmPassword",type:c?"text":"password",placeholder:"••••••••",value:u,onChange:a=>E(a.target.value),className:"pl-10 pr-10 bg-background/50",disabled:o,required:!0}),e.jsx("button",{type:"button",onClick:()=>L(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?e.jsx(N,{className:"w-4 h-4"}):e.jsx(v,{className:"w-4 h-4"})})]})]}),e.jsx(T,{type:"submit",className:"w-full",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating password..."]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]}),e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-6",children:["Remember your password?"," ",e.jsx("button",{type:"button",onClick:()=>s("/admin/login"),className:"text-primary hover:underline",children:"Sign in"})]})]})})]})]})};export{ae as default};
