import{j as e}from"./vendor-ui--gC2EbFs.js";import{c as q,r as t}from"./vendor-react-BKlpBF4k.js";import{e as H,u as s,H as v}from"./main-BJksuSgA.js";import{B as S}from"./button-BGexsc1Z.js";import{I as k}from"./input-2Qusnpvj.js";import{L as P}from"./label-CnbrxAqo.js";import{S as E}from"./SubtleBackground-C6X9jvtX.js";import{L}from"./loader-circle-2-EN6opG.js";import{m as F}from"./vendor-motion-DpAY1mMN.js";import{M as f}from"./mail-Dq2eRyuU.js";import{A as C}from"./arrow-left-_11r_mA6.js";import{S as z}from"./shield-Cess2Y5F.js";import{L as I}from"./lock-B5hkHWNR.js";import{E as D}from"./eye-off-VXDTZL5-.js";import{E as O}from"./eye-D46cVTuP.js";import{o as A,s as p}from"./types-KBJzO2d1.js";import"./vendor-query-CpApZjIr.js";import"./index-CId5GkVU.js";const G=A({email:p().email("Please enter a valid email address"),password:p().min(6,"Password must be at least 6 characters")}),J=A({email:p().email("Please enter a valid email address")}),ce=()=>{const g=q(),{user:c,isLoading:o,isAdmin:d,signIn:B,resetPassword:M}=H(),[i,j]=t.useState(""),[u,T]=t.useState(""),[x,W]=t.useState(!1),[l,m]=t.useState(!1),[r,b]=t.useState(!1),[R,w]=t.useState(!1);t.useEffect(()=>{!o&&c&&d?g("/admin/"):!o&&c&&!d&&s.error("You don't have admin access. Contact the administrator.")},[c,o,d,g]);const Y=async n=>{if(n.preventDefault(),r){const a=J.safeParse({email:i});if(!a.success){s.error(a.error.errors[0].message);return}m(!0);try{const{error:h}=await M(i);h?s.error(h.message):(w(!0),s.success("Password reset email sent! Check your inbox."))}catch{s.error("An unexpected error occurred")}finally{m(!1)}return}const N=G.safeParse({email:i,password:u});if(!N.success){s.error(N.error.errors[0].message);return}m(!0);try{const{error:a}=await B(i,u);a?a.message.includes("Invalid login credentials")?s.error("Invalid email or password"):s.error(a.message):s.success("Login successful!")}catch{s.error("An unexpected error occurred")}finally{m(!1)}},y=()=>{b(!1),w(!1),j("")};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(L,{className:"w-8 h-8 animate-spin text-primary"})}):r&&R?e.jsxs(e.Fragment,{children:[e.jsxs(v,{children:[e.jsx("title",{children:"Check Your Email | InfraWeave"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(E,{}),e.jsx(F.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(f,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Check Your Email"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["We've sent a password reset link to ",e.jsx("span",{className:"text-foreground font-medium",children:i})]}),e.jsxs(S,{variant:"outline",onClick:y,className:"w-full",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(v,{children:[e.jsxs("title",{children:[r?"Forgot Password":"Admin Login"," | InfraWeave"]}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(E,{}),e.jsx(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground",children:r?"Forgot Password":"Admin Access"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:r?"Enter your email to receive a reset link":"Sign in to manage InfraWeave"})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(k,{id:"email",type:"email",placeholder:"admin@infraweave.net",value:i,onChange:n=>j(n.target.value),className:"pl-10 bg-background/50",disabled:l,required:!0})]})]}),!r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{htmlFor:"password",children:"Password"}),e.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-xs text-primary hover:underline",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(k,{id:"password",type:x?"text":"password",placeholder:"••••••••",value:u,onChange:n=>T(n.target.value),className:"pl-10 pr-10 bg-background/50",disabled:l,required:!0}),e.jsx("button",{type:"button",onClick:()=>W(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:x?e.jsx(D,{className:"w-4 h-4"}):e.jsx(O,{className:"w-4 h-4"})})]})]}),e.jsx(S,{type:"submit",className:"w-full",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4 mr-2 animate-spin"}),r?"Sending...":"Signing in..."]}):r?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Send Reset Link"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Sign In"]})})]}),r&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{type:"button",onClick:y,className:"text-sm text-primary hover:underline",children:[e.jsx(C,{className:"w-3 h-3 inline mr-1"}),"Back to login"]})}),e.jsx("p",{className:"text-center text-xs text-muted-foreground mt-6",children:"This area is restricted to authorized personnel only."})]})})]})]})};export{ce as default};
