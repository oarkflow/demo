import{j as e}from"./vendor-ui-CpQN7H5M.js";import{c as z,r as n}from"./vendor-react-CQIth8Kl.js";import{c as D,e as O,u as s,H as S}from"./main-DOuA4wCK.js";import{B as k}from"./button-DN9WMlhV.js";import{I as P}from"./input-3sGjNk2T.js";import{L as A}from"./label-Da_zOxXJ.js";import{S as C}from"./SubtleBackground-BdN9_nJy.js";import{L}from"./loader-circle-gm-OM9IX.js";import{m as E}from"./vendor-motion-BaiS5iA3.js";import{M as g}from"./mail-CnIzshDs.js";import{A as F}from"./arrow-left-D7h5K2af.js";import{S as G}from"./shield-BdtXguoE.js";import{L as I}from"./lock-CAlp7rmO.js";import{E as J}from"./eye-off-DCUQejr9.js";import{E as K}from"./eye-BLGa8gir.js";import{o as M,s as p}from"./types-BnTeS-Hg.js";import"./vendor-query-CbH48mXO.js";import"./index-BDuca45V.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=D("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),V=M({email:p().email("Please enter a valid email address"),password:p().min(6,"Password must be at least 6 characters")}),X=M({email:p().email("Please enter a valid email address")}),fe=()=>{const j=z(),{user:u,isLoading:l,isAdmin:x,signIn:B,signUp:T,resetPassword:U}=O(),[i,y]=n.useState(""),[c,W]=n.useState(""),[h,q]=n.useState(!1),[m,d]=n.useState(!1),[t,H]=n.useState(!1),[a,b]=n.useState(!1),[R,w]=n.useState(!1);n.useEffect(()=>{!l&&u&&x?j("/admin"):!l&&u&&!x&&s.error("You don't have admin access. Contact the administrator.")},[u,l,x,j]);const Y=async o=>{if(o.preventDefault(),a){const r=X.safeParse({email:i});if(!r.success){s.error(r.error.errors[0].message);return}d(!0);try{const{error:f}=await U(i);f?s.error(f.message):(w(!0),s.success("Password reset email sent! Check your inbox."))}catch{s.error("An unexpected error occurred")}finally{d(!1)}return}const N=V.safeParse({email:i,password:c});if(!N.success){s.error(N.error.errors[0].message);return}d(!0);try{if(t){const{error:r}=await T(i,c);r?r.message.includes("already registered")?s.error("This email is already registered. Try logging in."):s.error(r.message):s.success("Account created! Ask the administrator to grant you admin access.")}else{const{error:r}=await B(i,c);r?r.message.includes("Invalid login credentials")?s.error("Invalid email or password"):s.error(r.message):s.success("Login successful!")}}catch{s.error("An unexpected error occurred")}finally{d(!1)}},v=()=>{b(!1),w(!1),y("")};return l?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(L,{className:"w-8 h-8 animate-spin text-primary"})}):a&&R?e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsx("title",{children:"Check Your Email | InfraWeave"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(C,{}),e.jsx(E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(g,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground mb-2",children:"Check Your Email"}),e.jsxs("p",{className:"text-muted-foreground mb-6",children:["We've sent a password reset link to ",e.jsx("span",{className:"text-foreground font-medium",children:i})]}),e.jsxs(k,{variant:"outline",onClick:v,className:"w-full",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Back to Login"]})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(S,{children:[e.jsxs("title",{children:[a?"Forgot Password":"Admin Login"," | InfraWeave"]}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative flex items-center justify-center",children:[e.jsx(C,{}),e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-8 rounded-2xl glass border border-border/30",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(G,{className:"w-8 h-8 text-primary"})}),e.jsx("h1",{className:"text-2xl font-heading font-bold text-foreground",children:a?"Forgot Password":t?"Create Admin Account":"Admin Access"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:a?"Enter your email to receive a reset link":t?"Sign up for admin access":"Sign in to manage InfraWeave"})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(P,{id:"email",type:"email",placeholder:"admin@infraweave.net",value:i,onChange:o=>y(o.target.value),className:"pl-10 bg-background/50",disabled:m,required:!0})]})]}),!a&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(A,{htmlFor:"password",children:"Password"}),!t&&e.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-xs text-primary hover:underline",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(P,{id:"password",type:h?"text":"password",placeholder:"••••••••",value:c,onChange:o=>W(o.target.value),className:"pl-10 pr-10 bg-background/50",disabled:m,required:!0}),e.jsx("button",{type:"button",onClick:()=>q(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:h?e.jsx(J,{className:"w-4 h-4"}):e.jsx(K,{className:"w-4 h-4"})})]})]}),e.jsx(k,{type:"submit",className:"w-full",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4 mr-2 animate-spin"}),a?"Sending...":t?"Creating account...":"Signing in..."]}):a?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Send Reset Link"]}):t?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Create Account"]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Sign In"]})})]}),e.jsx("div",{className:"mt-6 text-center space-y-2",children:a?e.jsxs("button",{type:"button",onClick:v,className:"text-sm text-primary hover:underline",children:[e.jsx(F,{className:"w-3 h-3 inline mr-1"}),"Back to login"]}):e.jsx("button",{type:"button",onClick:()=>H(!t),className:"text-sm text-primary hover:underline",children:t?"Already have an account? Sign in":"Need an account? Sign up"})}),e.jsx("p",{className:"text-center text-xs text-muted-foreground mt-6",children:"This area is restricted to authorized personnel only."})]})})]})]})};export{fe as default};
