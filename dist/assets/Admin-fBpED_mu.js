import{j as e}from"./vendor-ui-CpQN7H5M.js";import{r,c as ls}from"./vendor-react-CQIth8Kl.js";import{c as ne,s as y,u as d,e as ns,H as cs}from"./main-DOuA4wCK.js";import{g as ue,e as ds,f as os,B as he,S as M,a as $,b as q,c as B,d as t,C as fe}from"./checkbox-D7C1-8hB.js";import{B as n}from"./button-DN9WMlhV.js";import{I as P}from"./input-3sGjNk2T.js";import{D as ee,a as se,b as te,c as ae,d as re,T as ve,e as ie}from"./dialog-B7tK7NkI.js";import{L as j}from"./label-Da_zOxXJ.js";import{U as ms,L as xs,T as us,a as hs,b as Y,c as X,P as ps,d as js}from"./tabs-Bq4rbGpK.js";import{S as gs}from"./SubtleBackground-BdN9_nJy.js";import{m as U}from"./vendor-motion-BaiS5iA3.js";import{S as qe}from"./shield-BdtXguoE.js";import{L as N}from"./loader-circle-gm-OM9IX.js";import{R as le}from"./refresh-cw-DwCkaefq.js";import{C as Be}from"./circle-check-DKkH1cqa.js";import{T as Ve}from"./triangle-alert-Ceezso18.js";import{C as pe}from"./circle-x-IqisJicS.js";import{E as He,C as fs}from"./external-link-HlFQ7TYV.js";import{K as vs}from"./key-tYVGupe8.js";import{D as ys}from"./database-Cje305wr.js";import{L as bs}from"./lock-CAlp7rmO.js";import{S as Ns}from"./search-DQhVum17.js";import{M as V}from"./mail-CnIzshDs.js";import{P as Ne}from"./phone-LBIOAa38.js";import{B as ws}from"./building-2-D6198ZUE.js";import{L as ks}from"./linkedin-C4Vw4HHZ.js";import{F as Oe}from"./file-text-99329Wa_.js";import{U as ye}from"./users-B6GXqWN7.js";import{T as Cs}from"./trending-up-BDsj-ldH.js";import{C as be}from"./calendar-DM4HURmh.js";import{C as Ss}from"./clock-C20VA6FT.js";import{E as _s}from"./eye-BLGa8gir.js";import{C as ze}from"./circle-check-big-C0RdmDXd.js";import{S as Me}from"./send-DAFDnSgP.js";import"./vendor-query-CbH48mXO.js";import"./index-BdQq_4o_.js";import"./chevron-down-XZA7CO6G.js";import"./check-BaiukXth.js";import"./index-BDuca45V.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=ne("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ne("FileKey",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["circle",{cx:"10",cy:"16",r:"2",key:"4ckbqe"}],["path",{d:"m16 10-4.5 4.5",key:"7p3ebg"}],["path",{d:"m15 11 1 1",key:"1bsyx3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=ne("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ne("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=ne("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),$e=()=>[{id:"leaked-password-protection",name:"Leaked Password Protection",description:"Prevents users from using passwords found in known data breaches. Reduces credential-stuffing and account takeover risks.",status:"checking",severity:"high",category:"authentication",howToEnable:"Backend → Authentication → Password Security → Enable 'Leaked Password Protection'",documentationUrl:"https://docs.lovable.dev/features/security#leaked-password-protection-disabled"},{id:"mfa-requirements",name:"Multi-Factor Authentication (MFA)",description:"Adds an extra layer of security by requiring a second form of verification during login.",status:"checking",severity:"high",category:"authentication",howToEnable:"Backend → Authentication → Multi-Factor Authentication → Configure MFA settings",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"email-confirmation",name:"Email Confirmation Required",description:"Ensures users verify their email address before accessing the application.",status:"checking",severity:"medium",category:"authentication",howToEnable:"Backend → Authentication → Email Settings → Enable email confirmation",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"password-strength",name:"Strong Password Requirements",description:"Enforces minimum password complexity requirements (length, special characters, etc.).",status:"checking",severity:"medium",category:"authentication",howToEnable:"Backend → Authentication → Password Security → Configure password requirements",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"rls-admin_users",name:"Admin Users Table RLS",description:"Row Level Security on admin_users table prevents unauthorized access to admin data.",status:"checking",severity:"critical",category:"database",howToEnable:"Already configured - RLS policies protect admin data.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"rls-job_applications",name:"Job Applications Table RLS",description:"Row Level Security on job_applications table restricts access to sensitive applicant data.",status:"checking",severity:"critical",category:"database",howToEnable:"Already configured - Only admins can view applications.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"rls-newsletter_subscribers",name:"Newsletter Subscribers Table RLS",description:"Row Level Security protects subscriber email data from unauthorized access.",status:"checking",severity:"critical",category:"database",howToEnable:"Already configured - Subscriber data is protected.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"admin-protection",name:"Admin Table Write Protection",description:"Prevents unauthorized users from adding themselves as admins.",status:"checking",severity:"critical",category:"database",howToEnable:"Already implemented with DENY policies on admin_users table.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"admin-function",name:"Admin Check Function",description:"The is_admin() security function validates admin status for RLS policies.",status:"checking",severity:"critical",category:"database",howToEnable:"Already implemented with SECURITY DEFINER and fixed search_path.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"newsletter-protection",name:"Newsletter Insert Protection",description:"Prevents unauthorized direct inserts to the newsletter subscribers table.",status:"checking",severity:"high",category:"database",howToEnable:"Already configured - Subscriptions must go through edge function.",documentationUrl:"https://docs.lovable.dev/features/security"},{id:"input-validation",name:"Server-Side Input Validation",description:"Database triggers validate all user inputs before processing to prevent injection attacks.",status:"checking",severity:"critical",category:"api",howToEnable:"Implemented via validate_job_application trigger.",documentationUrl:"https://docs.lovable.dev/features/security"}],Es=m=>{switch(m){case"critical":return"bg-red-500/10 text-red-600 border-red-500/30";case"high":return"bg-orange-500/10 text-orange-600 border-orange-500/30";case"medium":return"bg-yellow-500/10 text-yellow-600 border-yellow-500/30";case"low":return"bg-blue-500/10 text-blue-600 border-blue-500/30"}},Ls=m=>{switch(m){case"enabled":return e.jsx(Be,{className:"w-5 h-5 text-green-500"});case"disabled":return e.jsx(pe,{className:"w-5 h-5 text-red-500"});case"manual-check":return e.jsx(Ve,{className:"w-5 h-5 text-yellow-500"});case"error":return e.jsx(pe,{className:"w-5 h-5 text-red-500"});case"checking":return e.jsx(N,{className:"w-5 h-5 text-muted-foreground animate-spin"})}},Fs=m=>{switch(m){case"enabled":return"Verified";case"disabled":return"Disabled";case"manual-check":return"Requires Manual Check";case"error":return"Check Failed";case"checking":return"Checking..."}},Rs=m=>{switch(m){case"authentication":return e.jsx(bs,{className:"w-4 h-4"});case"database":return e.jsx(ys,{className:"w-4 h-4"});case"api":return e.jsx(vs,{className:"w-4 h-4"});case"general":return e.jsx(Ds,{className:"w-4 h-4"})}},Is=()=>{const[m,w]=r.useState($e()),[C,S]=r.useState(!1),[A,H]=r.useState(null),G=async()=>{var x;S(!0),w($e());try{const{data:u,error:o}=await y.functions.invoke("security-check");if(o){d.error("Failed to run security check"),console.error("Security check error:",o),w(E=>E.map(D=>({...D,status:"error",dynamicMessage:"Could not verify - check failed"})));return}u!=null&&u.success&&(H(u.timestamp),w(E=>E.map(D=>{const L=u.results.find(F=>F.id===D.id),de=u.manualChecks.find(F=>F.id===D.id);return L?{...D,status:L.status,dynamicMessage:L.message}:de?{...D,status:"manual-check",dynamicMessage:de.message}:{...D,status:"manual-check"}})),d.success(`Security check complete: ${u.summary.enabled} verified, ${u.summary.manualCheck+(((x=u.manualChecks)==null?void 0:x.length)||0)} need review`))}catch(u){console.error("Security check error:",u),d.error("Failed to run security check")}finally{S(!1)}};r.useEffect(()=>{G()},[]);const h=m.filter(x=>x.status==="enabled").length,i=m.filter(x=>x.status==="manual-check").length,f=m.filter(x=>x.status==="disabled"||x.status==="error").length,_=m.filter(x=>x.status==="checking").length,p=["authentication","database","api","general"],ce={authentication:"Authentication & Access",database:"Database Security",api:"API Security",general:"General Security"};return e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-heading font-bold flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-primary"}),"Security Checklist"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:A?`Last verified: ${new Date(A).toLocaleString()}`:"Track important security settings and configurations"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:G,disabled:C,children:[C?e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(le,{className:"w-4 h-4 mr-2"}),C?"Checking...":"Run Security Check"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"p-4 rounded-xl glass border border-green-500/30 bg-green-500/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:h}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Verified"})]})]})}),e.jsx("div",{className:"p-4 rounded-xl glass border border-yellow-500/30 bg-yellow-500/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"w-8 h-8 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:i}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Needs Review"})]})]})}),e.jsx("div",{className:"p-4 rounded-xl glass border border-red-500/30 bg-red-500/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:f}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Issues Found"})]})]})}),e.jsx("div",{className:"p-4 rounded-xl glass border border-border/30 bg-muted/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:`w-8 h-8 text-muted-foreground ${_>0?"animate-spin":""}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-muted-foreground",children:_}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Checking"})]})]})})]}),p.map(x=>{const u=m.filter(o=>o.category===x);return u.length===0?null:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-foreground",children:[Rs(x),ce[x]]}),e.jsx("div",{className:"space-y-3",children:u.map(o=>e.jsx("div",{className:"p-4 rounded-xl glass border border-border/30",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-0.5",children:Ls(o.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h4",{className:"font-medium",children:o.name}),e.jsx(ue,{variant:"outline",className:Es(o.severity),children:o.severity}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${o.status==="enabled"?"bg-green-500/10 text-green-600":o.status==="manual-check"?"bg-yellow-500/10 text-yellow-600":o.status==="checking"?"bg-muted text-muted-foreground":"bg-red-500/10 text-red-600"}`,children:Fs(o.status)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:o.description}),o.dynamicMessage&&e.jsxs("p",{className:"text-xs text-primary mb-2",children:["✓ ",o.dynamicMessage]}),e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-border/20",children:[e.jsx("p",{className:"text-xs font-medium text-foreground mb-1",children:"How to enable:"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.howToEnable})]})]})]}),e.jsx("a",{href:o.documentationUrl,target:"_blank",rel:"noopener noreferrer",className:"flex-shrink-0",children:e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Docs"]})})]})},o.id))})]},x)}),e.jsx("div",{className:"p-4 rounded-xl bg-primary/5 border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(we,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Security Best Practices"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Items marked as "Needs Review" require manual verification in your backend settings. Items marked as "Verified" have been automatically confirmed by the security check. Click "Run Security Check" to refresh the status of all verifiable items.'})]})]})})]})},Ps=()=>{const[m,w]=r.useState([]),[C,S]=r.useState(!0),[A,H]=r.useState("");r.useEffect(()=>{G()},[]);const G=async()=>{try{const{data:i,error:f}=await y.from("applicant_profiles").select("id, email, full_name, phone, linkedin_url, current_company, experience_years, skills, certifications, created_at").order("created_at",{ascending:!1});if(f)throw f;w(i||[])}catch(i){console.error("Error fetching profiles:",i),d.error("Failed to load profiles")}finally{S(!1)}},h=m.filter(i=>{var f,_;return((f=i.full_name)==null?void 0:f.toLowerCase().includes(A.toLowerCase()))||i.email.toLowerCase().includes(A.toLowerCase())||((_=i.skills)==null?void 0:_.some(p=>p.toLowerCase().includes(A.toLowerCase())))});return C?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ns,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(P,{placeholder:"Search by name, email, or skills...",value:A,onChange:i=>H(i.target.value),className:"pl-10"})]}),e.jsxs(ue,{variant:"outline",children:[h.length," applicants"]})]}),e.jsxs("div",{className:"grid gap-4",children:[h.map((i,f)=>{var _;return e.jsx(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:f*.05},children:e.jsx(ds,{children:e.jsx(os,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ms,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold",children:i.full_name||"Name not provided"}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"}),i.email]}),i.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),i.phone]}),i.current_company&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ws,{className:"w-3 h-3"}),i.current_company]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),i.experience_years,"+ years"]})]}),((_=i.skills)==null?void 0:_.length)>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[i.skills.slice(0,5).map(p=>e.jsx(ue,{variant:"secondary",className:"text-xs",children:p},p)),i.skills.length>5&&e.jsxs(ue,{variant:"outline",className:"text-xs",children:["+",i.skills.length-5]})]})]}),i.linkedin_url&&e.jsx("a",{href:i.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80",children:e.jsx(ks,{className:"w-5 h-5"})})]})})})},i.id)}),h.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No applicant profiles found"})]})]})},Nt=()=>{const m=ls(),{user:w,isLoading:C,isAdmin:S,signOut:A}=ns(),[H,G]=r.useState([]),[h,i]=r.useState([]),[f,_]=r.useState([]),[p,ce]=r.useState([]),[x,u]=r.useState(!0),[o,E]=r.useState(!1),[D,L]=r.useState(!1),[de,F]=r.useState(!1),[Ge,O]=r.useState(!1),[We,je]=r.useState(!1),[z,oe]=r.useState(null),[c,ke]=r.useState(null),[a,v]=r.useState({title:"",slug:"",excerpt:"",category:"Infrastructure",type:"Article",read_time:"5 min read"}),[R,me]=r.useState({subject:"",content:""}),[g,W]=r.useState([]),[J,K]=r.useState(!1),[Ce,Se]=r.useState(!1),[_e,Ae]=r.useState(!1),[De,Te]=r.useState(!1),[Z,Je]=r.useState("all");r.useEffect(()=>{!C&&!w?m("/admin/login"):!C&&w&&!S&&(d.error("You don't have admin access"),m("/"))},[w,C,S,m]),r.useEffect(()=>{S&&T()},[S]);const T=async()=>{u(!0);try{const[s,l,k,Q]=await Promise.all([y.from("resource_articles").select("*").order("published_at",{ascending:!1}),y.from("newsletter_subscribers").select("*").order("subscribed_at",{ascending:!1}),y.from("newsletter_digest_log").select("*").order("sent_at",{ascending:!1}).limit(10),y.from("job_applications").select("*").order("created_at",{ascending:!1})]);s.data&&G(s.data),l.data&&i(l.data),k.data&&_(k.data),Q.data&&ce(Q.data)}catch(s){console.error("Error fetching data:",s),d.error("Failed to load data")}finally{u(!1)}},Ee=async(s,l)=>{Te(!0);try{const k=p.find(I=>I.id===s),{error:Q}=await y.from("job_applications").update({status:l}).eq("id",s);if(Q)throw Q;if(k&&["reviewed","interviewed","hired","rejected"].includes(l))try{await y.functions.invoke("send-notification",{body:{type:"application_status_update",data:{fullName:k.full_name,email:k.email,position:k.position,status:l}}}),d.success(`Status updated to ${l} and notification sent to applicant`)}catch(I){console.error("Failed to send status notification:",I),d.success(`Status updated to ${l} (notification email failed)`)}else d.success(`Application status updated to ${l}`);ce(I=>I.map(ge=>ge.id===s?{...ge,status:l}:ge)),(c==null?void 0:c.id)===s&&ke(I=>I?{...I,status:l}:null)}catch(k){d.error(k.message||"Failed to update status")}finally{Te(!1)}},Le=s=>{switch(s){case"pending":return"bg-yellow-500/10 text-yellow-600 border-yellow-500/30";case"reviewed":return"bg-blue-500/10 text-blue-600 border-blue-500/30";case"interviewed":return"bg-purple-500/10 text-purple-600 border-purple-500/30";case"hired":return"bg-green-500/10 text-green-600 border-green-500/30";case"rejected":return"bg-red-500/10 text-red-600 border-red-500/30";default:return"bg-muted text-muted-foreground"}},Fe=Z==="all"?p:p.filter(s=>s.status===Z),b={total:p.length,pending:p.filter(s=>s.status==="pending").length,reviewed:p.filter(s=>s.status==="reviewed").length,interviewed:p.filter(s=>s.status==="interviewed").length,hired:p.filter(s=>s.status==="hired").length,rejected:p.filter(s=>s.status==="rejected").length},Ke=async()=>{K(!0);try{const{error:s}=await y.from("resource_articles").insert({title:a.title,slug:a.slug.startsWith("/")?a.slug:`/resources/${a.slug}`,excerpt:a.excerpt,category:a.category,type:a.type,read_time:a.read_time,published_at:new Date().toISOString()});if(s)throw s;d.success("Article added successfully! Subscribers will be notified at 9 AM."),E(!1),Pe(),T()}catch(s){d.error(s.message||"Failed to add article")}finally{K(!1)}},Ye=async()=>{if(z){K(!0);try{const{error:s}=await y.from("resource_articles").update({title:a.title,slug:a.slug,excerpt:a.excerpt,category:a.category,type:a.type,read_time:a.read_time}).eq("id",z.id);if(s)throw s;d.success("Article updated successfully!"),L(!1),Pe(),T()}catch(s){d.error(s.message||"Failed to update article")}finally{K(!1)}}},Xe=async()=>{if(z){K(!0);try{const{error:s}=await y.from("resource_articles").delete().eq("id",z.id);if(s)throw s;d.success("Article deleted successfully!"),F(!1),oe(null),T()}catch(s){d.error(s.message||"Failed to delete article")}finally{K(!1)}}},Ze=async()=>{Se(!0);try{const{data:s,error:l}=await y.functions.invoke("send-newsletter-digest",{body:{source:"manual"}});if(l)throw l;s.articlesCount===0?d.info("No new articles to send"):d.success(`Digest sent to ${s.subscribersCount} subscribers with ${s.articlesCount} articles!`),T()}catch(s){d.error(s.message||"Failed to send digest")}finally{Se(!1)}},Qe=async()=>{if(!R.subject.trim()||!R.content.trim()){d.error("Please enter both subject and content");return}if(g.length===0){d.error("Please select at least one subscriber");return}Ae(!0);try{const{data:s,error:l}=await y.functions.invoke("send-custom-email",{body:{subject:R.subject,content:R.content,subscriberIds:g}});if(l)throw l;s.subscribersCount===0?d.info("No subscribers to send to"):(d.success(`Email sent to ${s.subscribersCount} subscriber(s)!`),O(!1),me({subject:"",content:""}),W([]))}catch(s){d.error(s.message||"Failed to send email")}finally{Ae(!1)}},Re=s=>{W(l=>l.includes(s)?l.filter(k=>k!==s):[...l,s])},Ie=()=>{const s=h.filter(l=>l.is_active).map(l=>l.id);g.length===s.length?W([]):W(s)},es=s=>{W([s.id]),O(!0)},ss=s=>{oe(s),v({title:s.title,slug:s.slug,excerpt:s.excerpt||"",category:s.category,type:s.type,read_time:s.read_time||""}),L(!0)},ts=s=>{oe(s),F(!0)},Pe=()=>{v({title:"",slug:"",excerpt:"",category:"Infrastructure",type:"Article",read_time:"5 min read"}),oe(null)},as=async()=>{await A(),m("/")};if(C||!S)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})});const rs=h.filter(s=>s.is_active).length,is=H.length,Ue=f[0];return e.jsxs(e.Fragment,{children:[e.jsxs(cs,{children:[e.jsx("title",{children:"Admin Dashboard | InfraWeave"}),e.jsx("meta",{name:"robots",content:"noindex, nofollow"})]}),e.jsxs("main",{className:"min-h-screen bg-background relative",children:[e.jsx(gs,{}),e.jsx("header",{className:"sticky top-0 z-50 glass border-b border-border/30",children:e.jsxs("div",{className:"container mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 border border-primary/30 flex items-center justify-center",children:e.jsx(fs,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-heading font-bold text-lg",children:"Admin Dashboard"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:w==null?void 0:w.email})]})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:as,children:[e.jsx(xs,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})}),e.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"p-6 rounded-xl glass border border-border/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(Oe,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:is}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Articles"})]})]})}),e.jsx("div",{className:"p-6 rounded-xl glass border border-border/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-500/10 flex items-center justify-center",children:e.jsx(ye,{className:"w-6 h-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:rs}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Subscribers"})]})]})}),e.jsx("div",{className:"p-6 rounded-xl glass border border-border/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:f.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Digests Sent"})]})]})}),e.jsx("div",{className:"p-6 rounded-xl glass border border-border/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center",children:e.jsx(Cs,{className:"w-6 h-6 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Ue?new Date(Ue.sent_at).toLocaleDateString():"Never"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Digest"})]})]})})]}),e.jsxs(us,{defaultValue:"articles",className:"space-y-6",children:[e.jsxs(hs,{className:"glass border border-border/30",children:[e.jsxs(Y,{value:"articles",className:"gap-2",children:[e.jsx(Oe,{className:"w-4 h-4"}),"Articles"]}),e.jsxs(Y,{value:"applications",className:"gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Applications",b.pending>0&&e.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs rounded-full bg-yellow-500/20 text-yellow-600",children:b.pending})]}),e.jsxs(Y,{value:"subscribers",className:"gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Subscribers"]}),e.jsxs(Y,{value:"newsletter",className:"gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),"Newsletter"]}),e.jsxs(Y,{value:"security",className:"gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),"Security"]}),e.jsxs(Y,{value:"profiles",className:"gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Profiles"]})]}),e.jsx(X,{value:"articles",children:e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:"Resource Articles"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(n,{size:"sm",onClick:()=>E(!0),children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Add Article"]})]})]}),x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsx("div",{className:"space-y-3",children:H.map(s=>e.jsxs("div",{className:"p-4 rounded-xl glass border border-border/30 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary border border-primary/30",children:s.category}),e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-muted text-muted-foreground",children:s.type})]}),e.jsx("h3",{className:"font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),new Date(s.published_at).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ss,{className:"w-3 h-3"}),s.read_time]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ss(s),children:e.jsx(Ts,{className:"w-4 h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ts(s),children:e.jsx(js,{className:"w-4 h-4 text-destructive"})})]})]},s.id))})]})}),e.jsx(X,{value:"applications",children:e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:"Job Applications"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(M,{value:Z,onValueChange:Je,children:[e.jsx($,{className:"w-[160px]",children:e.jsx(q,{placeholder:"Filter by status"})}),e.jsxs(B,{children:[e.jsxs(t,{value:"all",children:["All (",b.total,")"]}),e.jsxs(t,{value:"pending",children:["Pending (",b.pending,")"]}),e.jsxs(t,{value:"reviewed",children:["Reviewed (",b.reviewed,")"]}),e.jsxs(t,{value:"interviewed",children:["Interviewed (",b.interviewed,")"]}),e.jsxs(t,{value:"hired",children:["Hired (",b.hired,")"]}),e.jsxs(t,{value:"rejected",children:["Rejected (",b.rejected,")"]})]})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"p-4 rounded-xl glass border border-yellow-500/30 bg-yellow-500/5",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:b.pending}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending"})]}),e.jsxs("div",{className:"p-4 rounded-xl glass border border-blue-500/30 bg-blue-500/5",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.reviewed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Reviewed"})]}),e.jsxs("div",{className:"p-4 rounded-xl glass border border-purple-500/30 bg-purple-500/5",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:b.interviewed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Interviewed"})]}),e.jsxs("div",{className:"p-4 rounded-xl glass border border-green-500/30 bg-green-500/5",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.hired}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Hired"})]}),e.jsxs("div",{className:"p-4 rounded-xl glass border border-red-500/30 bg-red-500/5",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b.rejected}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Rejected"})]})]}),x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsx("div",{className:"space-y-3",children:Fe.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:Z==="all"?"No applications yet":`No ${Z} applications`}):Fe.map(s=>e.jsx("div",{className:"p-4 rounded-xl glass border border-border/30 hover:border-border/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold",children:s.full_name}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${Le(s.status)}`,children:s.status})]}),e.jsx("p",{className:"text-sm font-medium text-primary mb-1",children:s.position}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"}),s.email]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),s.phone]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),s.experience_years," years exp."]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),new Date(s.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>{ke(s),je(!0)},children:e.jsx(_s,{className:"w-4 h-4"})}),e.jsxs(M,{value:s.status,onValueChange:l=>Ee(s.id,l),disabled:De,children:[e.jsx($,{className:"w-[130px] h-9",children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"reviewed",children:"Reviewed"}),e.jsx(t,{value:"interviewed",children:"Interviewed"}),e.jsx(t,{value:"hired",children:"Hired"}),e.jsx(t,{value:"rejected",children:"Rejected"})]})]})]})]})},s.id))})]})}),e.jsx(X,{value:"subscribers",children:e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:"Newsletter Subscribers"}),e.jsxs("div",{className:"flex gap-2",children:[g.length>0&&e.jsxs(n,{size:"sm",onClick:()=>O(!0),children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Email Selected (",g.length,")"]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),h.filter(s=>s.is_active).length>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg glass border border-border/30",children:[e.jsx(fe,{id:"select-all",checked:g.length===h.filter(s=>s.is_active).length,onCheckedChange:Ie}),e.jsxs("label",{htmlFor:"select-all",className:"text-sm font-medium cursor-pointer",children:["Select all active subscribers (",h.filter(s=>s.is_active).length,")"]})]}),x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-3",children:[h.map(s=>e.jsxs("div",{className:`p-4 rounded-xl glass border ${g.includes(s.id)?"border-primary/50 bg-primary/5":"border-border/30"} flex items-center justify-between transition-colors`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.is_active&&e.jsx(fe,{checked:g.includes(s.id),onCheckedChange:()=>Re(s.id)}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(V,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:s.email}),s.name&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Joined ",new Date(s.subscribed_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-500",children:[e.jsx(ze,{className:"w-4 h-4"}),"Active"]}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>es(s),title:"Send email to this subscriber",children:e.jsx(xe,{className:"w-4 h-4"})})]}):e.jsxs("span",{className:"flex items-center gap-1 text-xs text-red-500",children:[e.jsx(pe,{className:"w-4 h-4"}),"Unsubscribed"]})})]},s.id)),h.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No subscribers yet"})]})]})}),e.jsx(X,{value:"newsletter",children:e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:"Newsletter Management"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",onClick:()=>O(!0),children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Compose Email"]}),e.jsx(n,{onClick:Ze,disabled:Ce,children:Ce?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Send Digest Now"]})})]})]}),e.jsxs("div",{className:"p-6 rounded-xl glass border border-primary/30 bg-primary/5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:e.jsx(xe,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Custom Email"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send a personalized message to all subscribers"})]})]}),e.jsxs(n,{className:"w-full sm:w-auto",onClick:()=>O(!0),children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Compose New Email"]})]}),e.jsxs("div",{className:"p-6 rounded-xl glass border border-border/30",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Scheduled Digest"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Newsletter digests are automatically sent ",e.jsx("strong",{children:"daily at 9 AM UTC"})," if there are new articles since the last digest."]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium",children:"Recent Digest History"}),f.length===0?e.jsx("p",{className:"text-muted-foreground",children:"No digests sent yet"}):e.jsx("div",{className:"space-y-3",children:f.map(s=>e.jsx("div",{className:"p-4 rounded-xl glass border border-border/30 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/10 flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[new Date(s.sent_at).toLocaleDateString()," at"," ",new Date(s.sent_at).toLocaleTimeString()]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.articles_count," articles • ",s.subscribers_count," recipients"]})]})]})},s.id))})]})]})}),e.jsx(X,{value:"security",children:e.jsx(Is,{})}),e.jsx(X,{value:"profiles",children:e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-heading font-bold",children:"Applicant Profiles"}),e.jsxs(n,{variant:"outline",size:"sm",onClick:T,children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),e.jsx(Ps,{})]})})]})]}),e.jsx(ee,{open:o,onOpenChange:E,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Add New Article"}),e.jsx(re,{children:"Add a new resource article. Subscribers will be notified in the next daily digest."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"title",children:"Title"}),e.jsx(P,{id:"title",value:a.title,onChange:s=>v({...a,title:s.target.value}),placeholder:"Article title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"slug",children:"Slug"}),e.jsx(P,{id:"slug",value:a.slug,onChange:s=>v({...a,slug:s.target.value}),placeholder:"article-slug (will be prefixed with /resources/)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"excerpt",children:"Excerpt"}),e.jsx(ve,{id:"excerpt",value:a.excerpt,onChange:s=>v({...a,excerpt:s.target.value}),placeholder:"Brief description of the article",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Category"}),e.jsxs(M,{value:a.category,onValueChange:s=>v({...a,category:s}),children:[e.jsx($,{children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"Infrastructure",children:"Infrastructure"}),e.jsx(t,{value:"Security",children:"Security"}),e.jsx(t,{value:"Automation",children:"Automation"}),e.jsx(t,{value:"Cloud",children:"Cloud"}),e.jsx(t,{value:"DevOps",children:"DevOps"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Type"}),e.jsxs(M,{value:a.type,onValueChange:s=>v({...a,type:s}),children:[e.jsx($,{children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"Article",children:"Article"}),e.jsx(t,{value:"Guide",children:"Guide"}),e.jsx(t,{value:"Tutorial",children:"Tutorial"}),e.jsx(t,{value:"Whitepaper",children:"Whitepaper"}),e.jsx(t,{value:"Case Study",children:"Case Study"}),e.jsx(t,{value:"Technical Guide",children:"Technical Guide"}),e.jsx(t,{value:"Perspective",children:"Perspective"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"readTime",children:"Read Time"}),e.jsx(P,{id:"readTime",value:a.read_time,onChange:s=>v({...a,read_time:s.target.value}),placeholder:"5 min read"})]})]}),e.jsxs(ie,{children:[e.jsx(n,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsxs(n,{onClick:Ke,disabled:J,children:[J?e.jsx(N,{className:"w-4 h-4 animate-spin mr-2"}):null,"Add Article"]})]})]})}),e.jsx(ee,{open:D,onOpenChange:L,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Edit Article"}),e.jsx(re,{children:"Update the article details."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"edit-title",children:"Title"}),e.jsx(P,{id:"edit-title",value:a.title,onChange:s=>v({...a,title:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"edit-slug",children:"Slug"}),e.jsx(P,{id:"edit-slug",value:a.slug,onChange:s=>v({...a,slug:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"edit-excerpt",children:"Excerpt"}),e.jsx(ve,{id:"edit-excerpt",value:a.excerpt,onChange:s=>v({...a,excerpt:s.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Category"}),e.jsxs(M,{value:a.category,onValueChange:s=>v({...a,category:s}),children:[e.jsx($,{children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"Infrastructure",children:"Infrastructure"}),e.jsx(t,{value:"Security",children:"Security"}),e.jsx(t,{value:"Automation",children:"Automation"}),e.jsx(t,{value:"Cloud",children:"Cloud"}),e.jsx(t,{value:"DevOps",children:"DevOps"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Type"}),e.jsxs(M,{value:a.type,onValueChange:s=>v({...a,type:s}),children:[e.jsx($,{children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"Article",children:"Article"}),e.jsx(t,{value:"Guide",children:"Guide"}),e.jsx(t,{value:"Tutorial",children:"Tutorial"}),e.jsx(t,{value:"Whitepaper",children:"Whitepaper"}),e.jsx(t,{value:"Case Study",children:"Case Study"}),e.jsx(t,{value:"Technical Guide",children:"Technical Guide"}),e.jsx(t,{value:"Perspective",children:"Perspective"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"edit-readTime",children:"Read Time"}),e.jsx(P,{id:"edit-readTime",value:a.read_time,onChange:s=>v({...a,read_time:s.target.value})})]})]}),e.jsxs(ie,{children:[e.jsx(n,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsxs(n,{onClick:Ye,disabled:J,children:[J?e.jsx(N,{className:"w-4 h-4 animate-spin mr-2"}):null,"Save Changes"]})]})]})}),e.jsx(ee,{open:de,onOpenChange:F,children:e.jsxs(se,{children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Delete Article"}),e.jsxs(re,{children:['Are you sure you want to delete "',z==null?void 0:z.title,'"? This action cannot be undone.']})]}),e.jsxs(ie,{children:[e.jsx(n,{variant:"outline",onClick:()=>F(!1),children:"Cancel"}),e.jsxs(n,{variant:"destructive",onClick:Xe,disabled:J,children:[J?e.jsx(N,{className:"w-4 h-4 animate-spin mr-2"}):null,"Delete"]})]})]})}),e.jsx(ee,{open:Ge,onOpenChange:s=>{O(s),s||(W([]),me({subject:"",content:""}))},children:e.jsxs(se,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsx(ae,{children:"Compose Email"}),e.jsx(re,{children:"Send a custom email to selected subscribers."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Recipients (",g.length," selected)"]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto rounded-lg border border-border/30 p-3 space-y-2",children:[h.filter(s=>s.is_active).map(s=>e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-md transition-colors ${g.includes(s.id)?"bg-primary/10":"hover:bg-muted/50"}`,children:[e.jsx(fe,{checked:g.includes(s.id),onCheckedChange:()=>Re(s.id)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.email}),s.name&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.name})]})]},s.id)),h.filter(s=>s.is_active).length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-2",children:"No active subscribers"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(n,{variant:"outline",size:"sm",onClick:Ie,children:g.length===h.filter(s=>s.is_active).length?"Deselect All":"Select All"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"email-subject",children:"Subject"}),e.jsx(P,{id:"email-subject",value:R.subject,onChange:s=>me({...R,subject:s.target.value}),placeholder:"e.g., Exciting Updates from InfraWeave"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"email-content",children:"Message"}),e.jsx(ve,{id:"email-content",value:R.content,onChange:s=>me({...R,content:s.target.value}),placeholder:`Write your message here...

You can use **bold** text and *italic* text.

Separate paragraphs with blank lines.`,rows:8,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supports basic formatting: **bold** and *italic*. Paragraphs are separated by blank lines."})]})]}),e.jsxs(ie,{children:[e.jsx(n,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(n,{onClick:Qe,disabled:_e||g.length===0,children:_e?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 animate-spin mr-2"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Send to ",g.length," Subscriber",g.length!==1?"s":""]})})]})]})}),e.jsx(ee,{open:We,onOpenChange:je,children:e.jsxs(se,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsxs(ae,{className:"flex items-center gap-3",children:["Application Details",c&&e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${Le(c.status)}`,children:c.status})]}),e.jsx(re,{children:"Review the complete application and update status."})]}),c&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ye,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:c.full_name}),e.jsx("p",{className:"text-primary font-medium",children:c.position})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Email"}),e.jsxs("a",{href:`mailto:${c.email}`,className:"text-sm text-primary hover:underline flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"}),c.email]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Phone"}),e.jsxs("a",{href:`tel:${c.phone}`,className:"text-sm text-primary hover:underline flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),c.phone]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Experience"}),e.jsxs("p",{className:"text-sm flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),c.experience_years," years"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Applied On"}),e.jsxs("p",{className:"text-sm flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),new Date(c.created_at).toLocaleDateString()]})]}),c.current_company&&e.jsxs("div",{className:"space-y-1 col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Current Company"}),e.jsx("p",{className:"text-sm",children:c.current_company})]}),c.linkedin_url&&e.jsxs("div",{className:"space-y-1 col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"LinkedIn"}),e.jsxs("a",{href:c.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline flex items-center gap-1",children:[e.jsx(He,{className:"w-3 h-3"}),"View Profile"]})]})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-muted/50 border border-border/30",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide mb-2",children:"Resume"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c.resume_url}),e.jsxs(n,{variant:"outline",size:"sm",onClick:async()=>{const{data:s}=await y.storage.from("resumes").createSignedUrl(c.resume_url,3600);s!=null&&s.signedUrl?window.open(s.signedUrl,"_blank"):d.error("Could not generate download link")},children:[e.jsx(As,{className:"w-4 h-4 mr-2"}),"Download"]})]})]}),c.cover_letter&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Cover Letter"}),e.jsx("div",{className:"p-4 rounded-xl bg-muted/30 border border-border/30",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:c.cover_letter})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Update Status"}),e.jsxs(M,{value:c.status,onValueChange:s=>Ee(c.id,s),disabled:De,children:[e.jsx($,{children:e.jsx(q,{})}),e.jsxs(B,{children:[e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"reviewed",children:"Reviewed"}),e.jsx(t,{value:"interviewed",children:"Interviewed"}),e.jsx(t,{value:"hired",children:"Hired"}),e.jsx(t,{value:"rejected",children:"Rejected"})]})]})]})]}),e.jsx(ie,{children:e.jsx(n,{variant:"outline",onClick:()=>je(!1),children:"Close"})})]})})]})]})};export{Nt as default};
