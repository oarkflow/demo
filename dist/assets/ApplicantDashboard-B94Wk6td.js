import{j as e,f as Jt,h as ps}from"./vendor-ui-DDe0YJcq.js";import{r as b,L as er,R as P,e as mt}from"./vendor-react-Dm5yKVFn.js";import{B as Y,S as sr}from"./button-DbesmKjE.js";import{d as ft,U as ze,P as Gs,C as tr,L as rr,T as ar,a as ir,b as Oe,c as Be}from"./tabs-DMiOQKFp.js";import{P as ws}from"./index-ChS8W741.js";import{c as Ye,b as Pe,e as Ue,X as gs,u as O,s as K}from"./main-C0uu6PdK.js";import{A as ys,N as nr,F as lr}from"./Footer-Cvsb3-Sv.js";import{S as or}from"./SEO-CdeZ9FJQ.js";import{I as ce}from"./input-CecEDlVO.js";import{P as cr,T as ht}from"./textarea-BQ2Nt2Bp.js";import{C as ee,h as be,i as we,j as Fe,a as se,B as ge,S as Ke,b as Qe,c as Xe,d as Ze,e as le,f as Ae,g as dr}from"./select-BwH1jOeS.js";import{F as Je}from"./file-text-DM_mb8BT.js";import{C as as}from"./circle-check-big-KsWECfqS.js";import{L as ie}from"./loader-circle-BzrDTreR.js";import{M as xt}from"./mail-BIKt52Ez.js";import{L as ur}from"./linkedin-CIlyPGzz.js";import{B as is}from"./building-2-_OXQ8VGY.js";import{A as Ks}from"./award-Bqbwv1Nb.js";import{m as Ee,A as mr}from"./vendor-motion-CV8qHFWj.js";import{C as fr}from"./calendar-D9kgLrvj.js";import{C as es}from"./clock-BQgjpNJs.js";import{C as hr}from"./circle-x-B5cDoCrv.js";import{C as xr}from"./circle-alert-D8mKwch6.js";import{p as Le}from"./positions-BrWQkCbi.js";import{L as qe}from"./label-CjwsJpyl.js";import{P as pr}from"./phone-input-Dc_PZP_8.js";import{o as gr,s as he,l as yr}from"./types-BnTeS-Hg.js";import{S as pt}from"./search-DypaGCS9.js";import{M as gt}from"./map-pin-C3s1qfqU.js";import{C as jr}from"./chevron-down-BPbxj4Gh.js";import{C as vr}from"./check-CG4S9Yho.js";import{S as Nr}from"./shield-gT6NLMf7.js";import{L as fs}from"./lock-BEDOAixf.js";import{S as br}from"./settings-3AYhBynl.js";import"./vendor-query-H2NWpbgn.js";import"./index-BdQq_4o_.js";import"./dialog-B43xNpMB.js";import"./popover-DOGrybD5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Ye("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=Ye("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Ye("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=Ye("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Ye("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function _r(s,r=[]){let t=[];function a(l,o){const d=b.createContext(o);d.displayName=l+"Context";const v=t.length;t=[...t,o];const C=y=>{var R;const{scope:F,children:h,..._}=y,p=((R=F==null?void 0:F[s])==null?void 0:R[v])||d,E=b.useMemo(()=>_,Object.values(_));return e.jsx(p.Provider,{value:E,children:h})};C.displayName=l+"Provider";function L(y,F){var p;const h=((p=F==null?void 0:F[s])==null?void 0:p[v])||d,_=b.useContext(h);if(_)return _;if(o!==void 0)return o;throw new Error(`\`${y}\` must be used within \`${l}\``)}return[C,L]}const i=()=>{const l=t.map(o=>b.createContext(o));return function(d){const v=(d==null?void 0:d[s])||l;return b.useMemo(()=>({[`__scope${s}`]:{...d,[s]:v}}),[d,v])}};return i.scopeName=s,[a,Sr(i,...r)]}function Sr(...s){const r=s[0];if(s.length===1)return r;const t=()=>{const a=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(l){const o=a.reduce((d,{useScope:v,scopeName:C})=>{const y=v(l)[`__scope${C}`];return{...d,...y}},{});return b.useMemo(()=>({[`__scope${r.scopeName}`]:o}),[o])}};return t.scopeName=r.scopeName,t}var yt={exports:{}},jt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Re=b;function Cr(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var Fr=typeof Object.is=="function"?Object.is:Cr,kr=Re.useState,Vr=Re.useEffect,Ar=Re.useLayoutEffect,Er=Re.useDebugValue;function Pr(s,r){var t=r(),a=kr({inst:{value:t,getSnapshot:r}}),i=a[0].inst,l=a[1];return Ar(function(){i.value=t,i.getSnapshot=r,hs(i)&&l({inst:i})},[s,t,r]),Vr(function(){return hs(i)&&l({inst:i}),s(function(){hs(i)&&l({inst:i})})},[s]),Er(t),t}function hs(s){var r=s.getSnapshot;s=s.value;try{var t=r();return!Fr(s,t)}catch{return!0}}function Dr(s,r){return r()}var Lr=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Dr:Pr;jt.useSyncExternalStore=Re.useSyncExternalStore!==void 0?Re.useSyncExternalStore:Lr;yt.exports=jt;var Ir=yt.exports;function Rr(){return Ir.useSyncExternalStore(Ur,()=>!0,()=>!1)}function Ur(){return()=>{}}var _s="Avatar",[Tr]=_r(_s),[Mr,vt]=Tr(_s),Nt=b.forwardRef((s,r)=>{const{__scopeAvatar:t,...a}=s,[i,l]=b.useState("idle");return e.jsx(Mr,{scope:t,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:e.jsx(ws.span,{...a,ref:r})})});Nt.displayName=_s;var bt="AvatarImage",wt=b.forwardRef((s,r)=>{const{__scopeAvatar:t,src:a,onLoadingStatusChange:i=()=>{},...l}=s,o=vt(bt,t),d=Or(a,l),v=Jt(C=>{i(C),o.onImageLoadingStatusChange(C)});return ps(()=>{d!=="idle"&&v(d)},[d,v]),d==="loaded"?e.jsx(ws.img,{...l,ref:r,src:a}):null});wt.displayName=bt;var _t="AvatarFallback",St=b.forwardRef((s,r)=>{const{__scopeAvatar:t,delayMs:a,...i}=s,l=vt(_t,t),[o,d]=b.useState(a===void 0);return b.useEffect(()=>{if(a!==void 0){const v=window.setTimeout(()=>d(!0),a);return()=>window.clearTimeout(v)}},[a]),o&&l.imageLoadingStatus!=="loaded"?e.jsx(ws.span,{...i,ref:r}):null});St.displayName=_t;function Zs(s,r){return s?r?(s.src!==r&&(s.src=r),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Or(s,{referrerPolicy:r,crossOrigin:t}){const a=Rr(),i=b.useRef(null),l=a?(i.current||(i.current=new window.Image),i.current):null,[o,d]=b.useState(()=>Zs(l,s));return ps(()=>{d(Zs(l,s))},[l,s]),ps(()=>{const v=y=>()=>{d(y)};if(!l)return;const C=v("loaded"),L=v("error");return l.addEventListener("load",C),l.addEventListener("error",L),r&&(l.referrerPolicy=r),typeof t=="string"&&(l.crossOrigin=t),()=>{l.removeEventListener("load",C),l.removeEventListener("error",L)}},[l,t,r]),o}var Ct=Nt,Ft=wt,kt=St;const Ss=b.forwardRef(({className:s,...r},t)=>e.jsx(Ct,{ref:t,className:Pe("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r}));Ss.displayName=Ct.displayName;const Cs=b.forwardRef(({className:s,...r},t)=>e.jsx(Ft,{ref:t,className:Pe("aspect-square h-full w-full",s),...r}));Cs.displayName=Ft.displayName;const Fs=b.forwardRef(({className:s,...r},t)=>e.jsx(kt,{ref:t,className:Pe("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r}));Fs.displayName=kt.displayName;const Br=({profile:s,onProfileUpdate:r})=>{const{user:t}=Ue(),[a,i]=b.useState(!1),[l,o]=b.useState(!1),[d,v]=b.useState(!1),[C,L]=b.useState(!1),[y,F]=b.useState(""),[h,_]=b.useState(""),[p,E]=b.useState({full_name:(s==null?void 0:s.full_name)||"",phone:(s==null?void 0:s.phone)||"",linkedin_url:(s==null?void 0:s.linkedin_url)||"",current_company:(s==null?void 0:s.current_company)||"",experience_years:(s==null?void 0:s.experience_years)||0,bio:(s==null?void 0:s.bio)||"",skills:(s==null?void 0:s.skills)||[],certifications:(s==null?void 0:s.certifications)||[]}),R=async()=>{if(t){o(!0);try{const{error:N}=await K.from("applicant_profiles").update({full_name:p.full_name||null,phone:p.phone||null,linkedin_url:p.linkedin_url||null,current_company:p.current_company||null,experience_years:p.experience_years,bio:p.bio||null,skills:p.skills,certifications:p.certifications}).eq("user_id",t.id);if(N)throw N;O.success("Profile updated successfully!"),i(!1),r()}catch(N){console.error("Error updating profile:",N),O.error(N.message||"Failed to update profile")}finally{o(!1)}}},m=async N=>{var ue;const I=(ue=N.target.files)==null?void 0:ue[0];if(!I||!t)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(I.type)){O.error("Please upload a PDF or Word document");return}if(I.size>10*1024*1024){O.error("File size must be less than 10MB");return}v(!0);try{const D=I.name.split(".").pop(),U=`profile-${t.id}-${Date.now()}.${D}`;s!=null&&s.resume_url&&await K.storage.from("resumes").remove([s.resume_url]);const{error:f}=await K.storage.from("resumes").upload(U,I,{upsert:!0});if(f)throw f;const{error:T}=await K.from("applicant_profiles").update({resume_url:U}).eq("user_id",t.id);if(T)throw T;O.success("Resume uploaded successfully!"),r()}catch(D){console.error("Error uploading resume:",D),O.error("Failed to upload resume")}finally{v(!1)}},V=async()=>{if(!(!t||!(s!=null&&s.resume_url))){L(!0);try{await K.storage.from("resumes").remove([s.resume_url]);const{error:N}=await K.from("applicant_profiles").update({resume_url:null}).eq("user_id",t.id);if(N)throw N;O.success("Resume removed"),r()}catch(N){console.error("Error deleting resume:",N),O.error("Failed to remove resume")}finally{L(!1)}}},S=()=>{y.trim()&&!p.skills.includes(y.trim())&&(E(N=>({...N,skills:[...N.skills,y.trim()]})),F(""))},A=N=>{E(I=>({...I,skills:I.skills.filter(G=>G!==N)}))},W=()=>{h.trim()&&!p.certifications.includes(h.trim())&&(E(N=>({...N,certifications:[...N.certifications,h.trim()]})),_(""))},J=N=>{E(I=>({...I,certifications:I.certifications.filter(G=>G!==N)}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Xs,{className:"w-5 h-5"}),"Resume"]}),e.jsx(Fe,{children:"Upload your resume to auto-fill job applications"})]}),e.jsx(se,{children:s!=null&&s.resume_url?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Je,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium flex items-center gap-2",children:["Resume uploaded",e.jsx(as,{className:"w-4 h-4 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This will be used when you apply for jobs"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",id:"resume-replace",accept:".pdf,.doc,.docx",className:"hidden",onChange:m,disabled:d}),e.jsx("label",{htmlFor:"resume-replace",children:e.jsx(Y,{variant:"outline",size:"sm",disabled:d,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:d?e.jsx(ie,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(js,{className:"w-4 h-4 mr-2"}),"Replace"]})})})}),e.jsx(Y,{variant:"ghost",size:"sm",onClick:V,disabled:C,children:C?e.jsx(ie,{className:"w-4 h-4 animate-spin"}):e.jsx(ft,{className:"w-4 h-4 text-muted-foreground"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[e.jsx(Xs,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"font-medium mb-1",children:"No resume uploaded"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload your resume to speed up job applications"}),e.jsx("input",{type:"file",id:"resume-upload",accept:".pdf,.doc,.docx",className:"hidden",onChange:m,disabled:d}),e.jsx("label",{htmlFor:"resume-upload",children:e.jsx(Y,{disabled:d,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:d?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(js,{className:"w-4 h-4 mr-2"}),"Upload Resume"]})})})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"PDF or Word document, max 10MB"})]})})]}),e.jsxs(ee,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Profile Information"]}),e.jsx(Fe,{children:"Keep your profile updated to get noticed by recruiters"})]}),a?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(Y,{onClick:R,disabled:l,children:[l?e.jsx(ie,{className:"w-4 h-4 animate-spin"}):e.jsx(wr,{className:"w-4 h-4 mr-2"}),"Save"]})]}):e.jsx(Y,{onClick:()=>i(!0),children:"Edit Profile"})]}),e.jsxs(se,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"})," Full Name"]}),a?e.jsx(ce,{value:p.full_name,onChange:N=>E(I=>({...I,full_name:N.target.value})),placeholder:"Your full name"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.full_name)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xt,{className:"w-4 h-4"})," Email"]}),e.jsx("p",{className:"text-foreground",children:s==null?void 0:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(cr,{className:"w-4 h-4"})," Phone"]}),a?e.jsx(ce,{value:p.phone,onChange:N=>E(I=>({...I,phone:N.target.value})),placeholder:"Your phone number"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.phone)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ur,{className:"w-4 h-4"})," LinkedIn"]}),a?e.jsx(ce,{value:p.linkedin_url,onChange:N=>E(I=>({...I,linkedin_url:N.target.value})),placeholder:"https://linkedin.com/in/yourprofile"}):e.jsx("p",{className:"text-foreground",children:s!=null&&s.linkedin_url?e.jsx("a",{href:s.linkedin_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"View Profile"}):"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(is,{className:"w-4 h-4"})," Current Company"]}),a?e.jsx(ce,{value:p.current_company,onChange:N=>E(I=>({...I,current_company:N.target.value})),placeholder:"Your current company"}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.current_company)||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"})," Experience"]}),a?e.jsxs(Ke,{value:p.experience_years.toString(),onValueChange:N=>E(I=>({...I,experience_years:parseInt(N)})),children:[e.jsx(Qe,{children:e.jsx(Xe,{})}),e.jsx(Ze,{children:[0,1,2,3,4,5,6,7,8,9,10,15,20].map(N=>e.jsx(le,{value:N.toString(),children:N===0?"Fresh Graduate":`${N}+ years`},N))})]}):e.jsx("p",{className:"text-foreground",children:(s==null?void 0:s.experience_years)===0?"Fresh Graduate":`${s==null?void 0:s.experience_years}+ years`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"})," Bio"]}),a?e.jsx(ht,{value:p.bio,onChange:N=>E(I=>({...I,bio:N.target.value})),placeholder:"Tell us about yourself, your career goals, and what you're looking for...",rows:4}):e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:(s==null?void 0:s.bio)||"No bio provided"})]})]})]}),e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Ks,{className:"w-5 h-5"}),"Skills"]}),e.jsx(Fe,{children:"Add your technical and soft skills"})]}),e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[p.skills.map(N=>e.jsxs(Ae,{variant:"secondary",className:"text-sm py-1 px-3",children:[N,a&&e.jsx("button",{onClick:()=>A(N),className:"ml-2",children:e.jsx(gs,{className:"w-3 h-3"})})]},N)),p.skills.length===0&&!a&&e.jsx("p",{className:"text-muted-foreground",children:"No skills added yet"})]}),a&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ce,{value:y,onChange:N=>F(N.target.value),placeholder:"Add a skill (e.g., Python, Kubernetes)",onKeyPress:N=>N.key==="Enter"&&(N.preventDefault(),S())}),e.jsx(Y,{type:"button",onClick:S,variant:"outline",children:e.jsx(Gs,{className:"w-4 h-4"})})]})]})]}),e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Ks,{className:"w-5 h-5"}),"Certifications"]}),e.jsx(Fe,{children:"List your professional certifications"})]}),e.jsxs(se,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[p.certifications.map(N=>e.jsxs(Ae,{variant:"outline",className:"text-sm py-1 px-3",children:[N,a&&e.jsx("button",{onClick:()=>J(N),className:"ml-2",children:e.jsx(gs,{className:"w-3 h-3"})})]},N)),p.certifications.length===0&&!a&&e.jsx("p",{className:"text-muted-foreground",children:"No certifications added yet"})]}),a&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ce,{value:h,onChange:N=>_(N.target.value),placeholder:"Add a certification (e.g., AWS Solutions Architect)",onKeyPress:N=>N.key==="Enter"&&(N.preventDefault(),W())}),e.jsx(Y,{type:"button",onClick:W,variant:"outline",children:e.jsx(Gs,{className:"w-4 h-4"})})]})]})]})]})},Js=s=>{switch(s.toLowerCase()){case"pending":return{icon:es,color:"bg-yellow-500/10 text-yellow-600 border-yellow-500/30",label:"Under Review"};case"reviewed":return{icon:xr,color:"bg-blue-500/10 text-blue-600 border-blue-500/30",label:"Reviewed"};case"interviewed":return{icon:ge,color:"bg-purple-500/10 text-purple-600 border-purple-500/30",label:"Interview Stage"};case"hired":return{icon:as,color:"bg-green-500/10 text-green-600 border-green-500/30",label:"Hired!"};case"rejected":return{icon:hr,color:"bg-red-500/10 text-red-600 border-red-500/30",label:"Not Selected"};default:return{icon:es,color:"bg-muted text-muted-foreground",label:s}}},$r=({userId:s})=>{const[r,t]=b.useState([]),[a,i]=b.useState(!0);b.useEffect(()=>{l()},[s]);const l=async()=>{if(s)try{const{data:o,error:d}=await K.from("job_applications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(d)throw d;t(o||[])}catch(o){console.error("Error fetching applications:",o),O.error("Failed to load applications")}finally{i(!1)}};return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"w-8 h-8 animate-spin text-primary"})}):r.length===0?e.jsx(ee,{children:e.jsxs(se,{className:"py-12 text-center",children:[e.jsx(ge,{className:"w-16 h-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Applications Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't applied to any positions yet. Browse our open positions and start your journey!"}),e.jsx(er,{to:"/careers",children:e.jsxs(Y,{children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Browse Open Positions"]})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-xl font-semibold",children:["Your Applications (",r.length,")"]})}),e.jsx("div",{className:"grid gap-4",children:r.map((o,d)=>{const v=Js(o.status),C=v.icon;return e.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.1},children:e.jsx(ee,{className:"hover:shadow-md transition-shadow",children:e.jsxs(se,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(ge,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold",children:o.position}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fr,{className:"w-4 h-4"}),"Applied ",new Date(o.created_at).toLocaleDateString()]}),o.current_company&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"w-4 h-4"}),o.current_company]})]})]})]})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(Ae,{variant:"outline",className:v.color,children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),v.label]})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-border",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:["pending","reviewed","interviewed","hired"].map((L,y)=>{const F=Js(L),h=F.icon,_=["pending","reviewed","interviewed","hired"].indexOf(o.status.toLowerCase()),p=y<=_&&o.status.toLowerCase()!=="rejected",E=y===_;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${p?E?F.color:"bg-green-500/10 text-green-600":"bg-muted text-muted-foreground"}`,children:[e.jsx(h,{className:"w-3 h-3"}),F.label]}),y<3&&e.jsx("div",{className:`w-8 h-0.5 mx-1 ${y<_&&o.status.toLowerCase()!=="rejected"?"bg-green-500":"bg-muted"}`})]},L)})})})]})})},o.id)})})]})};var Ge=s=>s.type==="checkbox",Ve=s=>s instanceof Date,ne=s=>s==null;const Vt=s=>typeof s=="object";var Z=s=>!ne(s)&&!Array.isArray(s)&&Vt(s)&&!Ve(s),At=s=>Z(s)&&s.target?Ge(s.target)?s.target.checked:s.target.value:s,qr=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,Et=(s,r)=>s.has(qr(r)),Wr=s=>{const r=s.constructor&&s.constructor.prototype;return Z(r)&&r.hasOwnProperty("isPrototypeOf")},ks=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Q(s){if(s instanceof Date)return new Date(s);const r=typeof FileList<"u"&&s instanceof FileList;if(ks&&(s instanceof Blob||r))return s;const t=Array.isArray(s);if(!t&&!(Z(s)&&Wr(s)))return s;const a=t?[]:Object.create(Object.getPrototypeOf(s));for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(a[i]=Q(s[i]));return a}var ns=s=>/^\w*$/.test(s),H=s=>s===void 0,Vs=s=>Array.isArray(s)?s.filter(Boolean):[],As=s=>Vs(s.replace(/["|']|\]/g,"").split(/\.|\[/)),j=(s,r,t)=>{if(!r||!Z(s))return t;const a=(ns(r)?[r]:As(r)).reduce((i,l)=>ne(i)?i:i[l],s);return H(a)||a===s?H(s[r])?t:s[r]:a},oe=s=>typeof s=="boolean",ae=s=>typeof s=="function",q=(s,r,t)=>{let a=-1;const i=ns(r)?[r]:As(r),l=i.length,o=l-1;for(;++a<l;){const d=i[a];let v=t;if(a!==o){const C=s[d];v=Z(C)||Array.isArray(C)?C:isNaN(+i[a+1])?{}:[]}if(d==="__proto__"||d==="constructor"||d==="prototype")return;s[d]=v,s=s[d]}};const ss={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},me={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},xe={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Es=P.createContext(null);Es.displayName="HookFormControlContext";const Ps=()=>P.useContext(Es);var Pt=(s,r,t,a=!0)=>{const i={defaultValues:r._defaultValues};for(const l in s)Object.defineProperty(i,l,{get:()=>{const o=l;return r._proxyFormState[o]!==me.all&&(r._proxyFormState[o]=!a||me.all),t&&(t[o]=!0),s[o]}});return i};const Ds=typeof window<"u"?P.useLayoutEffect:P.useEffect;function Hr(s){const r=Ps(),{control:t=r,disabled:a,name:i,exact:l}=s||{},[o,d]=P.useState(t._formState),v=P.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Ds(()=>t._subscribe({name:i,formState:v.current,exact:l,callback:C=>{!a&&d({...t._formState,...C})}}),[i,a,l]),P.useEffect(()=>{v.current.isValid&&t._setValid(!0)},[t]),P.useMemo(()=>Pt(o,t,v.current,!1),[o,t])}var de=s=>typeof s=="string",vs=(s,r,t,a,i)=>de(s)?(a&&r.watch.add(s),j(t,s,i)):Array.isArray(s)?s.map(l=>(a&&r.watch.add(l),j(t,l))):(a&&(r.watchAll=!0),t),Ns=s=>ne(s)||!Vt(s);function fe(s,r,t=new WeakSet){if(Ns(s)||Ns(r))return Object.is(s,r);if(Ve(s)&&Ve(r))return Object.is(s.getTime(),r.getTime());const a=Object.keys(s),i=Object.keys(r);if(a.length!==i.length)return!1;if(t.has(s)||t.has(r))return!0;t.add(s),t.add(r);for(const l of a){const o=s[l];if(!i.includes(l))return!1;if(l!=="ref"){const d=r[l];if(Ve(o)&&Ve(d)||Z(o)&&Z(d)||Array.isArray(o)&&Array.isArray(d)?!fe(o,d,t):!Object.is(o,d))return!1}}return!0}function zr(s){const r=Ps(),{control:t=r,name:a,defaultValue:i,disabled:l,exact:o,compute:d}=s||{},v=P.useRef(i),C=P.useRef(d),L=P.useRef(void 0),y=P.useRef(t),F=P.useRef(a);C.current=d;const[h,_]=P.useState(()=>{const S=t._getWatch(a,v.current);return C.current?C.current(S):S}),p=P.useCallback(S=>{const A=vs(a,t._names,S||t._formValues,!1,v.current);return C.current?C.current(A):A},[t._formValues,t._names,a]),E=P.useCallback(S=>{if(!l){const A=vs(a,t._names,S||t._formValues,!1,v.current);if(C.current){const W=C.current(A);fe(W,L.current)||(_(W),L.current=W)}else _(A)}},[t._formValues,t._names,l,a]);Ds(()=>((y.current!==t||!fe(F.current,a))&&(y.current=t,F.current=a,E()),t._subscribe({name:a,formState:{values:!0},exact:o,callback:S=>{E(S.values)}})),[t,o,a,E]),P.useEffect(()=>t._removeUnmounted());const R=y.current!==t,m=F.current,V=P.useMemo(()=>{if(l)return null;const S=!R&&!fe(m,a);return R||S?p():null},[l,R,a,m,p]);return V!==null?V:h}function Yr(s){const r=Ps(),{name:t,disabled:a,control:i=r,shouldUnregister:l,defaultValue:o,exact:d=!0}=s,v=Et(i._names.array,t),C=P.useMemo(()=>j(i._formValues,t,j(i._defaultValues,t,o)),[i,t,o]),L=zr({control:i,name:t,defaultValue:C,exact:d}),y=Hr({control:i,name:t,exact:d}),F=P.useRef(s),h=P.useRef(void 0),_=P.useRef(i.register(t,{...s.rules,value:L,...oe(s.disabled)?{disabled:s.disabled}:{}}));F.current=s;const p=P.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!j(y.errors,t)},isDirty:{enumerable:!0,get:()=>!!j(y.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!j(y.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!j(y.validatingFields,t)},error:{enumerable:!0,get:()=>j(y.errors,t)}}),[y,t]),E=P.useCallback(S=>_.current.onChange({target:{value:At(S),name:t},type:ss.CHANGE}),[t]),R=P.useCallback(()=>_.current.onBlur({target:{value:j(i._formValues,t),name:t},type:ss.BLUR}),[t,i._formValues]),m=P.useCallback(S=>{const A=j(i._fields,t);A&&A._f&&S&&(A._f.ref={focus:()=>ae(S.focus)&&S.focus(),select:()=>ae(S.select)&&S.select(),setCustomValidity:W=>ae(S.setCustomValidity)&&S.setCustomValidity(W),reportValidity:()=>ae(S.reportValidity)&&S.reportValidity()})},[i._fields,t]),V=P.useMemo(()=>({name:t,value:L,...oe(a)||y.disabled?{disabled:y.disabled||a}:{},onChange:E,onBlur:R,ref:m}),[t,a,y.disabled,E,R,m,L]);return P.useEffect(()=>{const S=i._options.shouldUnregister||l,A=h.current;A&&A!==t&&!v&&i.unregister(A),i.register(t,{...F.current.rules,...oe(F.current.disabled)?{disabled:F.current.disabled}:{}});const W=(J,N)=>{const I=j(i._fields,J);I&&I._f&&(I._f.mount=N)};if(W(t,!0),S){const J=Q(j(i._options.defaultValues,t,F.current.defaultValue));q(i._defaultValues,t,J),H(j(i._formValues,t))&&q(i._formValues,t,J)}return!v&&i.register(t),h.current=t,()=>{(v?S&&!i._state.action:S)?i.unregister(t):W(t,!1)}},[t,i,v,l]),P.useEffect(()=>{i._setDisabledField({disabled:a,name:t})},[a,t,i]),P.useMemo(()=>({field:V,formState:y,fieldState:p}),[V,y,p])}const Gr=s=>s.render(Yr(s)),Ls=P.createContext(null);Ls.displayName="HookFormContext";const Kr=()=>P.useContext(Ls),Qr=s=>{const{children:r,watch:t,getValues:a,getFieldState:i,setError:l,clearErrors:o,setValue:d,trigger:v,formState:C,resetField:L,reset:y,handleSubmit:F,unregister:h,control:_,register:p,setFocus:E,subscribe:R}=s;return P.createElement(Ls.Provider,{value:P.useMemo(()=>({watch:t,getValues:a,getFieldState:i,setError:l,clearErrors:o,setValue:d,trigger:v,formState:C,resetField:L,reset:y,handleSubmit:F,unregister:h,control:_,register:p,setFocus:E,subscribe:R}),[o,_,C,i,a,F,p,y,L,l,E,d,R,v,h,t])},P.createElement(Es.Provider,{value:_},r))};var Dt=(s,r,t,a,i)=>r?{...t[s],types:{...t[s]&&t[s].types?t[s].types:{},[a]:i||!0}}:{},We=s=>Array.isArray(s)?s:[s],et=()=>{let s=[];return{get observers(){return s},next:i=>{for(const l of s)l.next&&l.next(i)},subscribe:i=>(s.push(i),{unsubscribe:()=>{s=s.filter(l=>l!==i)}}),unsubscribe:()=>{s=[]}}};function Lt(s,r){const t={};for(const a in s)if(s.hasOwnProperty(a)){const i=s[a],l=r[a];if(i&&Z(i)&&l){const o=Lt(i,l);Z(o)&&(t[a]=o)}else s[a]&&(t[a]=l)}return t}var re=s=>Z(s)&&!Object.keys(s).length,Is=s=>s.type==="file",ts=s=>{if(!ks)return!1;const r=s?s.ownerDocument:0;return s instanceof(r&&r.defaultView?r.defaultView.HTMLElement:HTMLElement)},It=s=>s.type==="select-multiple",Rs=s=>s.type==="radio",Xr=s=>Rs(s)||Ge(s),xs=s=>ts(s)&&s.isConnected;function Zr(s,r){const t=r.slice(0,-1).length;let a=0;for(;a<t;)s=H(s)?a++:s[r[a++]];return s}function Jr(s){for(const r in s)if(s.hasOwnProperty(r)&&!H(s[r]))return!1;return!0}function X(s,r){const t=Array.isArray(r)?r:ns(r)?[r]:As(r),a=t.length===1?s:Zr(s,t),i=t.length-1,l=t[i];return a&&delete a[l],i!==0&&(Z(a)&&re(a)||Array.isArray(a)&&Jr(a))&&X(s,t.slice(0,-1)),s}var ea=s=>{for(const r in s)if(ae(s[r]))return!0;return!1};function Rt(s){return Array.isArray(s)||Z(s)&&!ea(s)}function bs(s,r={}){for(const t in s){const a=s[t];Rt(a)?(r[t]=Array.isArray(a)?[]:{},bs(a,r[t])):H(a)||(r[t]=!0)}return r}function Ie(s,r,t){t||(t=bs(r));for(const a in s){const i=s[a];if(Rt(i))H(r)||Ns(t[a])?t[a]=bs(i,Array.isArray(i)?[]:{}):Ie(i,ne(r)?{}:r[a],t[a]);else{const l=r[a];t[a]=!fe(i,l)}}return t}const st={value:!1,isValid:!1},tt={value:!0,isValid:!0};var Ut=s=>{if(Array.isArray(s)){if(s.length>1){const r=s.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:r,isValid:!!r.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!H(s[0].attributes.value)?H(s[0].value)||s[0].value===""?tt:{value:s[0].value,isValid:!0}:tt:st}return st},Tt=(s,{valueAsNumber:r,valueAsDate:t,setValueAs:a})=>H(s)?s:r?s===""?NaN:s&&+s:t&&de(s)?new Date(s):a?a(s):s;const rt={isValid:!1,value:null};var Mt=s=>Array.isArray(s)?s.reduce((r,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:r,rt):rt;function at(s){const r=s.ref;return Is(r)?r.files:Rs(r)?Mt(s.refs).value:It(r)?[...r.selectedOptions].map(({value:t})=>t):Ge(r)?Ut(s.refs).value:Tt(H(r.value)?s.ref.value:r.value,s)}var sa=(s,r,t,a)=>{const i={};for(const l of s){const o=j(r,l);o&&q(i,l,o._f)}return{criteriaMode:t,names:[...s],fields:i,shouldUseNativeValidation:a}},rs=s=>s instanceof RegExp,$e=s=>H(s)?s:rs(s)?s.source:Z(s)?rs(s.value)?s.value.source:s.value:s,it=s=>({isOnSubmit:!s||s===me.onSubmit,isOnBlur:s===me.onBlur,isOnChange:s===me.onChange,isOnAll:s===me.all,isOnTouch:s===me.onTouched});const nt="AsyncFunction";var ta=s=>!!s&&!!s.validate&&!!(ae(s.validate)&&s.validate.constructor.name===nt||Z(s.validate)&&Object.values(s.validate).find(r=>r.constructor.name===nt)),ra=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),lt=(s,r,t)=>!t&&(r.watchAll||r.watch.has(s)||[...r.watch].some(a=>s.startsWith(a)&&/^\.\w+/.test(s.slice(a.length))));const He=(s,r,t,a)=>{for(const i of t||Object.keys(s)){const l=j(s,i);if(l){const{_f:o,...d}=l;if(o){if(o.refs&&o.refs[0]&&r(o.refs[0],i)&&!a)return!0;if(o.ref&&r(o.ref,o.name)&&!a)return!0;if(He(d,r))break}else if(Z(d)&&He(d,r))break}}};function ot(s,r,t){const a=j(s,t);if(a||ns(t))return{error:a,name:t};const i=t.split(".");for(;i.length;){const l=i.join("."),o=j(r,l),d=j(s,l);if(o&&!Array.isArray(o)&&t!==l)return{name:t};if(d&&d.type)return{name:l,error:d};if(d&&d.root&&d.root.type)return{name:`${l}.root`,error:d.root};i.pop()}return{name:t}}var aa=(s,r,t,a)=>{t(s);const{name:i,...l}=s;return re(l)||Object.keys(l).length>=Object.keys(r).length||Object.keys(l).find(o=>r[o]===(!a||me.all))},ia=(s,r,t)=>!s||!r||s===r||We(s).some(a=>a&&(t?a===r:a.startsWith(r)||r.startsWith(a))),na=(s,r,t,a,i)=>i.isOnAll?!1:!t&&i.isOnTouch?!(r||s):(t?a.isOnBlur:i.isOnBlur)?!s:(t?a.isOnChange:i.isOnChange)?s:!0,la=(s,r)=>!Vs(j(s,r)).length&&X(s,r),oa=(s,r,t)=>{const a=We(j(s,t));return q(a,"root",r[t]),q(s,t,a),s};function ct(s,r,t="validate"){if(de(s)||Array.isArray(s)&&s.every(de)||oe(s)&&!s)return{type:t,message:de(s)?s:"",ref:r}}var De=s=>Z(s)&&!rs(s)?s:{value:s,message:""},dt=async(s,r,t,a,i,l)=>{const{ref:o,refs:d,required:v,maxLength:C,minLength:L,min:y,max:F,pattern:h,validate:_,name:p,valueAsNumber:E,mount:R}=s._f,m=j(t,p);if(!R||r.has(p))return{};const V=d?d[0]:o,S=D=>{i&&V.reportValidity&&(V.setCustomValidity(oe(D)?"":D||""),V.reportValidity())},A={},W=Rs(o),J=Ge(o),N=W||J,I=(E||Is(o))&&H(o.value)&&H(m)||ts(o)&&o.value===""||m===""||Array.isArray(m)&&!m.length,G=Dt.bind(null,p,a,A),ue=(D,U,f,T=xe.maxLength,M=xe.minLength)=>{const z=D?U:f;A[p]={type:D?T:M,message:z,ref:o,...G(D?T:M,z)}};if(l?!Array.isArray(m)||!m.length:v&&(!N&&(I||ne(m))||oe(m)&&!m||J&&!Ut(d).isValid||W&&!Mt(d).isValid)){const{value:D,message:U}=de(v)?{value:!!v,message:v}:De(v);if(D&&(A[p]={type:xe.required,message:U,ref:V,...G(xe.required,U)},!a))return S(U),A}if(!I&&(!ne(y)||!ne(F))){let D,U;const f=De(F),T=De(y);if(!ne(m)&&!isNaN(m)){const M=o.valueAsNumber||m&&+m;ne(f.value)||(D=M>f.value),ne(T.value)||(U=M<T.value)}else{const M=o.valueAsDate||new Date(m),z=Me=>new Date(new Date().toDateString()+" "+Me),_e=o.type=="time",Te=o.type=="week";de(f.value)&&m&&(D=_e?z(m)>z(f.value):Te?m>f.value:M>new Date(f.value)),de(T.value)&&m&&(U=_e?z(m)<z(T.value):Te?m<T.value:M<new Date(T.value))}if((D||U)&&(ue(!!D,f.message,T.message,xe.max,xe.min),!a))return S(A[p].message),A}if((C||L)&&!I&&(de(m)||l&&Array.isArray(m))){const D=De(C),U=De(L),f=!ne(D.value)&&m.length>+D.value,T=!ne(U.value)&&m.length<+U.value;if((f||T)&&(ue(f,D.message,U.message),!a))return S(A[p].message),A}if(h&&!I&&de(m)){const{value:D,message:U}=De(h);if(rs(D)&&!m.match(D)&&(A[p]={type:xe.pattern,message:U,ref:o,...G(xe.pattern,U)},!a))return S(U),A}if(_){if(ae(_)){const D=await _(m,t),U=ct(D,V);if(U&&(A[p]={...U,...G(xe.validate,U.message)},!a))return S(U.message),A}else if(Z(_)){let D={};for(const U in _){if(!re(D)&&!a)break;const f=ct(await _[U](m,t),V,U);f&&(D={...f,...G(U,f.message)},S(f.message),a&&(A[p]=D))}if(!re(D)&&(A[p]={ref:V,...D},!a))return A}}return S(!0),A};const ca={mode:me.onSubmit,reValidateMode:me.onChange,shouldFocusError:!0};function da(s={}){let r={...ca,...s},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ae(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},i=Z(r.defaultValues)||Z(r.values)?Q(r.defaultValues||r.values)||{}:{},l=r.shouldUnregister?{}:Q(i),o={action:!1,mount:!1,watch:!1,keepIsValid:!1},d={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},v,C=0;const L={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},y={...L};let F={...y};const h={array:et(),state:et()},_=r.criteriaMode===me.all,p=n=>c=>{clearTimeout(C),C=setTimeout(n,c)},E=async n=>{if(!o.keepIsValid&&!r.disabled&&(y.isValid||F.isValid||n)){let c;r.resolver?(c=re((await N()).errors),R()):c=await G(a,!0),c!==t.isValid&&h.state.next({isValid:c})}},R=(n,c)=>{!r.disabled&&(y.isValidating||y.validatingFields||F.isValidating||F.validatingFields)&&((n||Array.from(d.mount)).forEach(u=>{u&&(c?q(t.validatingFields,u,c):X(t.validatingFields,u))}),h.state.next({validatingFields:t.validatingFields,isValidating:!re(t.validatingFields)}))},m=(n,c=[],u,w,g=!0,x=!0)=>{if(w&&u&&!r.disabled){if(o.action=!0,x&&Array.isArray(j(a,n))){const k=u(j(a,n),w.argA,w.argB);g&&q(a,n,k)}if(x&&Array.isArray(j(t.errors,n))){const k=u(j(t.errors,n),w.argA,w.argB);g&&q(t.errors,n,k),la(t.errors,n)}if((y.touchedFields||F.touchedFields)&&x&&Array.isArray(j(t.touchedFields,n))){const k=u(j(t.touchedFields,n),w.argA,w.argB);g&&q(t.touchedFields,n,k)}(y.dirtyFields||F.dirtyFields)&&(t.dirtyFields=Ie(i,l)),h.state.next({name:n,isDirty:D(n,c),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else q(l,n,c)},V=(n,c)=>{q(t.errors,n,c),h.state.next({errors:t.errors})},S=n=>{t.errors=n,h.state.next({errors:t.errors,isValid:!1})},A=(n,c,u,w)=>{const g=j(a,n);if(g){const x=j(l,n,H(u)?j(i,n):u);H(x)||w&&w.defaultChecked||c?q(l,n,c?x:at(g._f)):T(n,x),o.mount&&!o.action&&E()}},W=(n,c,u,w,g)=>{let x=!1,k=!1;const B={name:n};if(!r.disabled){if(!u||w){(y.isDirty||F.isDirty)&&(k=t.isDirty,t.isDirty=B.isDirty=D(),x=k!==B.isDirty);const $=fe(j(i,n),c);k=!!j(t.dirtyFields,n),$?X(t.dirtyFields,n):q(t.dirtyFields,n,!0),B.dirtyFields=t.dirtyFields,x=x||(y.dirtyFields||F.dirtyFields)&&k!==!$}if(u){const $=j(t.touchedFields,n);$||(q(t.touchedFields,n,u),B.touchedFields=t.touchedFields,x=x||(y.touchedFields||F.touchedFields)&&$!==u)}x&&g&&h.state.next(B)}return x?B:{}},J=(n,c,u,w)=>{const g=j(t.errors,n),x=(y.isValid||F.isValid)&&oe(c)&&t.isValid!==c;if(r.delayError&&u?(v=p(()=>V(n,u)),v(r.delayError)):(clearTimeout(C),v=null,u?q(t.errors,n,u):X(t.errors,n)),(u?!fe(g,u):g)||!re(w)||x){const k={...w,...x&&oe(c)?{isValid:c}:{},errors:t.errors,name:n};t={...t,...k},h.state.next(k)}},N=async n=>(R(n,!0),await r.resolver(l,r.context,sa(n||d.mount,a,r.criteriaMode,r.shouldUseNativeValidation))),I=async n=>{const{errors:c}=await N(n);if(R(n),n)for(const u of n){const w=j(c,u);w?q(t.errors,u,w):X(t.errors,u)}else t.errors=c;return c},G=async(n,c,u={valid:!0})=>{for(const w in n){const g=n[w];if(g){const{_f:x,...k}=g;if(x){const B=d.array.has(x.name),$=g._f&&ta(g._f);$&&y.validatingFields&&R([x.name],!0);const te=await dt(g,d.disabled,l,_,r.shouldUseNativeValidation&&!c,B);if($&&y.validatingFields&&R([x.name]),te[x.name]&&(u.valid=!1,c||s.shouldUseNativeValidation))break;!c&&(j(te,x.name)?B?oa(t.errors,te,x.name):q(t.errors,x.name,te[x.name]):X(t.errors,x.name))}!re(k)&&await G(k,c,u)}}return u.valid},ue=()=>{for(const n of d.unMount){const c=j(a,n);c&&(c._f.refs?c._f.refs.every(u=>!xs(u)):!xs(c._f.ref))&&os(n)}d.unMount=new Set},D=(n,c)=>!r.disabled&&(n&&c&&q(l,n,c),!fe(Us(),i)),U=(n,c,u)=>vs(n,d,{...o.mount?l:H(c)?i:de(n)?{[n]:c}:c},u,c),f=n=>Vs(j(o.mount?l:i,n,r.shouldUnregister?j(i,n,[]):[])),T=(n,c,u={})=>{const w=j(a,n);let g=c;if(w){const x=w._f;x&&(!x.disabled&&q(l,n,Tt(c,x)),g=ts(x.ref)&&ne(c)?"":c,It(x.ref)?[...x.ref.options].forEach(k=>k.selected=g.includes(k.value)):x.refs?Ge(x.ref)?x.refs.forEach(k=>{(!k.defaultChecked||!k.disabled)&&(Array.isArray(g)?k.checked=!!g.find(B=>B===k.value):k.checked=g===k.value||!!g)}):x.refs.forEach(k=>k.checked=k.value===g):Is(x.ref)?x.ref.value="":(x.ref.value=g,x.ref.type||h.state.next({name:n,values:Q(l)})))}(u.shouldDirty||u.shouldTouch)&&W(n,g,u.shouldTouch,u.shouldDirty,!0),u.shouldValidate&&Me(n)},M=(n,c,u)=>{for(const w in c){if(!c.hasOwnProperty(w))return;const g=c[w],x=n+"."+w,k=j(a,x);(d.array.has(n)||Z(g)||k&&!k._f)&&!Ve(g)?M(x,g,u):T(x,g,u)}},z=(n,c,u={})=>{const w=j(a,n),g=d.array.has(n),x=Q(c);q(l,n,x),g?(h.array.next({name:n,values:Q(l)}),(y.isDirty||y.dirtyFields||F.isDirty||F.dirtyFields)&&u.shouldDirty&&h.state.next({name:n,dirtyFields:Ie(i,l),isDirty:D(n,x)})):w&&!w._f&&!ne(x)?M(n,x,u):T(n,x,u),lt(n,d)?h.state.next({...t,name:n,values:Q(l)}):h.state.next({name:o.mount?n:void 0,values:Q(l)})},_e=async n=>{o.mount=!0;const c=n.target;let u=c.name,w=!0;const g=j(a,u),x=$=>{w=Number.isNaN($)||Ve($)&&isNaN($.getTime())||fe($,j(l,u,$))},k=it(r.mode),B=it(r.reValidateMode);if(g){let $,te;const Se=c.type?at(g._f):At(n),ye=n.type===ss.BLUR||n.type===ss.FOCUS_OUT,Qt=!ra(g._f)&&!r.resolver&&!j(t.errors,u)&&!g._f.deps||na(ye,j(t.touchedFields,u),t.isSubmitted,B,k),us=lt(u,d,ye);q(l,u,Se),ye?(!c||!c.readOnly)&&(g._f.onBlur&&g._f.onBlur(n),v&&v(0)):g._f.onChange&&g._f.onChange(n);const ms=W(u,Se,ye),Xt=!re(ms)||us;if(!ye&&h.state.next({name:u,type:n.type,values:Q(l)}),Qt)return(y.isValid||F.isValid)&&(r.mode==="onBlur"?ye&&E():ye||E()),Xt&&h.state.next({name:u,...us?{}:ms});if(!ye&&us&&h.state.next({...t}),r.resolver){const{errors:zs}=await N([u]);if(R([u]),x(Se),w){const Zt=ot(t.errors,a,u),Ys=ot(zs,a,Zt.name||u);$=Ys.error,u=Ys.name,te=re(zs)}}else R([u],!0),$=(await dt(g,d.disabled,l,_,r.shouldUseNativeValidation))[u],R([u]),x(Se),w&&($?te=!1:(y.isValid||F.isValid)&&(te=await G(a,!0)));w&&(g._f.deps&&(!Array.isArray(g._f.deps)||g._f.deps.length>0)&&Me(g._f.deps),J(u,te,$,ms))}},Te=(n,c)=>{if(j(t.errors,c)&&n.focus)return n.focus(),1},Me=async(n,c={})=>{let u,w;const g=We(n);if(r.resolver){const x=await I(H(n)?n:g);u=re(x),w=n?!g.some(k=>j(x,k)):u}else n?(w=(await Promise.all(g.map(async x=>{const k=j(a,x);return await G(k&&k._f?{[x]:k}:k)}))).every(Boolean),!(!w&&!t.isValid)&&E()):w=u=await G(a);return h.state.next({...!de(n)||(y.isValid||F.isValid)&&u!==t.isValid?{}:{name:n},...r.resolver||!n?{isValid:u}:{},errors:t.errors}),c.shouldFocus&&!w&&He(a,Te,n?g:d.mount),w},Us=(n,c)=>{let u={...o.mount?l:i};return c&&(u=Lt(c.dirtyFields?t.dirtyFields:t.touchedFields,u)),H(n)?u:de(n)?j(u,n):n.map(w=>j(u,w))},Ts=(n,c)=>({invalid:!!j((c||t).errors,n),isDirty:!!j((c||t).dirtyFields,n),error:j((c||t).errors,n),isValidating:!!j(t.validatingFields,n),isTouched:!!j((c||t).touchedFields,n)}),qt=n=>{n&&We(n).forEach(c=>X(t.errors,c)),h.state.next({errors:n?t.errors:{}})},Ms=(n,c,u)=>{const w=(j(a,n,{_f:{}})._f||{}).ref,g=j(t.errors,n)||{},{ref:x,message:k,type:B,...$}=g;q(t.errors,n,{...$,...c,ref:w}),h.state.next({name:n,errors:t.errors,isValid:!1}),u&&u.shouldFocus&&w&&w.focus&&w.focus()},Wt=(n,c)=>ae(n)?h.state.subscribe({next:u=>"values"in u&&n(U(void 0,c),u)}):U(n,c,!0),Os=n=>h.state.subscribe({next:c=>{ia(n.name,c.name,n.exact)&&aa(c,n.formState||y,Kt,n.reRenderRoot)&&n.callback({values:{...l},...t,...c,defaultValues:i})}}).unsubscribe,Ht=n=>(o.mount=!0,F={...F,...n.formState},Os({...n,formState:{...L,...n.formState}})),os=(n,c={})=>{for(const u of n?We(n):d.mount)d.mount.delete(u),d.array.delete(u),c.keepValue||(X(a,u),X(l,u)),!c.keepError&&X(t.errors,u),!c.keepDirty&&X(t.dirtyFields,u),!c.keepTouched&&X(t.touchedFields,u),!c.keepIsValidating&&X(t.validatingFields,u),!r.shouldUnregister&&!c.keepDefaultValue&&X(i,u);h.state.next({values:Q(l)}),h.state.next({...t,...c.keepDirty?{isDirty:D()}:{}}),!c.keepIsValid&&E()},Bs=({disabled:n,name:c})=>{if(oe(n)&&o.mount||n||d.disabled.has(c)){const g=d.disabled.has(c)!==!!n;n?d.disabled.add(c):d.disabled.delete(c),g&&o.mount&&!o.action&&E()}},cs=(n,c={})=>{let u=j(a,n);const w=oe(c.disabled)||oe(r.disabled);return q(a,n,{...u||{},_f:{...u&&u._f?u._f:{ref:{name:n}},name:n,mount:!0,...c}}),d.mount.add(n),u?Bs({disabled:oe(c.disabled)?c.disabled:r.disabled,name:n}):A(n,!0,c.value),{...w?{disabled:c.disabled||r.disabled}:{},...r.progressive?{required:!!c.required,min:$e(c.min),max:$e(c.max),minLength:$e(c.minLength),maxLength:$e(c.maxLength),pattern:$e(c.pattern)}:{},name:n,onChange:_e,onBlur:_e,ref:g=>{if(g){cs(n,c),u=j(a,n);const x=H(g.value)&&g.querySelectorAll&&g.querySelectorAll("input,select,textarea")[0]||g,k=Xr(x),B=u._f.refs||[];if(k?B.find($=>$===x):x===u._f.ref)return;q(a,n,{_f:{...u._f,...k?{refs:[...B.filter(xs),x,...Array.isArray(j(i,n))?[{}]:[]],ref:{type:x.type,name:n}}:{ref:x}}}),A(n,!1,void 0,x)}else u=j(a,n,{}),u._f&&(u._f.mount=!1),(r.shouldUnregister||c.shouldUnregister)&&!(Et(d.array,n)&&o.action)&&d.unMount.add(n)}}},ds=()=>r.shouldFocusError&&He(a,Te,d.mount),zt=n=>{oe(n)&&(h.state.next({disabled:n}),He(a,(c,u)=>{const w=j(a,u);w&&(c.disabled=w._f.disabled||n,Array.isArray(w._f.refs)&&w._f.refs.forEach(g=>{g.disabled=w._f.disabled||n}))},0,!1))},$s=(n,c)=>async u=>{let w;u&&(u.preventDefault&&u.preventDefault(),u.persist&&u.persist());let g=Q(l);if(h.state.next({isSubmitting:!0}),r.resolver){const{errors:x,values:k}=await N();R(),t.errors=x,g=Q(k)}else await G(a);if(d.disabled.size)for(const x of d.disabled)X(g,x);if(X(t.errors,"root"),re(t.errors)){h.state.next({errors:{}});try{await n(g,u)}catch(x){w=x}}else c&&await c({...t.errors},u),ds(),setTimeout(ds);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:re(t.errors)&&!w,submitCount:t.submitCount+1,errors:t.errors}),w)throw w},Yt=(n,c={})=>{j(a,n)&&(H(c.defaultValue)?z(n,Q(j(i,n))):(z(n,c.defaultValue),q(i,n,Q(c.defaultValue))),c.keepTouched||X(t.touchedFields,n),c.keepDirty||(X(t.dirtyFields,n),t.isDirty=c.defaultValue?D(n,Q(j(i,n))):D()),c.keepError||(X(t.errors,n),y.isValid&&E()),h.state.next({...t}))},qs=(n,c={})=>{const u=n?Q(n):i,w=Q(u),g=re(n),x=g?i:w;if(c.keepDefaultValues||(i=u),!c.keepValues){if(c.keepDirtyValues){const k=new Set([...d.mount,...Object.keys(Ie(i,l))]);for(const B of Array.from(k)){const $=j(t.dirtyFields,B),te=j(l,B),Se=j(x,B);$&&!H(te)?q(x,B,te):!$&&!H(Se)&&z(B,Se)}}else{if(ks&&H(n))for(const k of d.mount){const B=j(a,k);if(B&&B._f){const $=Array.isArray(B._f.refs)?B._f.refs[0]:B._f.ref;if(ts($)){const te=$.closest("form");if(te){te.reset();break}}}}if(c.keepFieldsRef)for(const k of d.mount)z(k,j(x,k));else a={}}l=r.shouldUnregister?c.keepDefaultValues?Q(i):{}:Q(x),h.array.next({values:{...x}}),h.state.next({values:{...x}})}d={mount:c.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!y.isValid||!!c.keepIsValid||!!c.keepDirtyValues||!r.shouldUnregister&&!re(x),o.watch=!!r.shouldUnregister,o.keepIsValid=!!c.keepIsValid,o.action=!1,c.keepErrors||(t.errors={}),h.state.next({submitCount:c.keepSubmitCount?t.submitCount:0,isDirty:g?!1:c.keepDirty?t.isDirty:!!(c.keepDefaultValues&&!fe(n,i)),isSubmitted:c.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:g?{}:c.keepDirtyValues?c.keepDefaultValues&&l?Ie(i,l):t.dirtyFields:c.keepDefaultValues&&n?Ie(i,n):c.keepDirty?t.dirtyFields:{},touchedFields:c.keepTouched?t.touchedFields:{},errors:c.keepErrors?t.errors:{},isSubmitSuccessful:c.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},Ws=(n,c)=>qs(ae(n)?n(l):n,{...r.resetOptions,...c}),Gt=(n,c={})=>{const u=j(a,n),w=u&&u._f;if(w){const g=w.refs?w.refs[0]:w.ref;g.focus&&setTimeout(()=>{g.focus(),c.shouldSelect&&ae(g.select)&&g.select()})}},Kt=n=>{t={...t,...n}},Hs={control:{register:cs,unregister:os,getFieldState:Ts,handleSubmit:$s,setError:Ms,_subscribe:Os,_runSchema:N,_updateIsValidating:R,_focusError:ds,_getWatch:U,_getDirty:D,_setValid:E,_setFieldArray:m,_setDisabledField:Bs,_setErrors:S,_getFieldArray:f,_reset:qs,_resetDefaultValues:()=>ae(r.defaultValues)&&r.defaultValues().then(n=>{Ws(n,r.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:ue,_disableForm:zt,_subjects:h,_proxyFormState:y,get _fields(){return a},get _formValues(){return l},get _state(){return o},set _state(n){o=n},get _defaultValues(){return i},get _names(){return d},set _names(n){d=n},get _formState(){return t},get _options(){return r},set _options(n){r={...r,...n}}},subscribe:Ht,trigger:Me,register:cs,handleSubmit:$s,watch:Wt,setValue:z,getValues:Us,reset:Ws,resetField:Yt,clearErrors:qt,unregister:os,setError:Ms,setFocus:Gt,getFieldState:Ts};return{...Hs,formControl:Hs}}function ua(s={}){const r=P.useRef(void 0),t=P.useRef(void 0),[a,i]=P.useState({isDirty:!1,isValidating:!1,isLoading:ae(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:ae(s.defaultValues)?void 0:s.defaultValues});if(!r.current)if(s.formControl)r.current={...s.formControl,formState:a},s.defaultValues&&!ae(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...d}=da(s);r.current={...d,formState:a}}const l=r.current.control;return l._options=s,Ds(()=>{const o=l._subscribe({formState:l._proxyFormState,callback:()=>i({...l._formState}),reRenderRoot:!0});return i(d=>({...d,isReady:!0})),l._formState.isReady=!0,o},[l]),P.useEffect(()=>l._disableForm(s.disabled),[l,s.disabled]),P.useEffect(()=>{s.mode&&(l._options.mode=s.mode),s.reValidateMode&&(l._options.reValidateMode=s.reValidateMode)},[l,s.mode,s.reValidateMode]),P.useEffect(()=>{s.errors&&(l._setErrors(s.errors),l._focusError())},[l,s.errors]),P.useEffect(()=>{s.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,s.shouldUnregister]),P.useEffect(()=>{if(l._proxyFormState.isDirty){const o=l._getDirty();o!==a.isDirty&&l._subjects.state.next({isDirty:o})}},[l,a.isDirty]),P.useEffect(()=>{var o;s.values&&!fe(s.values,t.current)?(l._reset(s.values,{keepFieldsRef:!0,...l._options.resetOptions}),!((o=l._options.resetOptions)===null||o===void 0)&&o.keepIsValid||l._setValid(),t.current=s.values,i(d=>({...d}))):l._resetDefaultValues()},[l,s.values]),P.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),r.current.formState=P.useMemo(()=>Pt(a,l),[l,a]),r.current}const ut=(s,r,t)=>{if(s&&"reportValidity"in s){const a=j(t,r);s.setCustomValidity(a&&a.message||""),s.reportValidity()}},Ot=(s,r)=>{for(const t in r.fields){const a=r.fields[t];a&&a.ref&&"reportValidity"in a.ref?ut(a.ref,t,s):a.refs&&a.refs.forEach(i=>ut(i,t,s))}},ma=(s,r)=>{r.shouldUseNativeValidation&&Ot(s,r);const t={};for(const a in s){const i=j(r.fields,a),l=Object.assign(s[a]||{},{ref:i&&i.ref});if(fa(r.names||Object.keys(s),a)){const o=Object.assign({},j(t,a));q(o,"root",l),q(t,a,o)}else q(t,a,l)}return t},fa=(s,r)=>s.some(t=>t.startsWith(r+"."));var ha=function(s,r){for(var t={};s.length;){var a=s[0],i=a.code,l=a.message,o=a.path.join(".");if(!t[o])if("unionErrors"in a){var d=a.unionErrors[0].errors[0];t[o]={message:d.message,type:d.code}}else t[o]={message:l,type:i};if("unionErrors"in a&&a.unionErrors.forEach(function(L){return L.errors.forEach(function(y){return s.push(y)})}),r){var v=t[o].types,C=v&&v[a.code];t[o]=Dt(o,r,t,i,C?[].concat(C,a.message):a.message)}s.shift()}return t},xa=function(s,r,t){return t===void 0&&(t={}),function(a,i,l){try{return Promise.resolve(function(o,d){try{var v=Promise.resolve(s[t.mode==="sync"?"parse":"parseAsync"](a,r)).then(function(C){return l.shouldUseNativeValidation&&Ot({},l),{errors:{},values:t.raw?a:C}})}catch(C){return d(C)}return v&&v.then?v.then(void 0,d):v}(0,function(o){if(function(d){return Array.isArray(d==null?void 0:d.errors)}(o))return{values:{},errors:ma(ha(o.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw o}))}catch(o){return Promise.reject(o)}}};const pa=Qr,Bt=b.createContext({}),Ce=({...s})=>e.jsx(Bt.Provider,{value:{name:s.name},children:e.jsx(Gr,{...s})}),ls=()=>{const s=b.useContext(Bt),r=b.useContext($t),{getFieldState:t,formState:a}=Kr(),i=t(s.name,a);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:l}=r;return{id:l,name:s.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...i}},$t=b.createContext({}),je=b.forwardRef(({className:s,...r},t)=>{const a=b.useId();return e.jsx($t.Provider,{value:{id:a},children:e.jsx("div",{ref:t,className:Pe("space-y-2",s),...r})})});je.displayName="FormItem";const pe=b.forwardRef(({className:s,...r},t)=>{const{error:a,formItemId:i}=ls();return e.jsx(qe,{ref:t,className:Pe(a&&"text-destructive",s),htmlFor:i,...r})});pe.displayName="FormLabel";const ve=b.forwardRef(({...s},r)=>{const{error:t,formItemId:a,formDescriptionId:i,formMessageId:l}=ls();return e.jsx(sr,{ref:r,id:a,"aria-describedby":t?`${i} ${l}`:`${i}`,"aria-invalid":!!t,...s})});ve.displayName="FormControl";const ga=b.forwardRef(({className:s,...r},t)=>{const{formDescriptionId:a}=ls();return e.jsx("p",{ref:t,id:a,className:Pe("text-sm text-muted-foreground",s),...r})});ga.displayName="FormDescription";const Ne=b.forwardRef(({className:s,children:r,...t},a)=>{const{error:i,formMessageId:l}=ls(),o=i?String(i==null?void 0:i.message):r;return o?e.jsx("p",{ref:a,id:l,className:Pe("text-sm font-medium text-destructive",s),...t,children:o}):null});Ne.displayName="FormMessage";const ya=gr({fullName:he().min(2,"Name must be at least 2 characters").max(100,"Name is too long"),email:he().email("Please enter a valid email"),phone:he().min(10,"Please enter a valid phone number"),position:he().min(1,"Please select a position"),positionId:he().min(1,"Position ID is required"),experienceYears:he().min(1,"Please select your experience"),currentCompany:he().optional(),linkedinUrl:he().url("Please enter a valid URL").optional().or(yr("")),coverLetter:he().max(2e3,"Cover letter is too long").optional()}),ja=({position:s,onClose:r,onSuccess:t})=>{const{user:a}=Ue(),[i,l]=b.useState(null),[o,d]=b.useState(null),[v,C]=b.useState(!1),[L,y]=b.useState(!1),[F,h]=b.useState(!0),_=ua({resolver:xa(ya),defaultValues:{fullName:"",email:(a==null?void 0:a.email)||"",phone:"",position:s.title,positionId:s.id,experienceYears:"",currentCompany:"",linkedinUrl:"",coverLetter:""}});b.useEffect(()=>{a&&p()},[a]);const p=async()=>{if(a){h(!0);try{const{data:m,error:V}=await K.from("applicant_profiles").select("*").eq("user_id",a.id).maybeSingle();if(V)throw V;m&&(m.full_name&&_.setValue("fullName",m.full_name),m.phone&&_.setValue("phone",m.phone),m.linkedin_url&&_.setValue("linkedinUrl",m.linkedin_url),m.current_company&&_.setValue("currentCompany",m.current_company),m.experience_years!==null&&m.experience_years!==void 0&&_.setValue("experienceYears",m.experience_years.toString()),m.resume_url&&(d(m.resume_url),C(!0)))}catch(m){console.error("Error fetching profile:",m)}finally{h(!1)}}},E=m=>{var S;const V=(S=m.target.files)==null?void 0:S[0];if(V){if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(V.type)){O.error("Please upload a PDF or Word document");return}if(V.size>10*1024*1024){O.error("File size must be less than 10MB");return}l(V),C(!1)}},R=async m=>{if(!i&&!v){O.error("Please upload your resume");return}y(!0);try{let V;if(v&&o){const A=`${m.positionId}-${Date.now()}-${m.fullName.replace(/\s+/g,"-").toLowerCase()}-profile`,{error:W}=await K.storage.from("resumes").copy(o,A);V=W?o:A}else if(i){const A=i.name.split(".").pop();V=`${m.positionId}-${Date.now()}-${m.fullName.replace(/\s+/g,"-").toLowerCase()}.${A}`;const{error:W}=await K.storage.from("resumes").upload(V,i);if(W)throw W}else{O.error("Please upload your resume"),y(!1);return}const{error:S}=await K.from("job_applications").insert({full_name:m.fullName,email:m.email,phone:m.phone,position:`${m.position} (${m.positionId})`,experience_years:parseInt(m.experienceYears),current_company:m.currentCompany||null,linkedin_url:m.linkedinUrl||null,cover_letter:m.coverLetter||null,resume_url:V,user_id:a==null?void 0:a.id});if(S)throw S;await K.functions.invoke("send-notification",{body:{type:"job_application",data:{fullName:m.fullName,email:m.email,phone:m.phone,position:`${m.position} (${m.positionId})`,experienceYears:m.experienceYears,currentCompany:m.currentCompany,linkedinUrl:m.linkedinUrl}}}),O.success("Application submitted successfully!"),t()}catch(V){console.error("Error submitting application:",V),O.error("Failed to submit application. Please try again.")}finally{y(!1)}};return F?e.jsx(ee,{children:e.jsx(se,{className:"py-12 flex items-center justify-center",children:e.jsx(ie,{className:"w-8 h-8 animate-spin text-primary"})})}):e.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsxs(ee,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsxs(we,{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Je,{className:"w-5 h-5 text-primary"})}),"Apply for ",s.title]}),e.jsx(Y,{variant:"ghost",size:"icon",onClick:r,children:e.jsx(gs,{className:"w-5 h-5"})})]}),e.jsx(se,{children:e.jsx(pa,{..._,children:e.jsxs("form",{onSubmit:_.handleSubmit(R),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(Ce,{control:_.control,name:"fullName",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Full Name *"}),e.jsx(ve,{children:e.jsx(ce,{placeholder:"Your full name",...m})}),e.jsx(Ne,{})]})}),e.jsx(Ce,{control:_.control,name:"email",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Email *"}),e.jsx(ve,{children:e.jsx(ce,{type:"email",placeholder:"you@example.com",...m,disabled:!0})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(Ce,{control:_.control,name:"phone",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Phone Number *"}),e.jsx(ve,{children:e.jsx(pr,{value:m.value,onChange:m.onChange,defaultCountry:"NP"})}),e.jsx(Ne,{})]})}),e.jsx(Ce,{control:_.control,name:"experienceYears",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Years of Experience *"}),e.jsxs(Ke,{onValueChange:m.onChange,value:m.value,children:[e.jsx(ve,{children:e.jsx(Qe,{children:e.jsx(Xe,{placeholder:"Select experience"})})}),e.jsxs(Ze,{children:[e.jsx(le,{value:"0",children:"Fresher (0 years)"}),e.jsx(le,{value:"1",children:"1 year"}),e.jsx(le,{value:"2",children:"2 years"}),e.jsx(le,{value:"3",children:"3 years"}),e.jsx(le,{value:"4",children:"4 years"}),e.jsx(le,{value:"5",children:"5+ years"}),e.jsx(le,{value:"7",children:"7+ years"}),e.jsx(le,{value:"10",children:"10+ years"})]})]}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(Ce,{control:_.control,name:"currentCompany",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Current Company"}),e.jsx(ve,{children:e.jsx(ce,{placeholder:"Your current employer",...m})}),e.jsx(Ne,{})]})}),e.jsx(Ce,{control:_.control,name:"linkedinUrl",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"LinkedIn Profile"}),e.jsx(ve,{children:e.jsx(ce,{placeholder:"https://linkedin.com/in/yourprofile",...m})}),e.jsx(Ne,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(pe,{children:"Resume *"}),o&&e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[e.jsx(tr,{id:"useProfileResume",checked:v,onCheckedChange:m=>{C(m),m&&l(null)}}),e.jsxs("label",{htmlFor:"useProfileResume",className:"text-sm flex items-center gap-2 cursor-pointer flex-1",children:[e.jsx(Je,{className:"w-4 h-4 text-primary"}),"Use resume from my profile"]}),v&&e.jsx(as,{className:"w-4 h-4 text-primary"})]}),!v&&e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center hover:border-primary/50 transition-colors",children:[e.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:E,className:"hidden",id:"resume-upload"}),e.jsxs("label",{htmlFor:"resume-upload",className:"cursor-pointer",children:[e.jsx(js,{className:"w-10 h-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?e.jsx("span",{className:"text-primary font-medium",children:i.name}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-primary font-medium",children:"Click to upload"})," or drag and drop"]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PDF or Word (max 10MB)"})]})]})]}),e.jsx(Ce,{control:_.control,name:"coverLetter",render:({field:m})=>e.jsxs(je,{children:[e.jsx(pe,{children:"Cover Letter (Optional)"}),e.jsx(ve,{children:e.jsx(ht,{placeholder:"Tell us why you're interested in this role and what makes you a great fit...",className:"min-h-[120px]",...m})}),e.jsx(Ne,{})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t",children:[e.jsx(Y,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),e.jsx(Y,{type:"submit",disabled:L,children:L?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Application"})]})]})})})]})})},va=({appliedPositions:s=[],onSavedJobsChange:r,pendingApplyPosition:t,onApplyComplete:a})=>{const{user:i}=Ue(),[l,o]=b.useState(""),[d,v]=b.useState("all"),[C,L]=b.useState("all"),[y,F]=b.useState(null),[h,_]=b.useState([]),[p,E]=b.useState(null),[R,m]=b.useState(null),[V,S]=b.useState(s),A=[...new Set(Le.map(f=>f.department))],W=[...new Set(Le.map(f=>f.type))];b.useEffect(()=>{S(s)},[s]),b.useEffect(()=>{i&&J()},[i]),b.useEffect(()=>{if(t){const f=Le.find(T=>T.id===t);f&&(m(f),F(t)),setTimeout(()=>{const T=document.getElementById(`position-${t}`);T&&T.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[t]);const J=async()=>{if(i)try{const{data:f,error:T}=await K.from("saved_jobs").select("position_id").eq("user_id",i.id);if(T)throw T;_((f==null?void 0:f.map(M=>M.position_id))||[])}catch(f){console.error("Error fetching saved jobs:",f)}},N=async(f,T)=>{if(T.stopPropagation(),!i){O.info("Please sign in to save jobs");return}E(f.id);try{if(h.includes(f.id)){const{error:M}=await K.from("saved_jobs").delete().eq("user_id",i.id).eq("position_id",f.id);if(M)throw M;_(z=>z.filter(_e=>_e!==f.id)),O.success("Job removed from saved list")}else{const{error:M}=await K.from("saved_jobs").insert({user_id:i.id,position_id:f.id,position_title:f.title});if(M)throw M;_(z=>[...z,f.id]),O.success("Job saved for later")}r==null||r()}catch(M){console.error("Error toggling saved job:",M),O.error("Failed to update saved jobs")}finally{E(null)}},I=Le.filter(f=>{const T=f.title.toLowerCase().includes(l.toLowerCase())||f.description.toLowerCase().includes(l.toLowerCase())||f.department.toLowerCase().includes(l.toLowerCase()),M=d==="all"||f.department===d,z=C==="all"||f.type===C;return T&&M&&z}),G=f=>{m(f),F(f.id)},ue=()=>{R&&S(f=>[...f,R.id]),m(null),a==null||a()},D=f=>V.includes(f),U=f=>h.includes(f);return e.jsxs("div",{className:"space-y-6",children:[R&&e.jsx(ja,{position:R,onClose:()=>m(null),onSuccess:ue}),e.jsx(ee,{children:e.jsx(se,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(pt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ce,{placeholder:"Search positions...",value:l,onChange:f=>o(f.target.value),className:"pl-10"})]}),e.jsxs(Ke,{value:d,onValueChange:v,children:[e.jsx(Qe,{className:"w-full md:w-[180px]",children:e.jsx(Xe,{placeholder:"Department"})}),e.jsxs(Ze,{children:[e.jsx(le,{value:"all",children:"All Departments"}),A.map(f=>e.jsx(le,{value:f,children:f},f))]})]}),e.jsxs(Ke,{value:C,onValueChange:L,children:[e.jsx(Qe,{className:"w-full md:w-[150px]",children:e.jsx(Xe,{placeholder:"Type"})}),e.jsxs(Ze,{children:[e.jsx(le,{value:"all",children:"All Types"}),W.map(f=>e.jsx(le,{value:f,children:f},f))]})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",I.length," of ",Le.length," positions"]}),h.length>0&&e.jsxs(Ae,{variant:"secondary",children:[e.jsx(ke,{className:"w-3 h-3 mr-1 fill-current"}),h.length," saved"]})]}),e.jsx("div",{className:"space-y-4",children:I.length===0?e.jsx(ee,{children:e.jsxs(se,{className:"py-12 text-center",children:[e.jsx(ge,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No positions found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search or filters"})]})}):I.map((f,T)=>e.jsx(Ee.div,{id:`position-${f.id}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:T*.05},children:e.jsx(ee,{className:`overflow-hidden hover:shadow-md transition-shadow ${t===f.id?"ring-2 ring-primary":""}`,children:e.jsxs(se,{className:"p-0",children:[e.jsx("div",{className:"p-4 cursor-pointer",onClick:()=>F(y===f.id?null:f.id),children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(ge,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:f.title}),D(f.id)&&e.jsxs(Ae,{variant:"secondary",className:"bg-primary/10 text-primary",children:[e.jsx(as,{className:"w-3 h-3 mr-1"}),"Applied"]}),U(f.id)&&!D(f.id)&&e.jsxs(Ae,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(ke,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"w-3.5 h-3.5"}),f.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-3.5 h-3.5"}),f.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(es,{className:"w-3.5 h-3.5"}),f.type]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:f.description})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(Y,{size:"icon",variant:"ghost",onClick:M=>N(f,M),disabled:p===f.id,className:"shrink-0",children:p===f.id?e.jsx(ie,{className:"w-5 h-5 animate-spin"}):e.jsx(ke,{className:`w-5 h-5 ${U(f.id)?"fill-primary text-primary":"text-muted-foreground"}`})}),!D(f.id)&&e.jsxs(Y,{size:"sm",onClick:M=>{M.stopPropagation(),G(f)},children:["Apply Now",e.jsx(ys,{className:"w-4 h-4 ml-1"})]}),e.jsx(Y,{variant:"ghost",size:"icon",children:y===f.id?e.jsx(dr,{className:"w-5 h-5"}):e.jsx(jr,{className:"w-5 h-5"})})]})]})}),e.jsx(mr,{children:y===f.id&&!R&&e.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 border-t pt-4 bg-muted/30",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Responsibilities"]}),e.jsx("ul",{className:"space-y-2",children:f.responsibilities.map((M,z)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:""}),e.jsx("span",{children:M})]},z))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-primary rounded-full"}),"Requirements"]}),e.jsx("ul",{className:"space-y-2",children:f.requirements.map((M,z)=>e.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-primary mt-1.5",children:""}),e.jsx("span",{children:M})]},z))})]})]}),!D(f.id)&&e.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-end gap-2",children:[e.jsxs(Y,{variant:"outline",onClick:M=>N(f,M),disabled:p===f.id,children:[p===f.id?e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ke,{className:`w-4 h-4 mr-2 ${U(f.id)?"fill-current":""}`}),U(f.id)?"Saved":"Save for Later"]}),e.jsxs(Y,{onClick:()=>G(f),children:["Apply for this Position",e.jsx(ys,{className:"w-4 h-4 ml-2"})]})]})]})})})]})})},f.id))})]})},Na=({profile:s,onProfileUpdate:r})=>{const{user:t,updatePassword:a}=Ue(),[i,l]=b.useState(!1),[o,d]=b.useState(!1),[v,C]=b.useState(""),[L,y]=b.useState(""),[F,h]=b.useState(""),[_,p]=b.useState(""),E=V=>V?V.split(" ").map(S=>S[0]).join("").toUpperCase().slice(0,2):"U",R=async V=>{var W;const S=(W=V.target.files)==null?void 0:W[0];if(!S||!t)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(S.type)){O.error("Please upload a valid image file (JPEG, PNG, GIF, or WebP)");return}if(S.size>2*1024*1024){O.error("Image size must be less than 2MB");return}l(!0);try{const J=S.name.split(".").pop(),N=`${t.id}-${Date.now()}.${J}`,{error:I}=await K.storage.from("avatars").upload(N,S,{upsert:!0});if(I){if(I.message.includes("bucket")){O.error("Avatar storage is being set up. Please try again later.");return}throw I}const{data:G}=K.storage.from("avatars").getPublicUrl(N),{error:ue}=await K.from("applicant_profiles").update({avatar_url:G.publicUrl}).eq("user_id",t.id);if(ue)throw ue;O.success("Profile picture updated!"),r()}catch(J){console.error("Error uploading avatar:",J),O.error("Failed to upload profile picture")}finally{l(!1)}},m=async V=>{if(V.preventDefault(),p(""),L.length<6){p("Password must be at least 6 characters");return}if(L!==F){p("Passwords do not match");return}d(!0);try{const{error:S}=await a(L);if(S)throw S;O.success("Password updated successfully!"),C(""),y(""),h("")}catch(S){console.error("Error changing password:",S),p(S.message||"Failed to update password")}finally{d(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"w-5 h-5"}),"Profile Picture"]}),e.jsx(Fe,{children:"Upload a profile picture to personalize your account"})]}),e.jsx(se,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(Ss,{className:"w-24 h-24 border-4 border-background shadow-lg",children:[e.jsx(Cs,{src:(s==null?void 0:s.avatar_url)||void 0,alt:(s==null?void 0:s.full_name)||"Profile"}),e.jsx(Fs,{className:"text-2xl bg-primary/10 text-primary",children:E(s==null?void 0:s.full_name)})]}),i&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-background/80 rounded-full",children:e.jsx(ie,{className:"w-6 h-6 animate-spin text-primary"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",id:"avatar-upload",accept:"image/jpeg,image/png,image/gif,image/webp",className:"hidden",onChange:R,disabled:i}),e.jsx("label",{htmlFor:"avatar-upload",children:e.jsx(Y,{variant:"outline",disabled:i,asChild:!0,children:e.jsx("span",{className:"cursor-pointer",children:i?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Qs,{className:"w-4 h-4 mr-2"}),"Upload New Picture"]})})})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"JPEG, PNG, GIF or WebP. Max 2MB."})]})]})})]}),e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Account Information"]}),e.jsx(Fe,{children:"Your account details and email address"})]}),e.jsx(se,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{className:"text-muted-foreground",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(xt,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t==null?void 0:t.email}),e.jsx(vr,{className:"w-4 h-4 text-primary ml-auto"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This is the email associated with your account"})]}),(s==null?void 0:s.full_name)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{className:"text-muted-foreground",children:"Full Name"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted/50 rounded-lg",children:[e.jsx(ze,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can update your name in the Profile tab"})]})]})})]}),e.jsxs(ee,{children:[e.jsxs(be,{children:[e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Nr,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(Fe,{children:"Update your password to keep your account secure"})]}),e.jsx(se,{children:e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ce,{id:"new-password",type:"password",placeholder:"Enter new password",value:L,onChange:V=>y(V.target.value),className:"pl-10",minLength:6})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(fs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ce,{id:"confirm-password",type:"password",placeholder:"Confirm new password",value:F,onChange:V=>h(V.target.value),className:"pl-10",minLength:6})]})]}),_&&e.jsx("p",{className:"text-sm text-destructive",children:_}),e.jsx(Y,{type:"submit",disabled:o||!L||!F,children:o?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})})]})]})},ba=({onJobRemoved:s})=>{const r=mt(),{user:t}=Ue(),[a,i]=b.useState([]),[l,o]=b.useState(!0),[d,v]=b.useState(null);b.useEffect(()=>{t&&C()},[t]);const C=async()=>{if(t)try{const{data:h,error:_}=await K.from("saved_jobs").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(_)throw _;i(h||[])}catch(h){console.error("Error fetching saved jobs:",h),O.error("Failed to load saved jobs")}finally{o(!1)}},L=async(h,_)=>{if(t){v(h);try{const{error:p}=await K.from("saved_jobs").delete().eq("id",h).eq("user_id",t.id);if(p)throw p;i(E=>E.filter(R=>R.id!==h)),O.success("Job removed from saved list"),s==null||s()}catch(p){console.error("Error removing saved job:",p),O.error("Failed to remove job")}finally{v(null)}}},y=h=>{sessionStorage.setItem("applyPositionId",h),r("/careers")},F=h=>Le.find(_=>_.id===h);return l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ie,{className:"w-8 h-8 animate-spin text-primary"})}):a.length===0?e.jsx(ee,{children:e.jsxs(se,{className:"py-12 text-center",children:[e.jsx(ke,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Saved Jobs"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Save jobs you're interested in to review them later"}),e.jsx(Y,{variant:"outline",onClick:()=>r("/applicant/dashboard"),children:"Browse Open Positions"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.length," saved job",a.length!==1?"s":""]})}),a.map((h,_)=>{const p=F(h.position_id);return e.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.05},children:e.jsx(ee,{className:"overflow-hidden hover:shadow-md transition-shadow",children:e.jsx(se,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg shrink-0",children:e.jsx(ge,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-lg",children:(p==null?void 0:p.title)||h.position_title}),e.jsxs(Ae,{variant:"secondary",className:"bg-accent text-accent-foreground",children:[e.jsx(ke,{className:"w-3 h-3 mr-1 fill-current"}),"Saved"]})]}),p&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(is,{className:"w-3.5 h-3.5"}),p.department]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-3.5 h-3.5"}),p.location]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(es,{className:"w-3.5 h-3.5"}),p.type]})]}),p&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:p.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Saved on ",new Date(h.created_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(Y,{size:"sm",onClick:()=>y(h.position_id),children:["Apply Now",e.jsx(ys,{className:"w-4 h-4 ml-1"})]}),e.jsx(Y,{size:"sm",variant:"ghost",onClick:()=>L(h.id,h.position_id),disabled:d===h.id,children:d===h.id?e.jsx(ie,{className:"w-4 h-4 animate-spin"}):e.jsx(ft,{className:"w-4 h-4 text-muted-foreground"})})]})]})})})},h.id)})]})},oi=()=>{const{user:s,isLoading:r,signOut:t}=Ue(),a=mt(),[i,l]=b.useState(null),[o,d]=b.useState(!0),[v,C]=b.useState("positions"),[L,y]=b.useState([]),[F,h]=b.useState(null);b.useEffect(()=>{if(!r&&!s){a("/applicant/login");return}if(s){_(),p();const m=sessionStorage.getItem("applyPositionId");m&&(sessionStorage.removeItem("applyPositionId"),h(m),C("positions"))}},[s,r,a]);const _=async()=>{if(s)try{const{data:m,error:V}=await K.from("applicant_profiles").select("*").eq("user_id",s.id).maybeSingle();if(V)throw V;m&&l(m)}catch(m){console.error("Error fetching profile:",m),O.error("Failed to load profile")}finally{d(!1)}},p=async()=>{if(s)try{const{data:m,error:V}=await K.from("job_applications").select("position").eq("user_id",s.id);if(V)throw V;if(m){const S=m.map(A=>A.position);y(S)}}catch(m){console.error("Error fetching applied positions:",m)}},E=async()=>{await t(),a("/"),O.success("Signed out successfully")},R=m=>m?m.split(" ").map(V=>V[0]).join("").toUpperCase().slice(0,2):"U";return r||o?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx(ie,{className:"w-8 h-8 animate-spin text-primary"})}):e.jsxs(e.Fragment,{children:[e.jsx(or,{title:"Dashboard | InfraWeave Careers",description:"Manage your profile, track your job applications, and explore new opportunities at InfraWeave."}),e.jsx(nr,{}),e.jsx("main",{className:"min-h-screen bg-gradient-to-b from-muted/50 to-background pt-24 pb-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Ss,{className:"w-16 h-16 border-4 border-background shadow-lg",children:[e.jsx(Cs,{src:(i==null?void 0:i.avatar_url)||void 0,alt:(i==null?void 0:i.full_name)||"Profile"}),e.jsx(Fs,{className:"text-xl bg-primary/10 text-primary",children:R(i==null?void 0:i.full_name)})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold",children:["Welcome",i!=null&&i.full_name?`, ${i.full_name.split(" ")[0]}`:"","!"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Explore opportunities, manage your profile, and track your applications"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs(Y,{variant:"ghost",onClick:E,children:[e.jsx(rr,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]}),e.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(ar,{value:v,onValueChange:C,className:"space-y-6",children:[e.jsxs(ir,{className:"grid w-full max-w-3xl grid-cols-5",children:[e.jsxs(Oe,{value:"positions",className:"flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Open Positions"}),e.jsx("span",{className:"sm:hidden",children:"Jobs"})]}),e.jsxs(Oe,{value:"saved",className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved Jobs"}),e.jsx("span",{className:"sm:hidden",children:"Saved"})]}),e.jsxs(Oe,{value:"applications",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"My Applications"}),e.jsx("span",{className:"sm:hidden",children:"Applied"})]}),e.jsxs(Oe,{value:"profile",className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),"Profile"]}),e.jsxs(Oe,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(br,{className:"w-4 h-4"}),"Account"]})]}),e.jsx(Be,{value:"positions",className:"space-y-6",children:e.jsx(va,{appliedPositions:L,pendingApplyPosition:F,onApplyComplete:()=>{h(null),p()}})}),e.jsx(Be,{value:"saved",className:"space-y-6",children:e.jsx(ba,{})}),e.jsx(Be,{value:"applications",className:"space-y-6",children:e.jsx($r,{userId:(s==null?void 0:s.id)||""})}),e.jsx(Be,{value:"profile",className:"space-y-6",children:e.jsx(Br,{profile:i,onProfileUpdate:_})}),e.jsx(Be,{value:"settings",className:"space-y-6",children:e.jsx(Na,{profile:i,onProfileUpdate:_})})]})})]})}),e.jsx(lr,{})]})};export{oi as default};
